const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browser-DB50WO58.js","assets/vendor-C2sYeDYt.js"])))=>i.map(i=>d[i]);
import{r as e,a as t,R as s,g as r,b as i,c as a,u as n,L as o,d as l,e as c,N as d,f as h,B as u,h as m,i as p}from"./vendor-C2sYeDYt.js";import{X as g,S as f,A as x,U as v,B as b,a as w,M as y,t as j,c as N,b as k,H as _,Z as S,T,R as E,C,d as P,e as I,F as $,f as O,L as A,N as R,g as L,h as U,i as D,P as F,j as M,k as V,l as B,m as z,n as J,o as q,p as H,q as W,D as G,r as K,s as Y,G as Z,u as X,v as Q,w as ee,x as te,y as se,z as re,E as ie,I as ae,J as ne,K as oe,O as le,Q as ce,V as de,W as he,Y as ue,_ as me,$ as pe,a0 as ge,a1 as fe,a2 as xe,a3 as ve,a4 as be,a5 as we}from"./ui-BeI5ZHRn.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var ye={exports:{}},je={},Ne=e,ke=Symbol.for("react.element"),_e=Symbol.for("react.fragment"),Se=Object.prototype.hasOwnProperty,Te=Ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ee={key:!0,ref:!0,__self:!0,__source:!0};function Ce(e,t,s){var r,i={},a=null,n=null;for(r in void 0!==s&&(a=""+s),void 0!==t.key&&(a=""+t.key),void 0!==t.ref&&(n=t.ref),t)Se.call(t,r)&&!Ee.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:ke,type:e,key:a,ref:n,props:i,_owner:Te.current}}je.Fragment=_e,je.jsx=Ce,je.jsxs=Ce,ye.exports=je;var Pe,Ie=ye.exports,$e=t;Pe=$e.createRoot,$e.hydrateRoot;class Oe extends s.Component{constructor(){super(...arguments),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){console.error("Application error:",e,t)}render(){return this.state.hasError?Ie.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:Ie.jsxs("div",{className:"text-center",children:[Ie.jsx("h1",{className:"text-2xl font-medium text-gray-900 mb-4",children:"Something went wrong"}),Ie.jsx("p",{className:"text-gray-600 mb-6",children:"We're sorry for the inconvenience. Please try again."}),Ie.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-2 bg-gold-500 text-white rounded-lg hover:bg-gold-600",children:"Refresh Page"})]})}):this.props.children}}const Ae={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlnaHBqZHBzbnRkY3NkdnFuaXBjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzYxMjk4NDAsImV4cCI6MjA1MTcwNTg0MH0.9nwDeL6ERmU50WiMRJz4bLcpfhB6EXnDul2njD7GV2k",VITE_SUPABASE_URL:"https://ighpjdpsntdcsdvqnipc.supabase.co"},Re=e=>{let t;const s=new Set,r=(e,r)=>{const i="function"==typeof e?e(t):e;if(!Object.is(i,t)){const e=t;t=(null!=r?r:"object"!=typeof i||null===i)?i:Object.assign({},t,i),s.forEach((s=>s(t,e)))}},i=()=>t,a={setState:r,getState:i,getInitialState:()=>n,subscribe:e=>(s.add(e),()=>s.delete(e)),destroy:()=>{"production"!==(Ae?"production":void 0)&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},n=t=e(r,i,a);return a};var Le={exports:{}},Ue={},De={exports:{}},Fe={},Me=e;var Ve="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Be=Me.useState,ze=Me.useEffect,Je=Me.useLayoutEffect,qe=Me.useDebugValue;function He(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!Ve(e,s)}catch(r){return!0}}var We="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var s=t(),r=Be({inst:{value:s,getSnapshot:t}}),i=r[0].inst,a=r[1];return Je((function(){i.value=s,i.getSnapshot=t,He(i)&&a({inst:i})}),[e,s,t]),ze((function(){return He(i)&&a({inst:i}),e((function(){He(i)&&a({inst:i})}))}),[e]),qe(s),s};Fe.useSyncExternalStore=void 0!==Me.useSyncExternalStore?Me.useSyncExternalStore:We,De.exports=Fe;var Ge=De.exports,Ke=e,Ye=Ge;
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ze="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Xe=Ye.useSyncExternalStore,Qe=Ke.useRef,et=Ke.useEffect,tt=Ke.useMemo,st=Ke.useDebugValue;Ue.useSyncExternalStoreWithSelector=function(e,t,s,r,i){var a=Qe(null);if(null===a.current){var n={hasValue:!1,value:null};a.current=n}else n=a.current;a=tt((function(){function e(e){if(!l){if(l=!0,a=e,e=r(e),void 0!==i&&n.hasValue){var t=n.value;if(i(t,e))return o=t}return o=e}if(t=o,Ze(a,e))return t;var s=r(e);return void 0!==i&&i(t,s)?t:(a=e,o=s)}var a,o,l=!1,c=void 0===s?null:s;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]}),[t,s,r,i]);var o=Xe(e,a[0],a[1]);return et((function(){n.hasValue=!0,n.value=o}),[o]),st(o),o},Le.exports=Ue;const rt=r(Le.exports),it={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlnaHBqZHBzbnRkY3NkdnFuaXBjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzYxMjk4NDAsImV4cCI6MjA1MTcwNTg0MH0.9nwDeL6ERmU50WiMRJz4bLcpfhB6EXnDul2njD7GV2k",VITE_SUPABASE_URL:"https://ighpjdpsntdcsdvqnipc.supabase.co"},{useDebugValue:at}=s,{useSyncExternalStoreWithSelector:nt}=rt;let ot=!1;const lt=e=>e;const ct=e=>{"production"!==(it?"production":void 0)&&"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t="function"==typeof e?(e=>e?Re(e):Re)(e):e,s=(e,s)=>function(e,t=lt,s){"production"!==(it?"production":void 0)&&s&&!ot&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),ot=!0);const r=nt(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,s);return at(r),r}(t,e,s);return Object.assign(s,t),s},dt=e=>e?ct(e):ct,ht={},ut=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),s=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));r=Promise.allSettled(t.map((e=>{if((e=function(e){return"/"+e}(e))in ht)return;ht[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const i=document.createElement("link");return i.rel=t?"stylesheet":"modulepreload",t||(i.as="script"),i.crossOrigin="",i.href=e,s&&i.setAttribute("nonce",s),document.head.appendChild(i),t?new Promise(((t,s)=>{i.addEventListener("load",t),i.addEventListener("error",(()=>s(new Error(`Unable to preload CSS for ${e}`))))})):void 0})))}function i(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then((t=>{for(const e of t||[])"rejected"===e.status&&i(e.reason);return e().catch(i)}))};class mt extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class pt extends mt{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class gt extends mt{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class ft extends mt{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var xt,vt;(vt=xt||(xt={})).Any="any",vt.ApNortheast1="ap-northeast-1",vt.ApNortheast2="ap-northeast-2",vt.ApSouth1="ap-south-1",vt.ApSoutheast1="ap-southeast-1",vt.ApSoutheast2="ap-southeast-2",vt.CaCentral1="ca-central-1",vt.EuCentral1="eu-central-1",vt.EuWest1="eu-west-1",vt.EuWest2="eu-west-2",vt.EuWest3="eu-west-3",vt.SaEast1="sa-east-1",vt.UsEast1="us-east-1",vt.UsWest1="us-west-1",vt.UsWest2="us-west-2";var bt=function(e,t,s,r){return new(s||(s=Promise))((function(i,a){function n(e){try{l(r.next(e))}catch(t){a(t)}}function o(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((r=r.apply(e,t||[])).next())}))};class wt{constructor(e,{headers:t={},customFetch:s,region:r=xt.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=(e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>ut((async()=>{const{default:e}=await Promise.resolve().then((()=>Ot));return{default:e}}),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)})(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return bt(this,void 0,void 0,(function*(){try{const{headers:r,method:i,body:a}=t;let n,o={},{region:l}=t;l||(l=this.region),l&&"any"!==l&&(o["x-region"]=l),a&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&("undefined"!=typeof Blob&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",n=a):"string"==typeof a?(o["Content-Type"]="text/plain",n=a):"undefined"!=typeof FormData&&a instanceof FormData?n=a:(o["Content-Type"]="application/json",n=JSON.stringify(a)));const c=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),r),body:n}).catch((e=>{throw new pt(e)})),d=c.headers.get("x-relay-error");if(d&&"true"===d)throw new gt(c);if(!c.ok)throw new ft(c);let h,u=(null!==(s=c.headers.get("Content-Type"))&&void 0!==s?s:"text/plain").split(";")[0].trim();return h="application/json"===u?yield c.json():"application/octet-stream"===u?yield c.blob():"text/event-stream"===u?c:"multipart/form-data"===u?yield c.formData():yield c.text(),{data:h,error:null}}catch(r){return{data:null,error:r}}}))}}var yt={},jt={},Nt={},kt={},_t={},St={},Tt=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();const Et=Tt.fetch,Ct=Tt.fetch.bind(Tt),Pt=Tt.Headers,It=Tt.Request,$t=Tt.Response,Ot=Object.freeze(Object.defineProperty({__proto__:null,Headers:Pt,Request:It,Response:$t,default:Ct,fetch:Et},Symbol.toStringTag,{value:"Module"})),At=i(Ot);var Rt={};Object.defineProperty(Rt,"__esModule",{value:!0});let Lt=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Rt.default=Lt;var Ut=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(St,"__esModule",{value:!0});const Dt=Ut(At),Ft=Ut(Rt);St.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=Dt.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async e=>{var t,s,r;let i=null,a=null,n=null,o=e.status,l=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(a="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const r=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),c=null===(s=e.headers.get("content-range"))||void 0===s?void 0:s.split("/");r&&c&&c.length>1&&(n=parseInt(c[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(a)&&(a.length>1?(i={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,n=null,o=406,l="Not Acceptable"):a=1===a.length?a[0]:null)}else{const t=await e.text();try{i=JSON.parse(t),Array.isArray(i)&&404===e.status&&(a=[],i=null,o=200,l="OK")}catch(c){404===e.status&&""===t?(o=204,l="No Content"):i={message:t}}if(i&&this.isMaybeSingle&&(null===(r=null==i?void 0:i.details)||void 0===r?void 0:r.includes("0 rows"))&&(i=null,o=200,l="OK"),i&&this.shouldThrowOnError)throw new Ft.default(i)}return{error:i,data:a,count:n,status:o,statusText:l}}));return this.shouldThrowOnError||(s=s.catch((e=>{var t,s,r;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(s=null==e?void 0:e.stack)&&void 0!==s?s:""}`,hint:"",code:`${null!==(r=null==e?void 0:e.code)&&void 0!==r?r:""}`},data:null,count:null,status:0,statusText:""}}))),s.then(e,t)}};var Mt=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_t,"__esModule",{value:!0});const Vt=Mt(St);let Bt=class extends Vt.default{select(e){let t=!1;const s=(null!=e?e:"*").split("").map((e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e))).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:r,referencedTable:i=r}={}){const a=i?`${i}.order`:"order",n=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${n?`${n},`:""}${e}.${t?"asc":"desc"}${void 0===s?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const r=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:r=s}={}){const i=void 0===r?"offset":`${r}.offset`,a=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:r=!1,wal:i=!1,format:a="text"}={}){var n;const o=[e?"analyze":null,t?"verbose":null,s?"settings":null,r?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=null!==(n=this.headers.Accept)&&void 0!==n?n:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${l}"; options=${o};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};_t.default=Bt;var zt=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(kt,"__esModule",{value:!0});const Jt=zt(_t);let qt=class extends Jt.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map((e=>"string"==typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`)).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:r}={}){let i="";"plain"===r?i="pl":"phrase"===r?i="ph":"websearch"===r&&(i="w");const a=void 0===s?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach((([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)})),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const r=s?`${s}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};kt.default=qt;var Ht=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Nt,"__esModule",{value:!0});const Wt=Ht(kt);Nt.default=class{constructor(e,{headers:t={},schema:s,fetch:r}){this.url=e,this.headers=t,this.schema=s,this.fetch=r}select(e,{head:t=!1,count:s}={}){const r=t?"HEAD":"GET";let i=!1;const a=(null!=e?e:"*").split("").map((e=>/\s/.test(e)&&!i?"":('"'===e&&(i=!i),e))).join("");return this.url.searchParams.set("select",a),s&&(this.headers.Prefer=`count=${s}`),new Wt.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),s||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new Wt.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:r,defaultToNull:i=!0}={}){const a=[`resolution=${s?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),i||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new Wt.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new Wt.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new Wt.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};var Gt={},Kt={};Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.version=void 0,Kt.version="0.0.0-automated",Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.DEFAULT_HEADERS=void 0;const Yt=Kt;Gt.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Yt.version}`};var Zt=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(jt,"__esModule",{value:!0});const Xt=Zt(Nt),Qt=Zt(kt),es=Gt;jt.default=class e{constructor(e,{headers:t={},schema:s,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},es.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new Xt.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:r=!1,count:i}={}){let a;const n=new URL(`${this.url}/rpc/${e}`);let o;s||r?(a=s?"HEAD":"GET",Object.entries(t).filter((([e,t])=>void 0!==t)).map((([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`])).forEach((([e,t])=>{n.searchParams.append(e,t)}))):(a="POST",o=t);const l=Object.assign({},this.headers);return i&&(l.Prefer=`count=${i}`),new Qt.default({method:a,url:n,headers:l,schema:this.schemaName,body:o,fetch:this.fetch,allowEmpty:!1})}};var ts=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(yt,"__esModule",{value:!0}),yt.PostgrestError=yt.PostgrestBuilder=yt.PostgrestTransformBuilder=yt.PostgrestFilterBuilder=yt.PostgrestQueryBuilder=yt.PostgrestClient=void 0;const ss=ts(jt);yt.PostgrestClient=ss.default;const rs=ts(Nt);yt.PostgrestQueryBuilder=rs.default;const is=ts(kt);yt.PostgrestFilterBuilder=is.default;const as=ts(_t);yt.PostgrestTransformBuilder=as.default;const ns=ts(St);yt.PostgrestBuilder=ns.default;const os=ts(Rt);yt.PostgrestError=os.default;var ls=yt.default={PostgrestClient:ss.default,PostgrestQueryBuilder:rs.default,PostgrestFilterBuilder:is.default,PostgrestTransformBuilder:as.default,PostgrestBuilder:ns.default,PostgrestError:os.default};const{PostgrestClient:cs,PostgrestQueryBuilder:ds,PostgrestFilterBuilder:hs,PostgrestTransformBuilder:us,PostgrestBuilder:ms,PostgrestError:ps}=ls,gs={"X-Client-Info":"realtime-js/2.11.2"};var fs,xs,vs,bs,ws,ys,js,Ns,ks,_s,Ss;(xs=fs||(fs={}))[xs.connecting=0]="connecting",xs[xs.open=1]="open",xs[xs.closing=2]="closing",xs[xs.closed=3]="closed",(bs=vs||(vs={})).closed="closed",bs.errored="errored",bs.joined="joined",bs.joining="joining",bs.leaving="leaving",(ys=ws||(ws={})).close="phx_close",ys.error="phx_error",ys.join="phx_join",ys.reply="phx_reply",ys.leave="phx_leave",ys.access_token="access_token",(js||(js={})).websocket="websocket",(ks=Ns||(Ns={})).Connecting="connecting",ks.Open="open",ks.Closing="closing",ks.Closed="closed";class Ts{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"==typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const r=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const n=s.decode(e.slice(a,a+r));a+=r;const o=s.decode(e.slice(a,a+i));a+=i;return{ref:null,topic:n,event:o,payload:JSON.parse(s.decode(e.slice(a,e.byteLength)))}}}class Es{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}(Ss=_s||(_s={})).abstime="abstime",Ss.bool="bool",Ss.date="date",Ss.daterange="daterange",Ss.float4="float4",Ss.float8="float8",Ss.int2="int2",Ss.int4="int4",Ss.int4range="int4range",Ss.int8="int8",Ss.int8range="int8range",Ss.json="json",Ss.jsonb="jsonb",Ss.money="money",Ss.numeric="numeric",Ss.oid="oid",Ss.reltime="reltime",Ss.text="text",Ss.time="time",Ss.timestamp="timestamp",Ss.timestamptz="timestamptz",Ss.timetz="timetz",Ss.tsrange="tsrange",Ss.tstzrange="tstzrange";const Cs=(e,t,s={})=>{var r;const i=null!==(r=s.skipTypes)&&void 0!==r?r:[];return Object.keys(t).reduce(((s,r)=>(s[r]=Ps(r,e,t,i),s)),{})},Ps=(e,t,s,r)=>{const i=t.find((t=>t.name===e)),a=null==i?void 0:i.type,n=s[e];return a&&!r.includes(a)?Is(a,n):$s(n)},Is=(e,t)=>{if("_"===e.charAt(0)){const s=e.slice(1,e.length);return Ls(t,s)}switch(e){case _s.bool:return Os(t);case _s.float4:case _s.float8:case _s.int2:case _s.int4:case _s.int8:case _s.numeric:case _s.oid:return As(t);case _s.json:case _s.jsonb:return Rs(t);case _s.timestamp:return Us(t);case _s.abstime:case _s.date:case _s.daterange:case _s.int4range:case _s.int8range:case _s.money:case _s.reltime:case _s.text:case _s.time:case _s.timestamptz:case _s.timetz:case _s.tsrange:case _s.tstzrange:default:return $s(t)}},$s=e=>e,Os=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},As=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Rs=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Ls=(e,t)=>{if("string"!=typeof e)return e;const s=e.length-1,r=e[s];if("{"===e[0]&&"}"===r){let r;const a=e.slice(1,s);try{r=JSON.parse("["+a+"]")}catch(i){r=a?a.split(","):[]}return r.map((e=>Is(t,e)))}return e},Us=e=>"string"==typeof e?e.replace(" ","T"):e,Ds=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Fs{constructor(e,t,s={},r=1e4){this.channel=e,this.event=t,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t(null===(s=this.receivedResp)||void 0===s?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},(e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter((t=>t.status===e)).forEach((e=>e.callback(t)))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ms,Vs,Bs,zs,Js,qs,Hs,Ws;(Vs=Ms||(Ms={})).SYNC="sync",Vs.JOIN="join",Vs.LEAVE="leave";class Gs{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},(e=>{const{onJoin:t,onLeave:s,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Gs.syncState(this.state,e,t,s),this.pendingDiffs.forEach((e=>{this.state=Gs.syncDiff(this.state,e,t,s)})),this.pendingDiffs=[],r()})),this.channel._on(s.diff,{},(e=>{const{onJoin:t,onLeave:s,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=Gs.syncDiff(this.state,e,t,s),r())})),this.onJoin(((e,t,s)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:s})})),this.onLeave(((e,t,s)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:s})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(e,t,s,r){const i=this.cloneDeep(e),a=this.transformState(t),n={},o={};return this.map(i,((e,t)=>{a[e]||(o[e]=t)})),this.map(a,((e,t)=>{const s=i[e];if(s){const r=t.map((e=>e.presence_ref)),i=s.map((e=>e.presence_ref)),a=t.filter((e=>i.indexOf(e.presence_ref)<0)),l=s.filter((e=>r.indexOf(e.presence_ref)<0));a.length>0&&(n[e]=a),l.length>0&&(o[e]=l)}else n[e]=t})),this.syncDiff(i,{joins:n,leaves:o},s,r)}static syncDiff(e,t,s,r){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(i,((t,r)=>{var i;const a=null!==(i=e[t])&&void 0!==i?i:[];if(e[t]=this.cloneDeep(r),a.length>0){const s=e[t].map((e=>e.presence_ref)),r=a.filter((e=>s.indexOf(e.presence_ref)<0));e[t].unshift(...r)}s(t,a,r)})),this.map(a,((t,s)=>{let i=e[t];if(!i)return;const a=s.map((e=>e.presence_ref));i=i.filter((e=>a.indexOf(e.presence_ref)<0)),e[t]=i,r(t,i,s),0===i.length&&delete e[t]})),e}static map(e,t){return Object.getOwnPropertyNames(e).map((s=>t(s,e[s])))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce(((t,s)=>{const r=e[s];return t[s]="metas"in r?r.metas.map((e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e))):r,t}),{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(zs=Bs||(Bs={})).ALL="*",zs.INSERT="INSERT",zs.UPDATE="UPDATE",zs.DELETE="DELETE",(qs=Js||(Js={})).BROADCAST="broadcast",qs.PRESENCE="presence",qs.POSTGRES_CHANGES="postgres_changes",qs.SYSTEM="system",(Ws=Hs||(Hs={})).SUBSCRIBED="SUBSCRIBED",Ws.TIMED_OUT="TIMED_OUT",Ws.CLOSED="CLOSED",Ws.CHANNEL_ERROR="CHANNEL_ERROR";class Ks{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=vs.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Fs(this,ws.join,this.params,this.timeout),this.rejoinTimer=new Es((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=vs.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((e=>e.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=vs.closed,this.socket._remove(this)})),this._onError((e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=vs.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=vs.errored,this.rejoinTimer.scheduleTimeout())})),this._on(ws.reply,{},((e,t)=>{this._trigger(this._replyEventName(t),e)})),this.presence=new Gs(this),this.broadcastEndpointURL=Ds(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:a,private:n}}=this.params;this._onError((t=>null==e?void 0:e(Hs.CHANNEL_ERROR,t))),this._onClose((()=>null==e?void 0:e(Hs.CLOSED)));const o={},l={broadcast:i,presence:a,postgres_changes:null!==(r=null===(s=this.bindings.postgres_changes)||void 0===s?void 0:s.map((e=>e.filter)))&&void 0!==r?r:[],private:n};this.socket.accessTokenValue&&(o.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},o)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",(async({postgres_changes:t})=>{var s;if(this.socket.setAuth(),void 0!==t){const r=this.bindings.postgres_changes,i=null!==(s=null==r?void 0:r.length)&&void 0!==s?s:0,a=[];for(let s=0;s<i;s++){const i=r[s],{filter:{event:n,schema:o,table:l,filter:c}}=i,d=t&&t[s];if(!d||d.event!==n||d.schema!==o||d.table!==l||d.filter!==c)return this.unsubscribe(),void(null==e||e(Hs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));a.push(Object.assign(Object.assign({},i),{id:d.id}))}return this.bindings.postgres_changes=a,void(e&&e(Hs.SUBSCRIBED))}null==e||e(Hs.SUBSCRIBED)})).receive("error",(t=>{null==e||e(Hs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))})).receive("timeout",(()=>{null==e||e(Hs.TIMED_OUT)}))}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,r;if(this._canPush()||"broadcast"!==e.type)return new Promise((s=>{var r,i,a;const n=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(a=null===(i=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===i?void 0:i.broadcast)||void 0===a?void 0:a.ack)||s("ok"),n.receive("ok",(()=>s("ok"))),n.receive("error",(()=>s("error"))),n.receive("timeout",(()=>s("timed out")))}));{const{event:a,payload:n}=e,o={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:n,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!==(s=t.timeout)&&void 0!==s?s:this.timeout);return await(null===(r=e.body)||void 0===r?void 0:r.cancel()),e.ok?"ok":"error"}catch(i){return"AbortError"===i.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=vs.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ws.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise((s=>{const r=new Fs(this,ws.leave,{},e);r.receive("ok",(()=>{t(),s("ok")})).receive("timeout",(()=>{t(),s("timed out")})).receive("error",(()=>{s("error")})),r.send(),this._canPush()||r.trigger("ok",{})}))}async _fetchWithTimeout(e,t,s){const r=new AbortController,i=setTimeout((()=>r.abort()),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(i),a}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Fs(this,e,t,s);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var r,i;const a=e.toLocaleLowerCase(),{close:n,error:o,leave:l,join:c}=ws;if(s&&[n,o,l,c].indexOf(a)>=0&&s!==this._joinRef())return;let d=this._onMessage(a,t,s);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter((e=>{var t,s,r;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(r=null===(s=e.filter)||void 0===s?void 0:s.event)||void 0===r?void 0:r.toLocaleLowerCase())===a})).map((e=>e.callback(d,s))):null===(i=this.bindings[a])||void 0===i||i.filter((e=>{var s,r,i,n,o,l;if(["broadcast","presence","postgres_changes"].includes(a)){if("id"in e){const a=e.id,n=null===(s=e.filter)||void 0===s?void 0:s.event;return a&&(null===(r=t.ids)||void 0===r?void 0:r.includes(a))&&("*"===n||(null==n?void 0:n.toLocaleLowerCase())===(null===(i=t.data)||void 0===i?void 0:i.type.toLocaleLowerCase()))}{const s=null===(o=null===(n=null==e?void 0:e.filter)||void 0===n?void 0:n.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===s||s===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===a})).map((e=>{if("object"==typeof d&&"ids"in d){const e=d.data,{schema:t,table:s,commit_timestamp:r,type:i,errors:a}=e,n={schema:t,table:s,commit_timestamp:r,eventType:i,new:{},old:{},errors:a};d=Object.assign(Object.assign({},n),this._getPayloadRecords(e))}e.callback(d,s)}))}_isClosed(){return this.state===vs.closed}_isJoined(){return this.state===vs.joined}_isJoining(){return this.state===vs.joining}_isLeaving(){return this.state===vs.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const r=e.toLocaleLowerCase(),i={type:r,filter:t,callback:s};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter((e=>{var r;return!((null===(r=e.type)||void 0===r?void 0:r.toLocaleLowerCase())===s&&Ks.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ws.close,{},e)}_onError(e){this._on(ws.error,{},(t=>e(t)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=vs.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=Cs(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=Cs(e.columns,e.old_record)),t}}const Ys=()=>{},Zs="undefined"!=typeof WebSocket;class Xs{constructor(e,t){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=gs,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Ys,this.conn=null,this.sendBuffer=[],this.serializer=new Ts,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>ut((async()=>{const{default:e}=await Promise.resolve().then((()=>Ot));return{default:e}}),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},this.endPoint=`${e}/${js.websocket}`,this.httpEndpoint=Ds(e),(null==t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null==t?void 0:t.params)&&(this.params=t.params),(null==t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null==t?void 0:t.timeout)&&(this.timeout=t.timeout),(null==t?void 0:t.logger)&&(this.logger=t.logger),(null==t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const r=null===(s=null==t?void 0:t.params)||void 0===s?void 0:s.apikey;if(r&&(this.accessTokenValue=r,this.apiKey=r),this.reconnectAfterMs=(null==t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Es((async()=>{this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null==t?void 0:t.fetch),null==t?void 0:t.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null==t?void 0:t.worker)||!1,this.workerUrl=null==t?void 0:t.workerUrl}this.accessToken=(null==t?void 0:t.accessToken)||null}connect(){if(!this.conn)if(this.transport)this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});else{if(Zs)return this.conn=new WebSocket(this.endpointURL()),void this.setupConnection();this.conn=new Qs(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),ut((async()=>{const{default:e}=await import("./browser-DB50WO58.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([0,1])).then((({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()}))}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map((e=>e.unsubscribe())));return this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case fs.connecting:return Ns.Connecting;case fs.open:return Ns.Open;case fs.closing:return Ns.Closing;default:return Ns.Closed}}isConnected(){return this.connectionState()===Ns.Open}channel(e,t={config:{}}){const s=new Ks(`realtime:${e}`,t,this);return this.channels.push(s),s}push(e){const{topic:t,event:s,payload:r,ref:i}=e,a=()=>{this.encode(e,(e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)}))};this.log("push",`${t} ${s} (${i})`,r),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let e=null;try{e=JSON.parse(atob(t.split(".")[1]))}catch(s){}if(e&&e.exp){if(!(Math.floor(Date.now()/1e3)-e.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${e.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${e.exp}`)}this.accessTokenValue=t,this.channels.forEach((e=>{t&&e.updateJoinPayload({access_token:t}),e.joinedOnce&&e._isJoined()&&e._push(ws.access_token,{access_token:t})}))}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((e=>e())),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find((t=>t.topic===e&&(t._isJoined()||t._isJoining())));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter((t=>t._joinRef()!==e._joinRef()))}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,(e=>{let{topic:t,event:s,payload:r,ref:i}=e;i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${t} ${s} ${i&&"("+i+")"||""}`,r),this.channels.filter((e=>e._isMember(t))).forEach((e=>e._trigger(s,r,i))),this.stateChangeCallbacks.message.forEach((t=>t(e)))}))}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this.sendHeartbeat()),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach((e=>e()))}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((t=>t(e)))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((t=>t(e)))}_triggerChanError(){this.channels.forEach((e=>e._trigger(ws.error)))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const s=e.match(/\?/)?"&":"?";return`${e}${s}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class Qs{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=fs.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class er extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function tr(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class sr extends er{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class rr extends er{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var ir=function(e,t,s,r){return new(s||(s=Promise))((function(i,a){function n(e){try{l(r.next(e))}catch(t){a(t)}}function o(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((r=r.apply(e,t||[])).next())}))};const ar=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>ut((async()=>{const{default:e}=await Promise.resolve().then((()=>Ot));return{default:e}}),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},nr=e=>{if(Array.isArray(e))return e.map((e=>nr(e)));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach((([e,s])=>{const r=e.replace(/([-_][a-z])/gi,(e=>e.toUpperCase().replace(/[-_]/g,"")));t[r]=nr(s)})),t};var or=function(e,t,s,r){return new(s||(s=Promise))((function(i,a){function n(e){try{l(r.next(e))}catch(t){a(t)}}function o(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((r=r.apply(e,t||[])).next())}))};const lr=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),cr=(e,t,s)=>or(void 0,void 0,void 0,(function*(){const r=yield ir(void 0,void 0,void 0,(function*(){return"undefined"==typeof Response?(yield ut((()=>Promise.resolve().then((()=>Ot))),void 0)).Response:Response}));e instanceof r&&!(null==s?void 0:s.noResolveJson)?e.json().then((s=>{t(new sr(lr(s),e.status||500))})).catch((e=>{t(new rr(lr(e),e))})):t(new rr(lr(e),e))}));function dr(e,t,s,r,i,a){return or(this,void 0,void 0,(function*(){return new Promise(((n,o)=>{e(s,((e,t,s,r)=>{const i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),r&&(i.body=JSON.stringify(r)),Object.assign(Object.assign({},i),s))})(t,r,i,a)).then((e=>{if(!e.ok)throw e;return(null==r?void 0:r.noResolveJson)?e:e.json()})).then((e=>n(e))).catch((e=>cr(e,o,r)))}))}))}function hr(e,t,s,r){return or(this,void 0,void 0,(function*(){return dr(e,"GET",t,s,r)}))}function ur(e,t,s,r,i){return or(this,void 0,void 0,(function*(){return dr(e,"POST",t,r,i,s)}))}function mr(e,t,s,r,i){return or(this,void 0,void 0,(function*(){return dr(e,"DELETE",t,r,i,s)}))}var pr=function(e,t,s,r){return new(s||(s=Promise))((function(i,a){function n(e){try{l(r.next(e))}catch(t){a(t)}}function o(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((r=r.apply(e,t||[])).next())}))};const gr={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},fr={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class xr{constructor(e,t={},s,r){this.url=e,this.headers=t,this.bucketId=s,this.fetch=ar(r)}uploadOrUpdate(e,t,s,r){return pr(this,void 0,void 0,(function*(){try{let i;const a=Object.assign(Object.assign({},fr),r);let n=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(a.upsert)});const o=a.metadata;"undefined"!=typeof Blob&&s instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),o&&i.append("metadata",this.encodeMetadata(o)),i.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(i=s,i.append("cacheControl",a.cacheControl),o&&i.append("metadata",this.encodeMetadata(o))):(i=s,n["cache-control"]=`max-age=${a.cacheControl}`,n["content-type"]=a.contentType,o&&(n["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null==r?void 0:r.headers)&&(n=Object.assign(Object.assign({},n),r.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:i,headers:n},(null==a?void 0:a.duplex)?{duplex:a.duplex}:{})),h=yield d.json();if(d.ok)return{data:{path:l,id:h.Id,fullPath:h.Key},error:null};return{data:null,error:h}}catch(i){if(tr(i))return{data:null,error:i};throw i}}))}upload(e,t,s){return pr(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",e,t,s)}))}uploadToSignedUrl(e,t,s,r){return pr(this,void 0,void 0,(function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),n=new URL(this.url+`/object/upload/sign/${a}`);n.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:fr.upsert},r),a=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&s instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(e=s,e.append("cacheControl",t.cacheControl)):(e=s,a["cache-control"]=`max-age=${t.cacheControl}`,a["content-type"]=t.contentType);const o=yield this.fetch(n.toString(),{method:"PUT",body:e,headers:a}),l=yield o.json();if(o.ok)return{data:{path:i,fullPath:l.Key},error:null};return{data:null,error:l}}catch(o){if(tr(o))return{data:null,error:o};throw o}}))}createSignedUploadUrl(e,t){return pr(this,void 0,void 0,(function*(){try{let s=this._getFinalPath(e);const r=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(r["x-upsert"]="true");const i=yield ur(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:r}),a=new URL(this.url+i.url),n=a.searchParams.get("token");if(!n)throw new er("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:n},error:null}}catch(s){if(tr(s))return{data:null,error:s};throw s}}))}update(e,t,s){return pr(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",e,t,s)}))}move(e,t,s){return pr(this,void 0,void 0,(function*(){try{return{data:yield ur(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(tr(r))return{data:null,error:r};throw r}}))}copy(e,t,s){return pr(this,void 0,void 0,(function*(){try{return{data:{path:(yield ur(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(tr(r))return{data:null,error:r};throw r}}))}createSignedUrl(e,t,s){return pr(this,void 0,void 0,(function*(){try{let r=this._getFinalPath(e),i=yield ur(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},(null==s?void 0:s.transform)?{transform:s.transform}:{}),{headers:this.headers});const a=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(r){if(tr(r))return{data:null,error:r};throw r}}))}createSignedUrls(e,t,s){return pr(this,void 0,void 0,(function*(){try{const r=yield ur(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return{data:r.map((e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${i}`):null}))),error:null}}catch(r){if(tr(r))return{data:null,error:r};throw r}}))}download(e,t){return pr(this,void 0,void 0,(function*(){const s=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),i=r?`?${r}`:"";try{const t=this._getFinalPath(e),r=yield hr(this.fetch,`${this.url}/${s}/${t}${i}`,{headers:this.headers,noResolveJson:!0});return{data:yield r.blob(),error:null}}catch(a){if(tr(a))return{data:null,error:a};throw a}}))}info(e){return pr(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{const e=yield hr(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:nr(e),error:null}}catch(s){if(tr(s))return{data:null,error:s};throw s}}))}exists(e){return pr(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{return yield function(e,t,s,r){return or(this,void 0,void 0,(function*(){return dr(e,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),r)}))}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(tr(s)&&s instanceof rr){const e=s.originalError;if([400,404].includes(null==e?void 0:e.status))return{data:!1,error:s}}throw s}}))}getPublicUrl(e,t){const s=this._getFinalPath(e),r=[],i=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==i&&r.push(i);const a=void 0!==(null==t?void 0:t.transform)?"render/image":"object",n=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==n&&r.push(n);let o=r.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${s}${o}`)}}}remove(e){return pr(this,void 0,void 0,(function*(){try{return{data:yield mr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(tr(t))return{data:null,error:t};throw t}}))}list(e,t,s){return pr(this,void 0,void 0,(function*(){try{const r=Object.assign(Object.assign(Object.assign({},gr),t),{prefix:e||""});return{data:yield ur(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(tr(r))return{data:null,error:r};throw r}}))}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const vr={"X-Client-Info":"storage-js/2.7.1"};var br=function(e,t,s,r){return new(s||(s=Promise))((function(i,a){function n(e){try{l(r.next(e))}catch(t){a(t)}}function o(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((r=r.apply(e,t||[])).next())}))};class wr{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},vr),t),this.fetch=ar(s)}listBuckets(){return br(this,void 0,void 0,(function*(){try{return{data:yield hr(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(tr(e))return{data:null,error:e};throw e}}))}getBucket(e){return br(this,void 0,void 0,(function*(){try{return{data:yield hr(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(tr(t))return{data:null,error:t};throw t}}))}createBucket(e,t={public:!1}){return br(this,void 0,void 0,(function*(){try{return{data:yield ur(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(tr(s))return{data:null,error:s};throw s}}))}updateBucket(e,t){return br(this,void 0,void 0,(function*(){try{const s=yield function(e,t,s,r,i){return or(this,void 0,void 0,(function*(){return dr(e,"PUT",t,r,i,s)}))}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:s,error:null}}catch(s){if(tr(s))return{data:null,error:s};throw s}}))}emptyBucket(e){return br(this,void 0,void 0,(function*(){try{return{data:yield ur(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(tr(t))return{data:null,error:t};throw t}}))}deleteBucket(e){return br(this,void 0,void 0,(function*(){try{return{data:yield mr(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(tr(t))return{data:null,error:t};throw t}}))}}class yr extends wr{constructor(e,t={},s){super(e,t,s)}from(e){return new xr(this.url,this.headers,e,this.fetch)}}let jr="";jr="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const Nr={headers:{"X-Client-Info":`supabase-js-${jr}/2.47.10`}},kr={schema:"public"},_r={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Sr={};var Tr=function(e,t,s,r){return new(s||(s=Promise))((function(i,a){function n(e){try{l(r.next(e))}catch(t){a(t)}}function o(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((r=r.apply(e,t||[])).next())}))};const Er=(e,t,s)=>{const r=(e=>{let t;return t=e||("undefined"==typeof fetch?Ct:fetch),(...e)=>t(...e)})(s),i="undefined"==typeof Headers?Pt:Headers;return(s,a)=>Tr(void 0,void 0,void 0,(function*(){var n;const o=null!==(n=yield t())&&void 0!==n?n:e;let l=new i(null==a?void 0:a.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),r(s,Object.assign(Object.assign({},a),{headers:l}))}))};var Cr=function(e,t,s,r){return new(s||(s=Promise))((function(i,a){function n(e){try{l(r.next(e))}catch(t){a(t)}}function o(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((r=r.apply(e,t||[])).next())}))};const Pr="2.67.3",Ir={"X-Client-Info":`gotrue-js/${Pr}`},$r="X-Supabase-Api-Version",Or={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"};const Ar=()=>"undefined"!=typeof window&&"undefined"!=typeof document,Rr={tested:!1,writable:!1},Lr=()=>{if(!Ar())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(t){return!1}if(Rr.tested)return Rr.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Rr.tested=!0,Rr.writable=!0}catch(t){Rr.tested=!0,Rr.writable=!1}return Rr.writable};const Ur=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>ut((async()=>{const{default:e}=await Promise.resolve().then((()=>Ot));return{default:e}}),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},Dr=async(e,t,s)=>{await e.setItem(t,JSON.stringify(s))},Fr=async(e,t)=>{const s=await e.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch(r){return s}},Mr=async(e,t)=>{await e.removeItem(t)};class Vr{constructor(){this.promise=new Vr.promiseConstructor(((e,t)=>{this.resolve=e,this.reject=t}))}}function Br(e){const t=e.split(".");if(3!==t.length)throw new Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const s=t[1];return JSON.parse(function(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let s,r,i,a,n,o,l,c="",d=0;for(e=e.replace("-","+").replace("_","/");d<e.length;)a=t.indexOf(e.charAt(d++)),n=t.indexOf(e.charAt(d++)),o=t.indexOf(e.charAt(d++)),l=t.indexOf(e.charAt(d++)),s=a<<2|n>>4,r=(15&n)<<4|o>>2,i=(3&o)<<6|l,c+=String.fromCharCode(s),64!=o&&0!=r&&(c+=String.fromCharCode(r)),64!=l&&0!=i&&(c+=String.fromCharCode(i));return c}(s))}function zr(e){return("0"+e.toString(16)).substr(-2)}async function Jr(e){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),s=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(s);return Array.from(r).map((e=>String.fromCharCode(e))).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function qr(e,t,s=!1){const r=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let s="";for(let r=0;r<56;r++)s+=e.charAt(Math.floor(Math.random()*t));return s}return crypto.getRandomValues(e),Array.from(e,zr).join("")}();let i=r;s&&(i+="/PASSWORD_RECOVERY"),await Dr(e,`${t}-code-verifier`,i);const a=await Jr(r);return[a,r===a?"plain":"s256"]}Vr.promiseConstructor=Promise;const Hr=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;class Wr extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function Gr(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class Kr extends Wr{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}class Yr extends Wr{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Zr extends Wr{constructor(e,t,s,r){super(e,s,r),this.name=t,this.status=s}}class Xr extends Zr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Qr extends Zr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ei extends Zr{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ti extends Zr{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class si extends Zr{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ri extends Zr{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function ii(e){return Gr(e)&&"AuthRetryableFetchError"===e.name}class ai extends Zr{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}const ni=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),oi=[502,503,504];async function li(e){var t,s;if(!("object"==typeof(s=e)&&null!==s&&"status"in s&&"ok"in s&&"json"in s&&"function"==typeof s.json))throw new ri(ni(e),0);if(oi.includes(e.status))throw new ri(ni(e),e.status);let r,i;try{r=await e.json()}catch(n){throw new Yr(ni(n),n)}const a=function(e){const t=e.headers.get($r);if(!t)return null;if(!t.match(Hr))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(n){return null}}(e);if(a&&a.getTime()>=Or.timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?i=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(i=r.error_code),i){if("weak_password"===i)throw new ai(ni(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===i)throw new Xr}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce(((e,t)=>e&&"string"==typeof t),!0))throw new ai(ni(r),e.status,r.weak_password.reasons);throw new Kr(ni(r),e.status||500,i)}async function ci(e,t,s,r){var i;const a=Object.assign({},null==r?void 0:r.headers);a[$r]||(a[$r]=Or.name),(null==r?void 0:r.jwt)&&(a.Authorization=`Bearer ${r.jwt}`);const n=null!==(i=null==r?void 0:r.query)&&void 0!==i?i:{};(null==r?void 0:r.redirectTo)&&(n.redirect_to=r.redirectTo);const o=Object.keys(n).length?"?"+new URLSearchParams(n).toString():"",l=await async function(e,t,s,r,i,a){const n=((e,t,s,r)=>{const i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),s))})(t,r,i,a);let o;try{o=await e(s,Object.assign({},n))}catch(l){throw console.error(l),new ri(ni(l),0)}o.ok||await li(o);if(null==r?void 0:r.noResolveJson)return o;try{return await o.json()}catch(l){await li(l)}}(e,t,s+o,{headers:a,noResolveJson:null==r?void 0:r.noResolveJson},{},null==r?void 0:r.body);return(null==r?void 0:r.xform)?null==r?void 0:r.xform(l):{data:Object.assign({},l),error:null}}function di(e){var t;let s=null;var r;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(s=Object.assign({},e),e.expires_at||(s.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:s,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function hi(e){const t=di(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce(((e,t)=>e&&"string"==typeof t),!0)&&(t.data.weak_password=e.weak_password),t}function ui(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function mi(e){return{data:e,error:null}}function pi(e){const{action_link:t,email_otp:s,hashed_token:r,redirect_to:i,verification_type:a}=e,n=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(s[r[i]]=e[r[i]])}return s}(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:s,hashed_token:r,redirect_to:i,verification_type:a},user:Object.assign({},n)},error:null}}function gi(e){return e}class fi{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=Ur(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await ci(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Gr(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await ci(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ui})}catch(s){if(Gr(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(s[r[i]]=e[r[i]])}return s}(e,["options"]),r=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(r.new_email=null==s?void 0:s.newEmail,delete r.newEmail),await ci(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:pi,redirectTo:null==t?void 0:t.redirectTo})}catch(t){if(Gr(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await ci(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ui})}catch(t){if(Gr(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,r,i,a,n,o;try{const l={nextPage:null,lastPage:0,total:0},c=await ci(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(s=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==s?s:"",per_page:null!==(i=null===(r=null==e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==i?i:""},xform:gi});if(c.error)throw c.error;const d=await c.json(),h=null!==(a=c.headers.get("x-total-count"))&&void 0!==a?a:0,u=null!==(o=null===(n=c.headers.get("link"))||void 0===n?void 0:n.split(","))&&void 0!==o?o:[];return u.length>0&&(u.forEach((e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),s=JSON.parse(e.split(";")[1].split("=")[1]);l[`${s}Page`]=t})),l.total=parseInt(h)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(Gr(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){try{return await ci(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ui})}catch(t){if(Gr(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await ci(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:ui})}catch(s){if(Gr(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){try{return await ci(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:ui})}catch(s){if(Gr(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:t,error:s}=await ci(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:s}}catch(t){if(Gr(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await ci(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Gr(t))return{data:null,error:t};throw t}}}const xi={getItem:e=>Lr()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Lr()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Lr()&&globalThis.localStorage.removeItem(e)}};function vi(e={}){return{getItem:t=>e[t]||null,setItem:(t,s)=>{e[t]=s},removeItem:t=>{delete e[t]}}}const bi=!!(globalThis&&Lr()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class wi extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class yi extends wi{}async function ji(e,t,s){bi&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout((()=>{r.abort(),bi&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)}),t),await Promise.resolve().then((()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},(async r=>{if(!r){if(0===t)throw bi&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new yi(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(bi)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}bi&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,r.name);try{return await s()}finally{bi&&console.log("@supabase/gotrue-js: navigatorLock: released",e,r.name)}}))))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const Ni={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ir,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},ki=3e4;async function _i(e,t,s){return await s()}class Si{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Si.nextInstanceID,Si.nextInstanceID+=1,this.instanceID>0&&Ar()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},Ni),e);if(this.logDebugMessages=!!r.debug,"function"==typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new fi({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Ur(r.fetch),this.lock=r.lock||_i,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Ar()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=ji:this.lock=_i,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:Lr()?this.storage=xi:(this.memoryStorage={},this.storage=vi(this.memoryStorage)):(this.memoryStorage={},this.storage=vi(this.memoryStorage)),Ar()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}null===(s=this.broadcastChannel)||void 0===s||s.addEventListener("message",(async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Pr}) ${(new Date).toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},s=new URL(e);if(s.hash&&"#"===s.hash[0])try{new URLSearchParams(s.hash.substring(1)).forEach(((e,s)=>{t[s]=e}))}catch(r){}return s.searchParams.forEach(((e,s)=>{t[s]=e})),t}(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),Ar()&&this.detectSessionInUrl&&"none"!==s){const{data:r,error:i}=await this._getSessionFromURL(t,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),function(e){return Gr(e)&&"AuthImplicitGrantRedirectError"===e.name}(i)){const t=null===(e=i.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:n}=r;return this._debug("#_initialize()","detected session in URL",a,"redirect type",n),await this._saveSession(a),setTimeout((async()=>{"recovery"===n?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Gr(t)?{error:t}:{error:new Yr("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,r;try{const i=await ci(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(s=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==s?s:{},gotrue_meta_security:{captcha_token:null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken}},xform:di}),{data:a,error:n}=i;if(n||!a)return{data:{user:null,session:null},error:n};const o=a.session,l=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(i){if(Gr(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,s,r;try{let i;if("email"in e){const{email:s,password:r,options:a}=e;let n=null,o=null;"pkce"===this.flowType&&([n,o]=await qr(this.storage,this.storageKey)),i=await ci(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==a?void 0:a.emailRedirectTo,body:{email:s,password:r,data:null!==(t=null==a?void 0:a.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken},code_challenge:n,code_challenge_method:o},xform:di})}else{if(!("phone"in e))throw new ei("You must provide either an email or phone number and a password");{const{phone:t,password:a,options:n}=e;i=await ci(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:a,data:null!==(s=null==n?void 0:n.data)&&void 0!==s?s:{},channel:null!==(r=null==n?void 0:n.channel)&&void 0!==r?r:"sms",gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:di})}}const{data:a,error:n}=i;if(n||!a)return{data:{user:null,session:null},error:n};const o=a.session,l=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(i){if(Gr(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:r,options:i}=e;t=await ci(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:hi})}else{if(!("phone"in e))throw new ei("You must provide either an email or phone number and a password");{const{phone:s,password:r,options:i}=e;t=await ci(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:hi})}}const{data:s,error:r}=t;return r?{data:{user:null,session:null},error:r}:s&&s.session&&s.user?(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r}):{data:{user:null,session:null},error:new Qr}}catch(t){if(Gr(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,r,i;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:null===(i=e.options)||void 0===i?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(e)))}async _exchangeCodeForSession(e){const t=await Fr(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(null!=t?t:"").split("/");try{const{data:t,error:i}=await ci(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:di});if(await Mr(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=r?r:null}),error:i}):{data:{user:null,session:null,redirectType:null},error:new Qr}}catch(i){if(Gr(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:s,token:r,access_token:i,nonce:a}=e,n=await ci(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:di}),{data:o,error:l}=n;return l?{data:{user:null,session:null},error:l}:o&&o.session&&o.user?(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:l}):{data:{user:null,session:null},error:new Qr}}catch(t){if(Gr(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,r,i,a;try{if("email"in e){const{email:r,options:i}=e;let a=null,n=null;"pkce"===this.flowType&&([a,n]=await qr(this.storage,this.storageKey));const{error:o}=await ci(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:r,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},create_user:null===(s=null==i?void 0:i.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:a,code_challenge_method:n},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){const{phone:t,options:s}=e,{data:n,error:o}=await ci(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(r=null==s?void 0:s.data)&&void 0!==r?r:{},create_user:null===(i=null==s?void 0:s.shouldCreateUser)||void 0===i||i,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},channel:null!==(a=null==s?void 0:s.channel)&&void 0!==a?a:"sms"}});return{data:{user:null,session:null,messageId:null==n?void 0:n.message_id},error:o}}throw new ei("You must provide either an email or phone number.")}catch(n){if(Gr(n))return{data:{user:null,session:null},error:n};throw n}}async verifyOtp(e){var t,s;try{let r,i;"options"in e&&(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo,i=null===(s=e.options)||void 0===s?void 0:s.captchaToken);const{data:a,error:n}=await ci(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:r,xform:di});if(n)throw n;if(!a)throw new Error("An error occurred on token verification.");const o=a.session,l=a.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(r){if(Gr(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,s,r;try{let i=null,a=null;return"pkce"===this.flowType&&([i,a]=await qr(this.storage,this.storageKey)),await ci(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==s?s:void 0}),(null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:mi})}catch(i){if(Gr(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new Xr;const{error:r}=await ci(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}}))}catch(e){if(Gr(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:i}=e,{error:a}=await ci(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){const{phone:s,type:r,options:i}=e,{data:a,error:n}=await ci(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:null==a?void 0:a.message_id},error:n}}throw new ei("You must provide either an email or phone number and a type")}catch(t){if(Gr(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,(async()=>this._useSession((async e=>e))))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch(e){}})()),s}return await this.lock(`lock:${this.storageKey}`,e,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await Fr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=!!e.expires_at&&e.expires_at<=Date.now()/1e3;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,s,r)=>(t||"user"!==s||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,s,r))})}return{data:{session:e},error:null}}const{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,(async()=>await this._getUser()))}async _getUser(e){try{return e?await ci(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ui}):await this._useSession((async e=>{var t,s,r;const{data:i,error:a}=e;if(a)throw a;return(null===(t=i.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await ci(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(r=null===(s=i.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0,xform:ui}):{data:{user:null},error:new Xr}}))}catch(t){if(Gr(t))return function(e){return Gr(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await Mr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(e,t)))}async _updateUser(e,t={}){try{return await this._useSession((async s=>{const{data:r,error:i}=s;if(i)throw i;if(!r.session)throw new Xr;const a=r.session;let n=null,o=null;"pkce"===this.flowType&&null!=e.email&&([n,o]=await qr(this.storage,this.storageKey));const{data:l,error:c}=await ci(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:n,code_challenge_method:o}),jwt:a.access_token,xform:ui});if(c)throw c;return a.user=l.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}}))}catch(s){if(Gr(s))return{data:{user:null},error:s};throw s}}_decodeJWT(e){return Br(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(e)))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Xr;const t=Date.now()/1e3;let s=t,r=!0,i=null;const a=Br(e.access_token);if(a.exp&&(s=a.exp,r=s<=t),r){const{session:t,error:s}=await this._callRefreshToken(e.refresh_token);if(s)return{data:{user:null,session:null},error:s};if(!t)return{data:{user:null,session:null},error:null};i=t}else{const{data:r,error:a}=await this._getUser(e.access_token);if(a)throw a;i={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(Gr(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(e)))}async _refreshSession(e){try{return await this._useSession((async t=>{var s;if(!e){const{data:r,error:i}=t;if(i)throw i;e=null!==(s=r.session)&&void 0!==s?s:void 0}if(!(null==e?void 0:e.refresh_token))throw new Xr;const{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}}))}catch(t){if(Gr(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Ar())throw new ti("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ti(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new si("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new ti("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new si("No code detected.");const{data:t,error:s}=await this._exchangeCodeForSession(e.code);if(s)throw s;const r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:i,refresh_token:a,expires_in:n,expires_at:o,token_type:l}=e;if(!(i&&n&&a&&l))throw new ti("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(n);let h=c+d;o&&(h=parseInt(o));const u=h-c;1e3*u<=ki&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${u}s, should have been closer to ${d}s`);const m=h-d;c-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,h,c):c-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,h,c);const{data:p,error:g}=await this._getUser(i);if(g)throw g;const f={provider_token:s,provider_refresh_token:r,access_token:i,expires_in:d,expires_at:h,refresh_token:a,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:f,redirectType:e.type},error:null}}catch(s){if(Gr(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Fr(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(e)))}async _signOut({scope:e}={scope:"global"}){return await this._useSession((async t=>{var s;const{data:r,error:i}=t;if(i)return{error:i};const a=null===(s=r.session)||void 0===s?void 0:s.access_token;if(a){const{error:t}=await this.admin.signOut(a,e);if(t&&(!function(e){return Gr(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await Mr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(t)}))})(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession((async t=>{var s,r;try{const{data:{session:r},error:i}=t;if(i)throw i;await(null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(i){await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}}))}async resetPasswordForEmail(e,t={}){let s=null,r=null;"pkce"===this.flowType&&([s,r]=await qr(this.storage,this.storageKey,!0));try{return await ci(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(Gr(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(Gr(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:r}=await this._useSession((async t=>{var s,r,i,a,n;const{data:o,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(s=e.options)||void 0===s?void 0:s.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(i=e.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:!0});return await ci(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(n=null===(a=o.session)||void 0===a?void 0:a.access_token)&&void 0!==n?n:void 0})}));if(r)throw r;return Ar()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==s?void 0:s.url),{data:{provider:e.provider,url:null==s?void 0:s.url},error:null}}catch(s){if(Gr(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession((async t=>{var s,r;const{data:i,error:a}=t;if(a)throw a;return await ci(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(r=null===(s=i.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0})}))}catch(t){if(Gr(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await(s=async s=>(s>0&&await async function(e){return await new Promise((t=>{setTimeout((()=>t(null)),e)}))}(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await ci(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:di})),r=(e,t)=>{const s=200*Math.pow(2,e);return t&&ii(t)&&Date.now()+s-i<ki},new Promise(((e,t)=>{(async()=>{for(let a=0;a<1/0;a++)try{const t=await s(a);if(!r(a,null,t))return void e(t)}catch(i){if(!r(a,i))return void t(i)}})()})))}catch(i){if(this._debug(t,"error",i),Gr(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(t,"end")}var s,r}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),Ar()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await Fr(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s))return this._debug(t,"session is not valid"),void(null!==s&&await this._removeSession());const r=Math.round(Date.now()/1e3),i=(null!==(e=s.expires_at)&&void 0!==e?e:1/0)<r+10;if(this._debug(t,`session has${i?"":" not"} expired with margin of 10s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:e}=await this._callRefreshToken(s.refresh_token);e&&(console.error(e),ii(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){return this._debug(t,"error",s),void console.error(s)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new Xr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Vr;const{data:t,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!t.session)throw new Xr;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const r={session:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(i){if(this._debug(r,"error",i),Gr(i)){const e={session:null,error:i};return ii(i)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(s=this.refreshingDeferred)||void 0===s||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],i=Array.from(this.stateChangeEmitters.values()).map((async s=>{try{await s.callback(e,t)}catch(i){r.push(i)}}));if(await Promise.all(i),r.length>0){for(let e=0;e<r.length;e+=1)console.error(r[e]);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Dr(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Mr(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ar()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval((()=>this._autoRefreshTokenTick()),ki);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const t=Date.now();try{return await this._useSession((async e=>{const{data:{session:s}}=e;if(!s||!s.refresh_token||!s.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const r=Math.floor((1e3*s.expires_at-t)/ki);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),r<=3&&await this._callRefreshToken(s.refresh_token)}))}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(!(e.isAcquireTimeout||e instanceof wi))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ar()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const r=[`provider=${encodeURIComponent(t)}`];if((null==s?void 0:s.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),(null==s?void 0:s.scopes)&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),"pkce"===this.flowType){const[e,t]=await qr(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});r.push(s.toString())}if(null==s?void 0:s.queryParams){const e=new URLSearchParams(s.queryParams);r.push(e.toString())}return(null==s?void 0:s.skipBrowserRedirect)&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession((async t=>{var s;const{data:r,error:i}=t;return i?{data:null,error:i}:await ci(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})}))}catch(t){if(Gr(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession((async t=>{var s,r;const{data:i,error:a}=t;if(a)return{data:null,error:a};const n=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await ci(this.fetch,"POST",`${this.url}/factors`,{body:n,headers:this.headers,jwt:null===(s=null==i?void 0:i.session)||void 0===s?void 0:s.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(r=null==o?void 0:o.totp)||void 0===r?void 0:r.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})}))}catch(t){if(Gr(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var s;const{data:r,error:i}=t;if(i)return{data:null,error:i};const{data:a,error:n}=await ci(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token});return n?{data:null,error:n}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:n})}))}catch(t){if(Gr(t))return{data:null,error:t};throw t}}))}async _challenge(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var s;const{data:r,error:i}=t;return i?{data:null,error:i}:await ci(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})}))}catch(t){if(Gr(t))return{data:null,error:t};throw t}}))}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(null==e?void 0:e.factors)||[],r=s.filter((e=>"totp"===e.factor_type&&"verified"===e.status)),i=s.filter((e=>"phone"===e.factor_type&&"verified"===e.status));return{data:{all:s,totp:r,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async e=>{var t,s;const{data:{session:r},error:i}=e;if(i)return{data:null,error:i};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(r.access_token);let n=null;a.aal&&(n=a.aal);let o=n;(null!==(s=null===(t=r.user.factors)||void 0===t?void 0:t.filter((e=>"verified"===e.status)))&&void 0!==s?s:[]).length>0&&(o="aal2");return{data:{currentLevel:n,nextLevel:o,currentAuthenticationMethods:a.amr||[]},error:null}}))))}}Si.nextInstanceID=0;const Ti=Si;class Ei extends Ti{constructor(e){super(e)}}var Ci=function(e,t,s,r){return new(s||(s=Promise))((function(i,a){function n(e){try{l(r.next(e))}catch(t){a(t)}}function o(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((r=r.apply(e,t||[])).next())}))};class Pi{constructor(e,t,s){var r,i,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const n=e.replace(/\/$/,"");this.realtimeUrl=`${n}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${n}/auth/v1`,this.storageUrl=`${n}/storage/v1`,this.functionsUrl=`${n}/functions/v1`;const o=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,l=function(e,t){const{db:s,auth:r,realtime:i,global:a}=e,{db:n,auth:o,realtime:l,global:c}=t,d={db:Object.assign(Object.assign({},n),s),auth:Object.assign(Object.assign({},o),r),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},c),a),accessToken:()=>Cr(this,void 0,void 0,(function*(){return""}))};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}(null!=s?s:{},{db:kr,realtime:Sr,auth:Object.assign(Object.assign({},_r),{storageKey:o}),global:Nr});this.storageKey=null!==(r=l.auth.storageKey)&&void 0!==r?r:"",this.headers=null!==(i=l.global.headers)&&void 0!==i?i:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(a=l.auth)&&void 0!==a?a:{},this.headers,l.global.fetch),this.fetch=Er(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new cs(`${n}/rest/v1`,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),l.accessToken||this._listenForAuthEvents()}get functions(){return new wt(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new yr(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Ci(this,void 0,void 0,(function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return null!==(t=null===(e=s.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null}))}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,storageKey:i,flowType:a,lock:n,debug:o},l,c){var d;const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Ei({url:this.authUrl,headers:Object.assign(Object.assign({},h),l),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,flowType:a,lock:n,debug:o,fetch:c,hasCustomAuthorizationHeader:null!==(d="Authorization"in this.headers)&&void 0!==d&&d})}_initRealtimeClient(e){return new Xs(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)}))}_handleTokenChanged(e,t,s){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===s?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=s}}const Ii=(e,t,s)=>new Pi(e,t,s),$i=Ii("https://ighpjdpsntdcsdvqnipc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlnaHBqZHBzbnRkY3NkdnFuaXBjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzYxMjk4NDAsImV4cCI6MjA1MTcwNTg0MH0.9nwDeL6ERmU50WiMRJz4bLcpfhB6EXnDul2njD7GV2k"),Oi=dt((e=>({user:null,isAuthenticated:!1,signIn:async(t,s)=>{try{const{data:r,error:i}=await $i.auth.signInWithPassword({email:t,password:s});if(i)throw i;if(!r.user)throw new Error("No user data returned");const{data:a,error:n}=await $i.from("profiles").select("*").eq("id",r.user.id).single();if(n){const s=t.split("@")[0],{data:i,error:a}=await $i.from("profiles").insert({id:r.user.id,username:s,display_name:s,is_verified:!1,is_premium:!1,is_creator:!1}).select().single();if(a)throw a;e({user:{id:r.user.id,email:r.user.email,username:s,isVerified:!1,isPremium:!1,createdAt:r.user.created_at,profile:i},isAuthenticated:!0})}else e({user:{id:r.user.id,email:r.user.email,username:a.username,isVerified:a.is_verified,isPremium:a.is_premium,createdAt:r.user.created_at,profile:a},isAuthenticated:!0})}catch(r){throw console.error("Auth error:",r),r}},signUp:async(t,s)=>{try{const{data:r,error:i}=await $i.auth.signUp({email:t,password:s});if(i)throw i;if(!r.user)throw new Error("No user data returned");const a=t.split("@")[0],{data:n,error:o}=await $i.from("profiles").insert({id:r.user.id,username:a,display_name:a,is_verified:!1,is_premium:!1,is_creator:!1}).select().single();if(o)throw o;e({user:{id:r.user.id,email:r.user.email,username:a,isVerified:!1,isPremium:!1,createdAt:r.user.created_at,profile:n},isAuthenticated:!0})}catch(r){throw console.error("Signup error:",r),r}},signOut:async()=>{await $i.auth.signOut(),e({user:null,isAuthenticated:!1})},setUser:t=>e({user:t,isAuthenticated:!!t})})));function Ai({className:e="h-8 w-8 text-gold-500"}){return Ie.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:e,children:Ie.jsx("path",{d:"M14 2L4 14h6l-2 8 10-12h-6l2-8z",strokeLinecap:"round",strokeLinejoin:"round"})})}const Ri=["https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4","https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerEscapes.mp4","https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4","https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.mp4","https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerMeltdowns.mp4","https://storage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4"],Li=["1514525253161-7a46d19cd819","1516450360452-9312f5e86fc7","1511671782779-c97d3d27a1d4","1459749411175-04bf5292ceea","1489599849927-2ee91cede3ba","1536440136628-849c177e76a1"],Ui=[];["Music","Movies","Sports","Comedy","News","Podcasts","Lifestyle","Inspiration","Arts","Kids"].forEach(((e,t)=>{for(let s=0;s<10;s++){const r=Ri[s%Ri.length],i=Li[s%Li.length];Ui.push({id:`${e}-${s}`,title:`${e} Video ${s+1}`,description:`Amazing ${e.toLowerCase()} content`,thumbnailUrl:`https://images.unsplash.com/photo-${i}?w=1280&h=720&fit=crop`,videoUrl:r,previewUrl:r,category:e,userId:`user${t+1}`,user:{id:`user${t+1}`,username:`${e} Creator ${s+1}`,email:`creator${s}@example.com`,isVerified:!0,isPremium:s%2==0,createdAt:"2024-01-01T00:00:00Z"},views:Math.floor(1e6*Math.random()),likes:Math.floor(1e5*Math.random()),shares:Math.floor(5e3*Math.random()),comments:Math.floor(1e4*Math.random()),createdAt:new Date(Date.now()-30*Math.random()*24*60*60*1e3).toISOString(),isLive:0===s,isPPV:1===s,duration:`${Math.floor(10*Math.random()+2)}:${Math.floor(60*Math.random()).toString().padStart(2,"0")}`,metrics:{impressions:Math.floor(1e6*Math.random()),views:Math.floor(5e5*Math.random()),likes:Math.floor(1e5*Math.random()),comments:Math.floor(5e4*Math.random()),shares:Math.floor(25e3*Math.random()),lastUpdated:new Date(Date.now()-30*Math.random()*24*60*60*1e3).toISOString()}})}}));const Di=dt(((e,t)=>({videos:Ui,autoplay:!0,miniPlayerVideo:null,getFeaturedVideos:e=>{const{videos:s}=t();return(e?s.filter((t=>t.category===e)):s).sort(((e,t)=>t.views-e.views)).slice(0,10)},getPersonalizedVideos:e=>{const{videos:s}=t();return(e?s.filter((t=>t.category===e)):s).sort((()=>Math.random()-.5)).slice(0,10)},getTop100Videos:e=>{const{videos:s}=t();return(e?s.filter((t=>t.category===e)):s).sort(((e,t)=>t.views+2*t.likes-(e.views+2*e.likes))).slice(0,10)},incrementViews:t=>e((e=>({videos:e.videos.map((e=>e.id===t?{...e,views:e.views+1}:e))}))),toggleAutoplay:()=>e((e=>({autoplay:!e.autoplay}))),setMiniPlayerVideo:t=>e({miniPlayerVideo:t}),closeMiniPlayer:()=>e({miniPlayerVideo:null})})));function Fi(e,t){const s=Array(t.length+1).fill(null).map((()=>Array(e.length+1).fill(null)));for(let r=0;r<=e.length;r+=1)s[0][r]=r;for(let r=0;r<=t.length;r+=1)s[r][0]=r;for(let r=1;r<=t.length;r+=1)for(let i=1;i<=e.length;i+=1){const a=e[i-1].toLowerCase()===t[r-1].toLowerCase()?0:1;s[r][i]=Math.min(s[r][i-1]+1,s[r-1][i]+1,s[r-1][i-1]+a)}return s[t.length][e.length]}function Mi(e){return e.toLowerCase().split(/\s+/).filter(Boolean)}const Vi=dt(((e,t)=>({query:"",suggestions:[],isOpen:!1,setQuery:s=>{const r=t().search(s);e({query:s,suggestions:r})},clearQuery:()=>e({query:"",suggestions:[]}),toggleOpen:t=>e({isOpen:t}),search:e=>{if(!e.trim())return[];const{videos:t}=Di.getState(),s=[],r=e.toLowerCase(),i=t.filter((e=>e.title.toLowerCase().includes(r)));if(0===i.length){const i=t.filter((t=>function(e,t){const s=Mi(e),r=Mi(t);for(const i of s)for(const e of r)if(Fi(i,e)<=(Math.max(i.length,e.length)<=4?1:2))return!0;return!1}(e,t.title))).map((e=>({video:e,title:e.title,distance:Fi(r,e.title.toLowerCase())}))).sort(((e,t)=>e.distance-t.distance)).slice(0,3).map((({video:e,title:t})=>({type:"correction",text:t,video:e})));s.push(...i)}const a=t.filter((e=>e.title.toLowerCase().startsWith(r)||e.title.toLowerCase().split(" ").some((e=>e.startsWith(r))))).slice(0,3).map((e=>({type:"completion",text:e.title,video:e})));s.push(...a);const n=t.filter((e=>!i.includes(e)&&!s.some((t=>{var s;return(null==(s=t.video)?void 0:s.id)===e.id}))&&(e.description.toLowerCase().includes(r)||e.category.toLowerCase().includes(r)))).slice(0,3).map((e=>({type:"related",text:e.title,video:e})));return s.push(...n),s}})));function Bi(){const t=n(),s=e.useRef(null),{query:r,suggestions:i,isOpen:a,setQuery:o,clearQuery:l,toggleOpen:c}=Vi();e.useEffect((()=>{const e=e=>{s.current&&!s.current.contains(e.target)&&c(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[c]);const d=e=>{o(e),t(`/search?q=${encodeURIComponent(e)}`),c(!1)},h=i.filter((e=>"correction"===e.type)),u=i.filter((e=>"completion"===e.type)),m=i.filter((e=>"related"===e.type));return Ie.jsxs("div",{className:"relative flex-1 max-w-2xl mx-8",ref:s,children:[Ie.jsx("form",{onSubmit:e=>{null==e||e.preventDefault(),r.trim()&&(t(`/search?q=${encodeURIComponent(r)}`),c(!1))},children:Ie.jsxs("div",{className:"relative",children:[Ie.jsx("input",{type:"text",value:r,onChange:e=>{o(e.target.value),c(!0)},onFocus:()=>c(!0),placeholder:"Search videos...",className:"w-full bg-white px-6 py-2.5 pr-24 rounded-full border border-gold-200 focus:outline-none focus:ring-2 focus:ring-gold-300/50 focus:border-transparent placeholder-gray-400"}),Ie.jsxs("div",{className:"absolute right-3 top-2 flex items-center gap-2",children:[r&&Ie.jsx("button",{type:"button",onClick:()=>{l(),c(!1)},className:"text-gray-400 hover:text-gray-600 p-1",children:Ie.jsx(g,{className:"h-5 w-5"})}),Ie.jsx("button",{type:"submit",className:"text-gold-400 hover:text-gold-500 p-1",children:Ie.jsx(f,{className:"h-5 w-5"})})]})]})}),a&&i.length>0&&Ie.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-lg shadow-lg border border-gray-100 overflow-hidden z-50",children:[h.length>0&&Ie.jsx("div",{className:"border-b border-gray-100",children:h.map(((e,t)=>Ie.jsxs("button",{onClick:()=>d(e.text),className:"w-full px-4 py-3 text-left hover:bg-gray-50 flex items-center gap-3",children:[Ie.jsx(x,{className:"h-4 w-4 text-purple-500"}),Ie.jsxs("div",{children:[Ie.jsx("div",{className:"text-sm text-purple-600 font-medium mb-0.5",children:"Did you mean:"}),Ie.jsx("div",{className:"font-medium",children:e.text})]})]},`correction-${t}`)))}),u.map(((e,t)=>Ie.jsxs("button",{onClick:()=>d(e.text),className:"w-full px-4 py-2 text-left hover:bg-gray-50 flex items-center gap-3",children:[Ie.jsx(f,{className:"h-4 w-4 text-gold-500"}),Ie.jsx("div",{className:"font-medium",children:e.text})]},`completion-${t}`))),m.length>0&&Ie.jsx("div",{className:"border-t border-gray-100",children:m.map(((e,t)=>Ie.jsxs("button",{onClick:()=>d(e.text),className:"w-full px-4 py-2 text-left hover:bg-gray-50 flex items-center gap-3",children:[Ie.jsx(f,{className:"h-4 w-4 text-blue-500"}),Ie.jsxs("div",{children:[Ie.jsx("div",{className:"font-medium",children:e.text}),Ie.jsx("div",{className:"text-xs text-gray-500",children:"Related"})]})]},`related-${t}`)))})]})]})}function zi(){const t=n(),{isAuthenticated:s,user:r,signOut:i}=Oi(),[a,l]=e.useState(!1);return Ie.jsxs("nav",{className:"fixed top-0 w-full bg-white shadow-sm z-50",children:[Ie.jsxs("div",{className:"h-16 px-4",children:[Ie.jsxs("div",{className:"flex items-center justify-between h-full max-w-7xl mx-auto",children:[Ie.jsx("div",{className:"w-32 flex-shrink-0",children:Ie.jsxs(o,{to:"/",className:"flex items-center gap-2",children:[Ie.jsx(Ai,{className:"h-8 w-8 text-gold-500"}),Ie.jsx("span",{className:"text-xl font-light tracking-wider text-gray-900",children:"VISION"})]})}),Ie.jsx("div",{className:"hidden md:flex flex-1 justify-center max-w-2xl",children:Ie.jsx(Bi,{})}),Ie.jsxs("div",{className:"w-32 flex items-center justify-end gap-4",children:[s&&r?Ie.jsxs(Ie.Fragment,{children:[Ie.jsx(o,{to:"/upload",className:"text-gold-600 hover:text-gold-700 transition-colors hidden sm:block",children:Ie.jsx(v,{className:"h-6 w-6"})}),Ie.jsx("div",{className:"relative",children:Ie.jsxs(o,{to:"/notifications",className:"text-gold-600 hover:text-gold-700 transition-colors",children:[Ie.jsx(b,{className:"h-6 w-6"}),Ie.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs w-4 h-4 flex items-center justify-center rounded-full",children:"3"})]})}),Ie.jsxs("div",{className:"relative group",children:[Ie.jsx("button",{className:"flex items-center space-x-2",children:Ie.jsx("div",{className:"w-8 h-8 rounded-full bg-gold-100 overflow-hidden",children:r.avatar?Ie.jsx("img",{src:r.avatar,alt:r.username,className:"w-full h-full object-cover"}):Ie.jsx(w,{className:"h-6 w-6 m-1 text-gold-600"})})}),Ie.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-1 invisible group-hover:visible opacity-0 group-hover:opacity-100 transition-all duration-200",children:[Ie.jsx(o,{to:`/profile/${r.username}`,className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gold-50",children:"Profile"}),Ie.jsx(o,{to:"/settings",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gold-50",children:"Settings"}),Ie.jsx("hr",{className:"my-1"}),Ie.jsx("button",{onClick:async()=>{await i(),t("/")},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gold-50",children:"Sign Out"})]})]})]}):Ie.jsx(o,{to:"/auth",className:"bg-gold-500 hover:bg-gold-600 text-white px-6 py-2 rounded-full font-medium transition-colors whitespace-nowrap",children:"Sign In"}),Ie.jsx("button",{onClick:()=>l(!a),className:"md:hidden p-2 rounded-md text-gray-600 hover:text-gray-900",children:a?Ie.jsx(g,{className:"h-6 w-6"}):Ie.jsx(y,{className:"h-6 w-6"})})]})]}),Ie.jsx("div",{className:"md:hidden px-4 pb-2",children:Ie.jsx(Bi,{})})]}),a&&Ie.jsx("div",{className:"md:hidden border-t border-gray-200",children:Ie.jsxs("div",{className:"px-4 pt-2 pb-3 space-y-1",children:[Ie.jsx(o,{to:"/",className:"block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Home"}),Ie.jsx(o,{to:"/sparks",className:"block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Sparks"}),Ie.jsx(o,{to:"/tv",className:"block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"TV"}),Ie.jsx(o,{to:"/live",className:"block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Live"})]})})]})}function Ji(...e){return j(N(e))}function qi(e){const t=new Date(e),s=new Date,r=Math.floor((s.getTime()-t.getTime())/1e3),i={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60};for(const[a,n]of Object.entries(i)){const e=Math.floor(r/n);if(e>=1)return`${e} ${a}${1===e?"":"s"} ago`}return"just now"}function Hi(e){return e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:e.toString()}const Wi=[{icon:_,label:"Home",path:"/"},{icon:S,label:"Sparks",path:"/sparks"},{icon:T,label:"Top 100",path:"/top-100"},{icon:E,label:"Live",path:"/live"},{icon:C,label:"UNLIMITED",path:"/unlimited",premium:!0},{icon:P,label:"VISION TV",path:"/tv"},{icon:I,label:"Music",path:"/category/music"},{icon:$,label:"Movies",path:"/category/movies"},{icon:O,label:"Sports",path:"/category/sports"},{icon:A,label:"Comedy",path:"/category/comedy"},{icon:R,label:"News",path:"/category/news"},{icon:L,label:"Podcasts",path:"/category/podcasts"},{icon:U,label:"Lifestyle",path:"/category/lifestyle"},{icon:D,label:"Inspiration",path:"/category/inspiration"},{icon:F,label:"Arts",path:"/category/arts"},{icon:M,label:"Kids",path:"/category/kids"}];function Gi(){const e=l(),t=t=>"/"===t?"/"===e.pathname:e.pathname.startsWith(t);return Ie.jsx("aside",{className:"fixed left-0 top-16 h-[calc(100vh-4rem)] w-52 bg-white border-r border-gold-100 overflow-y-auto hidden lg:block",children:Ie.jsxs("div",{className:"p-4 flex flex-col h-full",children:[Ie.jsx("div",{className:"flex-1",children:Wi.map((e=>{const s=t(e.path);return Ie.jsxs(o,{to:e.path,className:Ji("flex items-center space-x-3 px-3 py-2 rounded-lg transition-all",s&&"bg-gold-50 font-medium",e.premium?"text-gold-500":s?"text-gold-700":"text-gray-700 hover:bg-gold-50 hover:text-gold-700"),children:[Ie.jsx(e.icon,{className:Ji("h-5 w-5",e.premium?"text-gold-500":s?"text-gold-700":"")}),Ie.jsx("span",{children:e.label})]},e.path)}))}),Ie.jsx("div",{className:"pt-4 border-t border-gold-100",children:Ie.jsxs(o,{to:"/settings",className:Ji("flex items-center space-x-3 px-3 py-2 rounded-lg transition-all",t("/settings")?"bg-gold-50 text-gold-700 font-medium":"text-gray-700 hover:bg-gold-50 hover:text-gold-700"),children:[Ie.jsx(k,{className:Ji("h-5 w-5",t("/settings")&&"text-gold-700")}),Ie.jsx("span",{children:"Settings"})]})})]})})}function Ki(){const{miniPlayerVideo:e,closeMiniPlayer:t}=Di();return e?Ie.jsxs("div",{className:"fixed bottom-4 right-4 w-80 bg-white rounded-lg shadow-lg overflow-hidden z-50",children:[Ie.jsxs("div",{className:"relative",children:[Ie.jsx(o,{to:`/watch/${e.id}`,children:Ie.jsx("video",{src:e.videoUrl,className:"w-full aspect-video",controls:!0,autoPlay:!0})}),Ie.jsx("button",{onClick:t,className:"absolute top-2 right-2 p-1 bg-black/50 rounded-full text-white hover:bg-black/70",children:Ie.jsx(g,{className:"h-4 w-4"})})]}),Ie.jsxs("div",{className:"p-2",children:[Ie.jsx(o,{to:`/watch/${e.id}`,className:"font-medium text-sm line-clamp-1 hover:text-gold-600",children:e.title}),Ie.jsx(o,{to:`/profile/${e.user.username}`,className:"text-xs text-gray-600 hover:text-gray-900",children:e.user.username})]})]}):null}const Yi=[{id:"1",imageUrl:"https://images.unsplash.com/photo-1514525253161-7a46d19cd819?w=2000&h=700&fit=crop",link:"/videos/live-concert-2024",title:"Experience Live Music Like Never Before",subtitle:"Watch exclusive live concerts from top artists"},{id:"2",imageUrl:"https://images.unsplash.com/photo-1578022761797-b8636ac1773c?w=2000&h=700&fit=crop",link:"/videos/sports-championship",title:"Championship Finals - Watch Live",subtitle:"Catch all the action live this weekend"},{id:"3",imageUrl:"https://images.unsplash.com/photo-1492684223066-81342ee5ff30?w=2000&h=700&fit=crop",link:"/videos/comedy-special",title:"Comedy Night Special",subtitle:"An evening of non-stop laughter with top comedians"}];function Zi(){const[t,s]=e.useState(0),[r,i]=e.useState(0);return e.useEffect((()=>{const e=setInterval((()=>{i(1),s((e=>(e+1)%Yi.length))}),5e3);return()=>clearInterval(e)}),[]),Ie.jsx("div",{className:"relative w-full h-[200px] md:h-[280px] group bg-white px-4 lg:px-8 pt-4",children:Ie.jsxs("div",{className:"relative w-full h-full flex items-center justify-center overflow-hidden",children:[Ie.jsx("div",{className:"w-full h-full rounded-xl md:rounded-[2rem] overflow-hidden shadow-xl relative z-20",children:Yi.map(((e,s)=>Ie.jsxs(o,{to:e.link,className:"absolute inset-0 transition-all duration-800",style:{opacity:s===t?1:0,transform:`rotateY(${s===t?"0deg":s===(t-r+Yi.length)%Yi.length?"50deg":"-50deg"})`,transformOrigin:r>0?"left center":"right center"},children:[Ie.jsx("img",{src:e.imageUrl,alt:e.title,className:"w-full h-full object-cover"}),Ie.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent",children:Ie.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 md:p-8",children:[Ie.jsx("h2",{className:"text-2xl md:text-4xl font-light tracking-wide text-white mb-2",children:e.title}),e.subtitle&&Ie.jsx("p",{className:"text-sm md:text-lg text-gray-200",children:e.subtitle})]})})]},e.id)))}),Ie.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2 z-30",children:Yi.map(((e,r)=>Ie.jsx("button",{onClick:()=>{i(r>t?1:-1),s(r)},className:"w-2 h-2 rounded-full transition-all duration-300 "+(r===t?"bg-white w-6":"bg-white/50"),"aria-label":`Go to banner ${r+1}`},r)))})]})})}const Xi={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlnaHBqZHBzbnRkY3NkdnFuaXBjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzYxMjk4NDAsImV4cCI6MjA1MTcwNTg0MH0.9nwDeL6ERmU50WiMRJz4bLcpfhB6EXnDul2njD7GV2k",VITE_SUPABASE_URL:"https://ighpjdpsntdcsdvqnipc.supabase.co"};function Qi(e,t){let s;try{s=e()}catch(r){return}return{getItem:e=>{var t;const r=e=>null===e?null:JSON.parse(e,void 0),i=null!=(t=s.getItem(e))?t:null;return i instanceof Promise?i.then(r):r(i)},setItem:(e,t)=>s.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>s.removeItem(e)}}const ea=e=>t=>{try{const s=e(t);return s instanceof Promise?s:{then:e=>ea(e)(s),catch(e){return this}}}catch(s){return{then(e){return this},catch:e=>ea(e)(s)}}},ta=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?("production"!==(Xi?"production":void 0)&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),((e,t)=>(s,r,i)=>{let a={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},n=!1;const o=new Set,l=new Set;let c;try{c=a.getStorage()}catch(f){}if(!c)return e(((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),s(...e)}),r,i);const d=ea(a.serialize),h=()=>{const e=a.partialize({...r()});let t;const s=d({state:e,version:a.version}).then((e=>c.setItem(a.name,e))).catch((e=>{t=e}));if(t)throw t;return s},u=i.setState;i.setState=(e,t)=>{u(e,t),h()};const m=e(((...e)=>{s(...e),h()}),r,i);let p;const g=()=>{var e;if(!c)return;n=!1,o.forEach((e=>e(r())));const t=(null==(e=a.onRehydrateStorage)?void 0:e.call(a,r()))||void 0;return ea(c.getItem.bind(c))(a.name).then((e=>{if(e)return a.deserialize(e)})).then((e=>{if(e){if("number"!=typeof e.version||e.version===a.version)return e.state;if(a.migrate)return a.migrate(e.state,e.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}})).then((e=>{var t;return p=a.merge(e,null!=(t=r())?t:m),s(p,!0),h()})).then((()=>{null==t||t(p,void 0),n=!0,l.forEach((e=>e(p)))})).catch((e=>{null==t||t(void 0,e)}))};return i.persist={setOptions:e=>{a={...a,...e},e.getStorage&&(c=e.getStorage())},clearStorage:()=>{null==c||c.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>g(),hasHydrated:()=>n,onHydrate:e=>(o.add(e),()=>{o.delete(e)}),onFinishHydration:e=>(l.add(e),()=>{l.delete(e)})},g(),p||m})(e,t)):((e,t)=>(s,r,i)=>{let a={storage:Qi((()=>localStorage)),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},n=!1;const o=new Set,l=new Set;let c=a.storage;if(!c)return e(((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),s(...e)}),r,i);const d=()=>{const e=a.partialize({...r()});return c.setItem(a.name,{state:e,version:a.version})},h=i.setState;i.setState=(e,t)=>{h(e,t),d()};const u=e(((...e)=>{s(...e),d()}),r,i);let m;i.getInitialState=()=>u;const p=()=>{var e,t;if(!c)return;n=!1,o.forEach((e=>{var t;return e(null!=(t=r())?t:u)}));const i=(null==(t=a.onRehydrateStorage)?void 0:t.call(a,null!=(e=r())?e:u))||void 0;return ea(c.getItem.bind(c))(a.name).then((e=>{if(e){if("number"!=typeof e.version||e.version===a.version)return[!1,e.state];if(a.migrate)return[!0,a.migrate(e.state,e.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]})).then((e=>{var t;const[i,n]=e;if(m=a.merge(n,null!=(t=r())?t:u),s(m,!0),i)return d()})).then((()=>{null==i||i(m,void 0),m=r(),n=!0,l.forEach((e=>e(m)))})).catch((e=>{null==i||i(void 0,e)}))};return i.persist={setOptions:e=>{a={...a,...e},e.storage&&(c=e.storage)},clearStorage:()=>{null==c||c.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>p(),hasHydrated:()=>n,onHydrate:e=>(o.add(e),()=>{o.delete(e)}),onFinishHydration:e=>(l.add(e),()=>{l.delete(e)})},a.skipHydration||p(),m||u})(e,t),sa=dt()(ta(((e,t)=>({playlists:{},recentlyWatched:[],watchLater:[],createPlaylist:(t,s="",r=!1)=>{const i=Math.random().toString(36).substr(2,9),a=(new Date).toISOString();return e((e=>({playlists:{...e.playlists,[i]:{id:i,name:t,description:s,createdBy:"current-user",collaborators:[],videos:[],isPublic:r,createdAt:a,updatedAt:a}}}))),i},addToPlaylist:(t,s)=>e((e=>{const r=e.playlists[t];return!r||r.videos.includes(s)?e:{playlists:{...e.playlists,[t]:{...r,videos:[...r.videos,s],updatedAt:(new Date).toISOString()}}}})),removeFromPlaylist:(t,s)=>e((e=>{const r=e.playlists[t];return r?{playlists:{...e.playlists,[t]:{...r,videos:r.videos.filter((e=>e!==s)),updatedAt:(new Date).toISOString()}}}:e})),addToWatchLater:t=>e((e=>({watchLater:e.watchLater.includes(t)?e.watchLater:[t,...e.watchLater]}))),removeFromWatchLater:t=>e((e=>({watchLater:e.watchLater.filter((e=>e!==t))}))),addToRecentlyWatched:t=>e((e=>({recentlyWatched:[t,...e.recentlyWatched.filter((e=>e!==t))].slice(0,50)}))),addCollaborator:(t,s)=>e((e=>{const r=e.playlists[t];return!r||r.collaborators.includes(s)?e:{playlists:{...e.playlists,[t]:{...r,collaborators:[...r.collaborators,s],updatedAt:(new Date).toISOString()}}}})),removeCollaborator:(t,s)=>e((e=>{const r=e.playlists[t];return r?{playlists:{...e.playlists,[t]:{...r,collaborators:r.collaborators.filter((e=>e!==s)),updatedAt:(new Date).toISOString()}}}:e})),deletePlaylist:t=>e((e=>{const{[t]:s,...r}=e.playlists;return{playlists:r}})),getPlaylist:e=>t().playlists[e]||null,getUserPlaylists:e=>Object.values(t().playlists).filter((t=>t.createdBy===e||t.collaborators.includes(e))),isInWatchLater:e=>t().watchLater.includes(e)})),{name:"vision-playlists"}));function ra({videoId:t,onClose:s,buttonRef:r}){const{playlists:i,watchLater:a,addToWatchLater:n,removeFromWatchLater:o,addToPlaylist:l,removeFromPlaylist:c,createPlaylist:d}=sa(),[h,u]=e.useState(!1),[m,p]=e.useState(""),g=a.includes(t),f=(null==r?void 0:r.current)?{position:"absolute",top:`${r.current.getBoundingClientRect().bottom+8}px`,left:`${r.current.getBoundingClientRect().left}px`}:{};return Ie.jsxs("div",{className:"w-72 bg-white rounded-lg shadow-lg border border-gray-200 z-50",style:f,onClick:e=>e.stopPropagation(),children:[Ie.jsxs("button",{onClick:()=>{g?o(t):n(t)},className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-gray-50",children:[Ie.jsx(V,{className:"w-5 h-5"}),Ie.jsx("span",{className:"flex-1 text-left",children:"Watch Later"}),g&&Ie.jsx(B,{className:"w-5 h-5 text-green-500"})]}),Ie.jsxs("div",{className:"border-t border-gray-100",children:[Ie.jsx("div",{className:"max-h-60 overflow-y-auto",children:Object.values(i).map((e=>Ie.jsxs("button",{onClick:()=>{e.videos.includes(t)?c(e.id,t):l(e.id,t)},className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-gray-50",children:[Ie.jsx(z,{className:"w-5 h-5"}),Ie.jsx("span",{className:"flex-1 text-left truncate",children:e.name}),e.videos.includes(t)&&Ie.jsx(B,{className:"w-5 h-5 text-green-500"})]},e.id)))}),h?Ie.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),!m.trim())return;const s=d(m);l(s,t),u(!1),p("")},className:"p-4 border-t",children:[Ie.jsx("input",{type:"text",value:m,onChange:e=>p(e.target.value),placeholder:"Enter playlist name",className:"w-full px-3 py-2 border rounded-lg mb-2",autoFocus:!0}),Ie.jsxs("div",{className:"flex justify-end gap-2",children:[Ie.jsx("button",{type:"button",onClick:()=>u(!1),className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-900",children:"Cancel"}),Ie.jsx("button",{type:"submit",disabled:!m.trim(),className:"px-3 py-1 text-sm bg-gold-500 text-white rounded-lg hover:bg-gold-600 disabled:opacity-50",children:"Create"})]})]}):Ie.jsxs("button",{onClick:()=>u(!0),className:"w-full flex items-center gap-3 px-4 py-3 text-gold-600 hover:bg-gray-50 border-t",children:[Ie.jsx(J,{className:"w-5 h-5"}),Ie.jsx("span",{children:"Create new playlist"})]})]})]})}function ia({videoId:t,thumbnailUrl:s,videoUrl:r,previewUrl:i,title:a,duration:n}){const[l,c]=e.useState(!1),[d,h]=e.useState(!1),[u,m]=e.useState(!1),p=e.useRef(null),g=e.useRef(),f=e.useRef();return e.useEffect((()=>{if(i&&!f.current){const e=document.createElement("video");e.src=i,e.preload="metadata",e.muted=!0,e.playsInline=!0,e.loop=!0,f.current=e}}),[i]),e.useEffect((()=>(l&&p.current&&f.current&&(h(!0),g.current=setTimeout((()=>{p.current&&f.current&&(p.current.src=f.current.src,p.current.play().then((()=>{h(!1)})).catch((()=>{h(!1)})))}),300)),()=>{g.current&&clearTimeout(g.current),p.current&&(p.current.pause(),p.current.removeAttribute("src"))})),[l]),Ie.jsxs("div",{className:"relative group",onMouseEnter:()=>c(!0),onMouseLeave:()=>{c(!1),m(!1),h(!1),p.current&&(p.current.pause(),p.current.currentTime=0)},children:[Ie.jsx(o,{to:`/watch/${t}`,className:"block",children:Ie.jsxs("div",{className:"relative aspect-video rounded-xl overflow-hidden",children:[Ie.jsx("img",{src:s,alt:a,className:Ji("w-full h-full object-cover transition-opacity duration-300",l&&!d&&i?"opacity-0":"opacity-100")}),i&&Ie.jsx("video",{ref:p,className:Ji("absolute inset-0 w-full h-full object-cover transition-opacity duration-300",l&&!d?"opacity-100":"opacity-0"),muted:!0,playsInline:!0,loop:!0}),d&&Ie.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30",children:Ie.jsx(q,{className:"w-8 h-8 text-white animate-spin"})}),n&&Ie.jsx("div",{className:"absolute bottom-2 right-2 bg-black/80 text-white text-sm px-2 py-0.5 rounded",children:n}),l&&!d&&Ie.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30",children:Ie.jsx(H,{className:"w-12 h-12 text-white"})})]})}),Ie.jsx("button",{onClick:()=>m(!0),className:Ji("absolute top-2 right-2 p-2 rounded-full bg-black/80 text-white transition-opacity duration-300",l?"opacity-100":"opacity-0"),children:Ie.jsx(J,{className:"w-5 h-5"})}),u&&Ie.jsx(ra,{videoId:t,onClose:()=>m(!1)})]})}function aa({video:e,onView:t,size:r="small"}){return s.useEffect((()=>{const s=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&t()}))}),{threshold:.5}),r=document.getElementById(`video-${e.id}`);return r&&s.observe(r),()=>s.disconnect()}),[e.id,t]),Ie.jsxs("div",{className:"group",id:`video-${e.id}`,children:[Ie.jsx(ia,{videoId:e.id,thumbnailUrl:e.thumbnailUrl,videoUrl:e.videoUrl,title:e.title,duration:e.duration}),Ie.jsxs("div",{className:"mt-3",children:[Ie.jsx(o,{to:`/watch/${e.id}`,children:Ie.jsx("h3",{className:"font-medium text-gray-900 group-hover:text-gold-600 transition-colors line-clamp-2 "+("large"===r?"text-lg":"text-base"),children:e.title})}),Ie.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[Ie.jsx(o,{to:`/profile/${e.user.username}`,className:"rounded-full overflow-hidden flex-shrink-0 "+("large"===r?"w-8 h-8":"w-6 h-6"),children:Ie.jsx("img",{src:e.user.avatar||`https://ui-avatars.com/api/?name=${e.user.username}`,alt:e.user.username,className:"w-full h-full object-cover"})}),Ie.jsxs(o,{to:`/profile/${e.user.username}`,className:"text-gray-600 hover:text-gray-900 transition-colors flex items-center gap-1 "+("large"===r?"text-sm":"text-xs"),children:[e.user.username,e.user.isVerified&&Ie.jsx("span",{className:"inline-block w-3 h-3 bg-gold-500 text-white rounded-full text-[8px] flex items-center justify-center",children:""})]})]}),Ie.jsxs("div",{className:"text-gray-500 flex items-center gap-2 mt-1 "+("large"===r?"text-sm":"text-xs"),children:[Ie.jsxs("span",{children:[Hi(e.views)," views"]}),Ie.jsx("span",{children:""}),Ie.jsx("span",{children:qi(e.createdAt)})]})]})]})}function na({title:e,videos:t,viewMoreLink:s,onVideoView:r,featured:i}){var a;const n=t.slice(0,2),l=t.slice(2,10),c=s.startsWith("/featured/"),d=c&&!i?`#featured-${null==(a=s.split("/").pop())?void 0:a.toLowerCase()}`:s;return Ie.jsxs("section",{className:"mt-16 first:mt-12",children:[Ie.jsxs("div",{className:"flex justify-between items-center mb-8",children:[Ie.jsx("h2",{className:"text-2xl font-light tracking-wide text-gray-900",children:e}),c&&!i?Ie.jsx("a",{href:d,className:"text-gold-500 hover:text-gold-600 font-medium transition-colors",children:"View All"}):Ie.jsx(o,{to:d,className:"text-gold-500 hover:text-gold-600 font-medium transition-colors",children:"View All"})]}),Ie.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:n.map((e=>Ie.jsx(aa,{video:e,onView:()=>r(e.id),size:"large"},e.id)))}),Ie.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:l.map((e=>Ie.jsx(aa,{video:e,onView:()=>r(e.id),size:"small"},e.id)))})]})}function oa(){return Ie.jsx("div",{className:"bg-gradient-to-br from-gold-500 to-gold-600 text-white py-16 px-8",children:Ie.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[Ie.jsxs("div",{className:"flex items-center justify-center gap-2 mb-4",children:[Ie.jsx(C,{className:"h-8 w-8"}),Ie.jsx("h2",{className:"text-3xl font-medium",children:"Join VISION UNLIMITED"})]}),Ie.jsx("p",{className:"text-xl mb-8",children:"Get unlimited access to premium content for $14.99/month"}),Ie.jsx("div",{className:"grid grid-cols-3 gap-8 mb-10",children:["Ad-free viewing experience","Exclusive premium content","Early access to new releases","Download videos for offline viewing","4K Ultra HD streaming","Cancel anytime"].map((e=>Ie.jsxs("div",{className:"flex items-center gap-2",children:[Ie.jsx(B,{className:"h-5 w-5 flex-shrink-0"}),Ie.jsx("span",{className:"text-left",children:e})]},e)))}),Ie.jsxs(o,{to:"/unlimited",className:"inline-flex items-center gap-2 bg-white text-gold-600 px-8 py-3 rounded-full font-medium hover:bg-gold-50 transition-colors",children:[Ie.jsx(C,{className:"h-5 w-5"}),Ie.jsx("span",{children:"Start Your Free Trial"})]})]})})}const la=["Music","Movies","Sports","Comedy","News","Podcasts","Lifestyle","Inspiration","Arts","Kids"];function ca(){const{getFeaturedVideos:e,incrementViews:t}=Di(),s=e=>{t(e)};return Ie.jsxs("div",{className:"bg-white",children:[Ie.jsx(Zi,{}),Ie.jsxs("div",{className:"px-8 py-6",children:[Ie.jsx(na,{title:"Featured Videos",videos:e(),viewMoreLink:"/featured",onVideoView:s,featured:!0}),la.map((t=>Ie.jsx(na,{title:`Featured ${t}`,videos:e(t),viewMoreLink:`/category/${t.toLowerCase()}#featured-${t.toLowerCase()}`,onVideoView:s},t)))]}),Ie.jsx(oa,{})]})}const da={Music:{banners:[{id:"1",imageUrl:"https://images.unsplash.com/photo-1514525253161-7a46d19cd819?w=2000&h=700&fit=crop",link:"/category/music/featured",title:"Live Music Festival 2024",subtitle:"Experience the magic of live performances"},{id:"2",imageUrl:"https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?w=2000&h=700&fit=crop",link:"/category/music/top-artists",title:"Top Artists of the Month",subtitle:"Discover trending musicians and bands"},{id:"3",imageUrl:"https://images.unsplash.com/photo-1459749411175-04bf5292ceea?w=2000&h=700&fit=crop",link:"/category/music/indie",title:"Indie Music Spotlight",subtitle:"Fresh sounds from independent artists"}]},Movies:{banners:[{id:"1",imageUrl:"https://images.unsplash.com/photo-1489599849927-2ee91cede3ba?w=2000&h=700&fit=crop",link:"/category/movies/premieres",title:"New Movie Premieres",subtitle:"Watch the latest blockbusters"},{id:"2",imageUrl:"https://images.unsplash.com/photo-1536440136628-849c177e76a1?w=2000&h=700&fit=crop",link:"/category/movies/classics",title:"Classic Cinema Collection",subtitle:"Timeless films that shaped history"}]},Sports:{banners:[{id:"1",imageUrl:"https://images.unsplash.com/photo-1461896836934-ffe607ba8211?w=2000&h=700&fit=crop",link:"/category/sports/live",title:"Live Sports Coverage",subtitle:"Watch your favorite teams in action"}]},Comedy:{banners:[{id:"1",imageUrl:"https://images.unsplash.com/photo-1527224857830-43a7acc85260?w=2000&h=700&fit=crop",link:"/category/comedy/standup",title:"Comedy Night Special",subtitle:"The best stand-up performances"}]},News:{banners:[{id:"1",imageUrl:"https://images.unsplash.com/photo-1495020689067-958852a7765e?w=2000&h=700&fit=crop",link:"/category/news/live",title:"24/7 News Coverage",subtitle:"Stay informed with breaking news"}]},Podcasts:{banners:[{id:"1",imageUrl:"https://images.unsplash.com/photo-1478737270239-2f02b77fc618?w=2000&h=700&fit=crop",link:"/category/podcasts/trending",title:"Top Podcasts",subtitle:"Listen to trending shows"}]},Lifestyle:{banners:[{id:"1",imageUrl:"https://images.unsplash.com/photo-1511690656952-34342bb7c2f2?w=2000&h=700&fit=crop",link:"/category/lifestyle/featured",title:"Lifestyle & Wellness",subtitle:"Tips for a better life"}]},Inspiration:{banners:[{id:"1",imageUrl:"https://images.unsplash.com/photo-1488998427799-e3362cec87c3?w=2000&h=700&fit=crop",link:"/category/inspiration/motivational",title:"Daily Inspiration",subtitle:"Stories that motivate and inspire"}]},Arts:{banners:[{id:"1",imageUrl:"https://images.unsplash.com/photo-1460661419201-fd4cecdf8a8b?w=2000&h=700&fit=crop",link:"/category/arts/exhibitions",title:"Art & Culture",subtitle:"Explore creative expressions"}]},Kids:{banners:[{id:"1",imageUrl:"https://images.unsplash.com/photo-1485546246426-74dc88dec4d9?w=2000&h=700&fit=crop",link:"/category/kids/educational",title:"VISION Kids",subtitle:"Fun and educational content"}]}};function ha({category:t}){const[s,r]=e.useState(0),i=da[t].banners;return e.useEffect((()=>{const e=setInterval((()=>{r((e=>(e+1)%i.length))}),5e3);return()=>clearInterval(e)}),[i.length]),Ie.jsx("div",{className:"relative w-full h-[280px] bg-white px-8 pt-4",children:Ie.jsxs("div",{className:"relative w-full h-full flex items-center justify-center overflow-hidden",children:[Ie.jsx("div",{className:"w-full h-full rounded-[2rem] overflow-hidden shadow-xl relative z-20",children:i.map(((e,t)=>Ie.jsxs("a",{href:e.link,className:"absolute inset-0 transition-all duration-800",style:{opacity:t===s?1:0},children:[Ie.jsx("img",{src:e.imageUrl,alt:e.title,className:"w-full h-full object-cover"}),Ie.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent",children:Ie.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-8",children:[Ie.jsx("h2",{className:"text-4xl font-light tracking-wide text-white mb-2",children:e.title}),e.subtitle&&Ie.jsx("p",{className:"text-lg text-gray-200",children:e.subtitle})]})})]},e.id)))}),i.length>1&&Ie.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2 z-30",children:i.map(((e,t)=>Ie.jsx("button",{onClick:()=>r(t),className:"w-2 h-2 rounded-full transition-all duration-300 "+(t===s?"bg-white w-6":"bg-white/50"),"aria-label":`Go to banner ${t+1}`},t)))})]})})}function ua(){const{category:e}=c(),t=(null==e?void 0:e.charAt(0).toUpperCase())+(null==e?void 0:e.slice(1)),{getFeaturedVideos:s,getPersonalizedVideos:r,getTop100Videos:i}=Di(),a=e=>{},n=s(t),o=n.reduce(((e,t)=>e+t.views),0);return Ie.jsxs("div",{className:"bg-white",children:[Ie.jsx(ha,{category:t}),Ie.jsxs("div",{className:"px-8 py-6",children:[Ie.jsx(na,{title:`Featured ${t}`,videos:s(t),viewMoreLink:`/featured/${t}`,onVideoView:a}),Ie.jsx(na,{title:`${t} For You`,videos:r(t),viewMoreLink:`/category/${e}/recommended`,onVideoView:a}),Ie.jsx(na,{title:`Top 100 ${t}`,videos:i(t),viewMoreLink:`/category/${e}/top-100`,onVideoView:a})]}),Ie.jsx(oa,{}),Ie.jsxs("div",{id:`featured-${t.toLowerCase()}`,className:"px-8 py-12 bg-gray-50",children:[Ie.jsxs("div",{className:"mb-8",children:[Ie.jsxs("h2",{className:"text-3xl font-medium mb-2",children:["All Featured ",t]}),Ie.jsxs("p",{className:"text-gray-600",children:[Hi(o)," total views  ",n.length," videos"]})]}),Ie.jsx("div",{className:"grid grid-cols-4 gap-6",children:n.map((e=>Ie.jsx(aa,{video:e,onView:()=>{e.id},size:"small"},e.id)))})]})]})}function ma(){const[t,s]=e.useState(!1),r=[{icon:W,title:"Premium Content",description:"Access exclusive shows, movies, and documentaries"},{icon:S,title:"Early Access",description:"Watch new releases before anyone else"},{icon:G,title:"Offline Viewing",description:"Download and watch anywhere, anytime"},{icon:K,title:"4K Ultra HD",description:"Experience content in stunning 4K quality"},{icon:Y,title:"Ad-Free",description:"Enjoy uninterrupted viewing with no ads"},{icon:Z,title:"Exclusive Benefits",description:"Get special perks and member-only content"}];return Ie.jsxs("div",{className:"min-h-screen bg-white",children:[Ie.jsxs("div",{className:"relative h-[500px] overflow-hidden",children:[Ie.jsx("img",{src:"https://images.unsplash.com/photo-1578022761797-b8636ac1773c?w=2000&h=1000&fit=crop",alt:"Premium content",className:"w-full h-full object-cover"}),Ie.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/60 to-transparent",children:Ie.jsxs("div",{className:"max-w-4xl mx-auto h-full flex flex-col justify-center px-8",children:[Ie.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[Ie.jsx(C,{className:"h-12 w-12 text-gold-400"}),Ie.jsx("h1",{className:"text-5xl font-medium text-white",children:"VISION UNLIMITED"})]}),Ie.jsx("p",{className:"text-2xl text-gray-200 mb-8 max-w-2xl",children:"Unlock a world of premium entertainment with exclusive content, early access, and ad-free viewing."})]})})]}),Ie.jsx("div",{className:"max-w-4xl mx-auto px-8 -mt-20 mb-20",children:Ie.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl overflow-hidden",children:[Ie.jsxs("div",{className:"p-8 text-center border-b border-gray-100",children:[Ie.jsxs("div",{className:"inline-flex items-center gap-2 bg-gray-100 p-1 rounded-full mb-8",children:[Ie.jsx("button",{onClick:()=>s(!1),className:"px-6 py-2 rounded-full text-sm font-medium transition-colors "+(t?"text-gray-600":"bg-white text-gold-600 shadow"),children:"Monthly"}),Ie.jsx("button",{onClick:()=>s(!0),className:"px-6 py-2 rounded-full text-sm font-medium transition-colors "+(t?"bg-white text-gold-600 shadow":"text-gray-600"),children:"Yearly"})]}),Ie.jsxs("div",{className:"mb-6",children:[Ie.jsxs("div",{className:"text-4xl font-medium mb-2",children:[t?"$99.99":"$14.99",Ie.jsxs("span",{className:"text-lg text-gray-500 font-normal",children:["/",t?"year":"month"]})]}),t&&Ie.jsx("div",{className:"text-green-600 font-medium",children:"Save $79.89 per year"})]}),Ie.jsx("button",{className:"w-full bg-gold-500 hover:bg-gold-600 text-white px-8 py-4 rounded-full font-medium transition-colors mb-6",children:"Start Your Free Trial"}),Ie.jsx("p",{className:"text-gray-500 text-sm",children:"Cancel anytime. Free trial for 7 days."})]}),Ie.jsx("div",{className:"p-8",children:Ie.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:r.map((e=>Ie.jsxs("div",{className:"flex gap-4",children:[Ie.jsx(e.icon,{className:"h-6 w-6 text-gold-500 flex-shrink-0"}),Ie.jsxs("div",{children:[Ie.jsx("h3",{className:"font-medium mb-1",children:e.title}),Ie.jsx("p",{className:"text-gray-600 text-sm",children:e.description})]})]},e.title)))})})]})}),Ie.jsxs("div",{className:"max-w-6xl mx-auto px-8 mb-20",children:[Ie.jsx("h2",{className:"text-3xl font-medium text-center mb-12",children:"Premium Content Awaits"}),Ie.jsx("div",{className:"grid grid-cols-3 gap-8",children:["https://images.unsplash.com/photo-1514525253161-7a46d19cd819?w=600&h=400&fit=crop","https://images.unsplash.com/photo-1533174072545-7a4b6ad7a6c3?w=600&h=400&fit=crop","https://images.unsplash.com/photo-1516450360452-9312f5e86fc7?w=600&h=400&fit=crop"].map(((e,t)=>Ie.jsxs("div",{className:"aspect-video rounded-2xl overflow-hidden relative group cursor-pointer",children:[Ie.jsx("img",{src:e,alt:"Premium content preview",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),Ie.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:Ie.jsx(C,{className:"h-12 w-12 text-gold-400"})})]},t)))})]})]})}function pa({activeTab:e,onTabChange:t}){return Ie.jsx("div",{className:"border-b border-gray-200",children:Ie.jsxs("div",{className:"flex items-center justify-between px-8 py-4",children:[Ie.jsxs("div",{className:"flex gap-8",children:[Ie.jsxs("button",{onClick:()=>t("live"),className:Ji("flex items-center gap-2 px-4 py-2 text-lg font-medium border-b-2 transition-colors","live"===e?"border-gold-500 text-gold-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[Ie.jsx(E,{className:"h-5 w-5"}),Ie.jsx("span",{children:"LIVE"})]}),Ie.jsxs("button",{onClick:()=>t("events"),className:Ji("flex items-center gap-2 px-4 py-2 text-lg font-medium border-b-2 transition-colors","events"===e?"border-gold-500 text-gold-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[Ie.jsx(X,{className:"h-5 w-5"}),Ie.jsx("span",{children:"Events"})]})]}),Ie.jsxs(o,{to:"/live/create",className:"flex items-center gap-2 bg-gold-500 text-white px-6 py-2.5 rounded-full font-medium hover:bg-gold-600 transition-colors",children:[Ie.jsx(J,{className:"h-5 w-5"}),Ie.jsx("span",{children:"Go Live"})]})]})})}const ga=[{id:"1",imageUrl:"https://images.unsplash.com/photo-1514525253161-7a46d19cd819?w=2000&h=700&fit=crop",link:"/live/concert-2024",title:"Live Music Festival 2024",subtitle:"Join us for an incredible night of live performances"},{id:"2",imageUrl:"https://images.unsplash.com/photo-1578022761797-b8636ac1773c?w=2000&h=700&fit=crop",link:"/live/championship-boxing",title:"Championship Boxing Night",subtitle:"Watch the heavyweight championship live from Las Vegas"},{id:"3",imageUrl:"https://images.unsplash.com/photo-1492684223066-81342ee5ff30?w=2000&h=700&fit=crop",link:"/live/comedy-special",title:"Comedy Night Special",subtitle:"An evening of non-stop laughter with top comedians"}];function fa(){const[t,s]=e.useState(0);return e.useEffect((()=>{const e=setInterval((()=>{s((e=>(e+1)%ga.length))}),5e3);return()=>clearInterval(e)}),[]),Ie.jsx("div",{className:"relative w-full h-[280px] mt-8 bg-white",children:Ie.jsxs("div",{className:"relative w-full h-full flex items-center justify-center overflow-hidden",children:[Ie.jsx("div",{className:"w-full h-full rounded-[2rem] overflow-hidden shadow-xl relative z-20",children:ga.map(((e,s)=>Ie.jsxs(o,{to:e.link,className:"absolute inset-0 transition-all duration-800",style:{opacity:s===t?1:0},children:[Ie.jsx("img",{src:e.imageUrl,alt:e.title,className:"w-full h-full object-cover"}),Ie.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent",children:Ie.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-8",children:[Ie.jsx("h2",{className:"text-4xl font-light tracking-wide text-white mb-2",children:e.title}),e.subtitle&&Ie.jsx("p",{className:"text-lg text-gray-200",children:e.subtitle})]})})]},e.id)))}),Ie.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2 z-30",children:ga.map(((e,r)=>Ie.jsx("button",{onClick:()=>s(r),className:"w-2 h-2 rounded-full transition-all duration-300 "+(r===t?"bg-white w-6":"bg-white/50"),"aria-label":`Go to banner ${r+1}`},r)))})]})})}const xa=[{id:"1",title:"Live from Orlando: Music Festival",description:"Join us for an incredible night of live music featuring top artists",thumbnailUrl:"https://images.unsplash.com/photo-1514525253161-7a46d19cd819?w=1280&h=720&fit=crop",category:"Music",userId:"user1",user:{id:"user1",username:"Orlando Events",email:"events@example.com",isVerified:!0,isPremium:!0,createdAt:"2024-01-01T00:00:00Z"},scheduledFor:"2024-03-15T20:00:00Z",status:"live",isPPV:!0,price:29.99,chatEnabled:!0,chatPermissions:"everyone",chatDelay:30,chatReactionsEnabled:!0,visibility:"public",streamType:"software",viewerCount:15420,purchased:!1},{id:"2",title:"Championship Boxing: Las Vegas",description:"Watch the heavyweight championship fight live from Las Vegas",thumbnailUrl:"https://images.unsplash.com/photo-1578022761797-b8636ac1773c?w=1280&h=720&fit=crop",category:"Sports",userId:"user2",user:{id:"user2",username:"Vegas Sports",email:"sports@example.com",isVerified:!0,isPremium:!0,createdAt:"2024-01-01T00:00:00Z"},scheduledFor:"2024-03-15T21:00:00Z",status:"live",isPPV:!0,price:49.99,chatEnabled:!0,chatPermissions:"everyone",chatDelay:30,chatReactionsEnabled:!0,visibility:"public",streamType:"software",viewerCount:8750,purchased:!1},{id:"3",title:"Late Night Comedy Show",description:"Live stand-up comedy from the best comedians",thumbnailUrl:"https://images.unsplash.com/photo-1527224857830-43a7acc85260?w=1280&h=720&fit=crop",category:"Comedy",userId:"user3",user:{id:"user3",username:"Comedy Central",email:"comedy@example.com",isVerified:!0,isPremium:!0,createdAt:"2024-01-01T00:00:00Z"},scheduledFor:"2024-03-15T22:00:00Z",status:"live",isPPV:!1,chatEnabled:!0,chatPermissions:"everyone",chatDelay:30,chatReactionsEnabled:!0,visibility:"public",streamType:"software",viewerCount:5230,purchased:!1},{id:"4",title:"24/7 News Coverage",description:"Breaking news and live updates",thumbnailUrl:"https://images.unsplash.com/photo-1495020689067-958852a7765e?w=1280&h=720&fit=crop",category:"News",userId:"user4",user:{id:"user4",username:"News Network",email:"news@example.com",isVerified:!0,isPremium:!0,createdAt:"2024-01-01T00:00:00Z"},scheduledFor:"2024-03-15T00:00:00Z",status:"live",isPPV:!1,chatEnabled:!0,chatPermissions:"everyone",chatDelay:30,chatReactionsEnabled:!0,visibility:"public",streamType:"software",viewerCount:12840,purchased:!1}],va=dt(((e,t)=>({events:xa,getLiveEvents:()=>t().events,createLiveEvent:t=>e((e=>({events:[...e.events,{...t,id:Math.random().toString(36).substr(2,9),viewerCount:0,purchased:!1}]}))),updateLiveEvent:(t,s)=>e((e=>({events:e.events.map((e=>e.id===t?{...e,...s}:e))}))),deleteLiveEvent:t=>e((e=>({events:e.events.filter((e=>e.id!==t))}))),purchaseEvent:t=>e((e=>({events:e.events.map((e=>e.id===t?{...e,purchased:!0}:e))}))),hasAccessToEvent:e=>{const s=t().events.find((t=>t.id===e));return!!s&&(!s.isPPV||s.purchased)}})));function ba({stream:e,isReplay:t}){return Ie.jsxs(o,{to:`/live/${e.id}`,className:"group",children:[Ie.jsxs("div",{className:"relative aspect-video rounded-xl overflow-hidden",children:[Ie.jsx("img",{src:e.thumbnailUrl,alt:e.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),Ie.jsxs("div",{className:"absolute top-2 left-2 flex items-center gap-2",children:["live"===e.status&&Ie.jsxs(Ie.Fragment,{children:[Ie.jsx("span",{className:"bg-red-500 text-white text-sm px-3 py-1 rounded-full",children:"LIVE"}),Ie.jsxs("span",{className:"bg-black/50 text-white text-sm px-3 py-1 rounded-full flex items-center gap-1",children:[Ie.jsx(Q,{className:"h-4 w-4"}),e.viewerCount.toLocaleString()]})]}),t&&Ie.jsxs("span",{className:"bg-purple-500 text-white text-sm px-3 py-1 rounded-full flex items-center gap-1",children:[Ie.jsx(H,{className:"h-4 w-4"}),"Replay"]}),"scheduled"===e.status&&Ie.jsx("span",{className:"bg-gold-500 text-white text-sm px-3 py-1 rounded-full",children:qi(e.scheduledFor)})]}),"scheduled"===e.status&&Ie.jsx("button",{onClick:t=>{t.preventDefault(),console.log("Set reminder for:",e.id)},className:"absolute top-2 right-2 bg-white/90 hover:bg-white text-gold-600 p-2 rounded-full transition-colors",children:Ie.jsx(b,{className:"h-4 w-4"})})]}),Ie.jsxs("div",{className:"mt-3",children:[Ie.jsx("h3",{className:"font-medium text-lg group-hover:text-gold-600 transition-colors",children:e.title}),Ie.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[Ie.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden",children:Ie.jsx("img",{src:`https://ui-avatars.com/api/?name=${e.user.username}`,alt:e.user.username,className:"w-full h-full object-cover"})}),Ie.jsx("span",{className:"text-gray-600",children:e.user.username})]}),t&&Ie.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:["Streamed ",qi(e.scheduledFor)]})]})]})}function wa(){const{getLiveEvents:e}=va(),t=e(),s=t.filter((e=>"live"===e.status&&!e.isPPV)).sort(((e,t)=>t.viewerCount-e.viewerCount)),r=t.filter((e=>"ended"===e.status&&!e.isPPV)).sort(((e,t)=>new Date(t.scheduledFor).getTime()-new Date(e.scheduledFor).getTime())).slice(0,4);return Ie.jsx("div",{className:"mt-8",children:Ie.jsxs("div",{className:"space-y-12",children:[Ie.jsxs("section",{children:[Ie.jsx("h2",{className:"text-2xl font-medium mb-6",children:"Live Now"}),Ie.jsx("div",{className:"grid grid-cols-3 gap-6",children:s.map((e=>Ie.jsx(ba,{stream:e},e.id)))})]}),r.length>0&&Ie.jsxs("section",{children:[Ie.jsx("h2",{className:"text-2xl font-medium mb-6",children:"Recently LIVE"}),Ie.jsx("div",{className:"grid grid-cols-4 gap-6",children:r.map((e=>Ie.jsx(ba,{stream:e,isReplay:!0},e.id)))})]})]})})}function ya({event:e,isReplay:t}){const{hasAccessToEvent:s}=va(),r=!s(e.id)&&e.isPPV?`/live/${e.id}/purchase`:`/live/${e.id}`;return Ie.jsxs(o,{to:r,className:"group",children:[Ie.jsxs("div",{className:"relative aspect-video rounded-xl overflow-hidden",children:[Ie.jsx("img",{src:e.thumbnailUrl,alt:e.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),Ie.jsxs("div",{className:"absolute top-2 left-2 flex items-center gap-2",children:["live"===e.status&&Ie.jsxs(Ie.Fragment,{children:[Ie.jsx("span",{className:"bg-red-500 text-white text-sm px-3 py-1 rounded-full",children:"LIVE"}),Ie.jsxs("span",{className:"bg-black/50 text-white text-sm px-3 py-1 rounded-full flex items-center gap-1",children:[Ie.jsx(Q,{className:"h-4 w-4"}),e.viewerCount.toLocaleString()]})]}),"scheduled"===e.status&&Ie.jsx("span",{className:"bg-gold-500 text-white text-sm px-3 py-1 rounded-full",children:qi(e.scheduledFor)}),t&&Ie.jsxs("span",{className:"bg-purple-500 text-white text-sm px-3 py-1 rounded-full flex items-center gap-1",children:[Ie.jsx(H,{className:"h-4 w-4"}),"Replay"]}),e.isPPV&&!s(e.id)&&Ie.jsxs("span",{className:"bg-gold-500 text-white text-sm px-3 py-1 rounded-full flex items-center gap-1",children:[Ie.jsx(C,{className:"h-4 w-4"}),"$",e.price]})]}),"scheduled"===e.status&&Ie.jsx("button",{onClick:t=>{t.preventDefault(),console.log("Set reminder for:",e.id)},className:"absolute top-2 right-2 bg-white/90 hover:bg-white text-gold-600 p-2 rounded-full transition-colors",children:Ie.jsx(b,{className:"h-4 w-4"})})]}),Ie.jsxs("div",{className:"mt-3",children:[Ie.jsx("h3",{className:"font-medium text-lg group-hover:text-gold-600 transition-colors",children:e.title}),Ie.jsx("p",{className:"text-gray-600 text-sm mt-1 line-clamp-2",children:e.description}),Ie.jsxs("div",{className:"mt-2 flex items-center gap-4",children:[Ie.jsxs("div",{className:"flex items-center gap-2",children:[Ie.jsx("div",{className:"w-6 h-6 rounded-full overflow-hidden",children:Ie.jsx("img",{src:`https://ui-avatars.com/api/?name=${e.user.username}`,alt:e.user.username,className:"w-full h-full object-cover"})}),Ie.jsx("span",{className:"text-gray-600 text-sm",children:e.user.username})]}),"scheduled"===e.status&&Ie.jsxs("span",{className:"text-gray-600 text-sm",children:["Starts ",qi(e.scheduledFor)]}),s(e.id)&&Ie.jsx("span",{className:"text-green-600 text-sm font-medium",children:"Purchased"})]})]})]})}function ja(){const[t,s]=e.useState("live"),{getLiveEvents:r}=va(),i=r().filter((e=>e.isPPV)),a=i.filter((e=>"live"===e.status)).sort(((e,t)=>t.viewerCount-e.viewerCount)),n=i.filter((e=>"scheduled"===e.status)).sort(((e,t)=>new Date(e.scheduledFor).getTime()-new Date(t.scheduledFor).getTime())),o=i.filter((e=>"ended"===e.status)).sort(((e,t)=>new Date(t.scheduledFor).getTime()-new Date(e.scheduledFor).getTime()));return Ie.jsxs("div",{className:"mt-8",children:[Ie.jsx("div",{className:"flex gap-4 mb-8",children:[{id:"live",label:"Live Now"},{id:"upcoming",label:"Upcoming"},{id:"replays",label:"Replays"}].map((e=>Ie.jsx("button",{onClick:()=>s(e.id),className:Ji("px-6 py-2 rounded-full text-sm font-medium transition-colors",t===e.id?"bg-gold-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:e.label},e.id)))}),Ie.jsxs("div",{className:"space-y-12",children:["live"===t&&Ie.jsxs("section",{children:[Ie.jsx("h2",{className:"text-2xl font-medium mb-6",children:"Live Events"}),Ie.jsx("div",{className:"grid grid-cols-3 gap-6",children:a.map((e=>Ie.jsx(ya,{event:e},e.id)))})]}),"upcoming"===t&&Ie.jsxs("section",{children:[Ie.jsx("h2",{className:"text-2xl font-medium mb-6",children:"Upcoming Events"}),Ie.jsx("div",{className:"grid grid-cols-3 gap-6",children:n.map((e=>Ie.jsx(ya,{event:e},e.id)))})]}),"replays"===t&&Ie.jsxs("section",{children:[Ie.jsx("h2",{className:"text-2xl font-medium mb-6",children:"Event Replays"}),Ie.jsx("div",{className:"grid grid-cols-3 gap-6",children:o.map((e=>Ie.jsx(ya,{event:e,isReplay:!0},e.id)))})]})]})]})}function Na(){const[t,s]=e.useState("live");return Ie.jsx("div",{className:"bg-white min-h-screen",children:Ie.jsxs("div",{className:"max-w-7xl mx-auto",children:[Ie.jsx(pa,{activeTab:t,onTabChange:s}),Ie.jsxs("div",{className:"px-8",children:[Ie.jsx(fa,{}),"live"===t?Ie.jsx(wa,{}):Ie.jsx(ja,{})]})]})})}function ka(){const{eventId:t}=c(),s=n(),{getLiveEvents:r,hasAccessToEvent:i}=va(),{user:a}=Oi(),[l,d]=e.useState(!0),[h,u]=e.useState(""),m=r().find((e=>e.id===t));if(!m)return s("/live"),null;const p=r().filter((e=>e.id!==t)).slice(0,5),g=i(t)||(null==a?void 0:a.isPremium)&&m.user.isPremium;return Ie.jsxs("div",{className:"min-h-screen bg-white",children:[Ie.jsxs("div",{className:"aspect-video bg-black relative",children:[g?Ie.jsx("video",{src:"https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4",className:"w-full h-full object-contain",controls:!0,autoPlay:!0}):Ie.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-white",children:[Ie.jsx(ee,{className:"h-16 w-16 mb-4"}),m.isPPV?Ie.jsxs(Ie.Fragment,{children:[Ie.jsx("h2",{className:"text-2xl font-medium mb-2",children:"Premium Event"}),Ie.jsx("p",{className:"text-gray-400 mb-4",children:"Purchase this event to watch live"}),Ie.jsxs(o,{to:`/live/${t}/purchase`,className:"flex items-center gap-2 px-6 py-3 bg-gold-500 text-white rounded-full font-medium hover:bg-gold-600",children:[Ie.jsx(C,{className:"h-5 w-5"}),Ie.jsxs("span",{children:["Buy Now for $",m.price]})]})]}):Ie.jsxs(Ie.Fragment,{children:[Ie.jsx("h2",{className:"text-2xl font-medium mb-2",children:"Members Only Stream"}),Ie.jsxs("p",{className:"text-gray-400 mb-4",children:["Subscribe to ",m.user.username," to watch"]}),Ie.jsx("button",{className:"px-6 py-3 bg-gold-500 text-white rounded-full font-medium hover:bg-gold-600",children:"Become a Member"})]})]}),Ie.jsxs("div",{className:"absolute top-4 left-4 flex items-center gap-2",children:[Ie.jsx("span",{className:"bg-red-500 text-white px-3 py-1 rounded-full text-sm font-medium",children:"LIVE"}),Ie.jsxs("span",{className:"bg-black/50 text-white px-3 py-1 rounded-full text-sm font-medium flex items-center gap-1",children:[Ie.jsx(Q,{className:"h-4 w-4"}),Hi(m.viewerCount)]})]})]}),Ie.jsx("div",{className:"max-w-7xl mx-auto px-8 py-6",children:Ie.jsxs("div",{className:"flex gap-8",children:[Ie.jsxs("div",{className:"flex-1",children:[Ie.jsxs("div",{className:"mb-4",children:[Ie.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:[Ie.jsx("span",{children:qi(m.scheduledFor)}),Ie.jsx("span",{children:""}),Ie.jsxs("span",{children:[Hi(m.viewerCount)," watching"]})]}),Ie.jsx("h1",{className:"text-2xl font-medium",children:m.title})]}),Ie.jsxs("div",{className:"flex items-center justify-between py-4",children:[Ie.jsxs("div",{className:"flex items-center gap-4",children:[Ie.jsx(o,{to:`/creator/${m.user.id}`,className:"block",children:Ie.jsx("img",{src:`https://ui-avatars.com/api/?name=${m.user.username}`,alt:m.user.username,className:"w-12 h-12 rounded-full"})}),Ie.jsxs("div",{children:[Ie.jsxs(o,{to:`/creator/${m.user.id}`,className:"font-medium hover:text-gold-600",children:[m.user.username,m.user.isVerified&&Ie.jsx("span",{className:"ml-1 inline-block w-4 h-4 bg-gold-500 text-white rounded-full text-xs flex items-center justify-center",children:""})]}),Ie.jsx("div",{className:"text-sm text-gray-600",children:"Event Host"})]})]}),Ie.jsxs("div",{className:"flex items-center gap-4",children:[!g&&m.isPPV&&Ie.jsxs(o,{to:`/live/${t}/purchase`,className:"flex items-center gap-2 px-6 py-2 bg-gold-500 text-white rounded-full font-medium hover:bg-gold-600",children:[Ie.jsx(C,{className:"h-5 w-5"}),Ie.jsxs("span",{children:["$",m.price]})]}),!g&&!m.isPPV&&m.user.isPremium&&Ie.jsx("button",{className:"px-6 py-2 bg-gold-500 text-white rounded-full font-medium hover:bg-gold-600",children:"Become a Member"}),Ie.jsx("button",{className:"px-6 py-2 bg-gold-500 text-white rounded-full font-medium hover:bg-gold-600",children:"Follow"})]})]}),Ie.jsx("div",{className:"mt-4 text-gray-600",children:Ie.jsx("p",{children:m.description})})]}),l&&m.chatEnabled&&Ie.jsxs("div",{className:"w-96 bg-white border border-gray-200 rounded-lg flex flex-col",children:[Ie.jsx("div",{className:"p-4 border-b border-gray-200",children:Ie.jsxs("div",{className:"flex items-center justify-between",children:[Ie.jsx("h3",{className:"font-medium",children:"Live Chat"}),Ie.jsx("button",{onClick:()=>d(!1),className:"text-gray-500 hover:text-gray-700",children:"Hide"})]})}),g?Ie.jsxs(Ie.Fragment,{children:[Ie.jsx("div",{className:"flex-1 p-4 space-y-4 overflow-y-auto max-h-[600px]",children:Ie.jsxs("div",{className:"flex items-start gap-2",children:[Ie.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex-shrink-0",children:Ie.jsx("img",{src:"https://ui-avatars.com/api/?name=John",alt:"John",className:"w-full h-full rounded-full"})}),Ie.jsxs("div",{children:[Ie.jsx("span",{className:"font-medium",children:"John"}),Ie.jsx("p",{className:"text-sm text-gray-600",children:"This is amazing! "})]})]})}),Ie.jsx("div",{className:"p-4 border-t border-gray-200",children:Ie.jsxs("div",{className:"flex gap-2",children:[Ie.jsx("input",{type:"text",value:h,onChange:e=>u(e.target.value),placeholder:"Send a message...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-gold-500/20 focus:border-gold-500"}),Ie.jsx("button",{className:"px-4 py-2 bg-gold-500 text-white rounded-full font-medium hover:bg-gold-600",children:"Send"})]})})]}):Ie.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 text-center",children:[Ie.jsx(ee,{className:"h-8 w-8 text-gray-400 mb-2"}),Ie.jsx("p",{className:"text-gray-600 mb-4",children:m.isPPV?"Purchase this event to join the chat":"Subscribe to join the chat"}),Ie.jsx(o,{to:m.isPPV?`/live/${t}/purchase`:"#",className:"px-4 py-2 bg-gold-500 text-white rounded-full font-medium hover:bg-gold-600",children:m.isPPV?`Buy Now $${m.price}`:"Become a Member"})]})]}),!l&&Ie.jsxs("div",{className:"w-96",children:[Ie.jsx("h3",{className:"font-medium mb-4",children:"Recommended Events"}),Ie.jsx("div",{className:"space-y-4",children:p.map((e=>Ie.jsxs(o,{to:`/live/${e.id}`,className:"flex gap-4 group",children:[Ie.jsxs("div",{className:"w-40 aspect-video rounded-lg overflow-hidden flex-shrink-0 relative",children:[Ie.jsx("img",{src:e.thumbnailUrl,alt:e.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform"}),"live"===e.status?Ie.jsx("div",{className:"absolute top-2 left-2 bg-red-500 text-white text-xs px-2 py-0.5 rounded-full",children:"LIVE"}):Ie.jsx("div",{className:"absolute top-2 left-2 bg-gold-500 text-white text-xs px-2 py-0.5 rounded-full",children:qi(e.scheduledFor)}),e.isPPV&&Ie.jsxs("div",{className:"absolute top-2 right-2 bg-gold-500 text-white text-xs px-2 py-0.5 rounded-full flex items-center gap-1",children:[Ie.jsx(C,{className:"h-3 w-3"}),"$",e.price]})]}),Ie.jsxs("div",{children:[Ie.jsx("h3",{className:"font-medium line-clamp-2 group-hover:text-gold-600",children:e.title}),Ie.jsxs("div",{className:"mt-1 text-sm text-gray-600",children:[Ie.jsxs("div",{className:"flex items-center gap-1",children:[e.user.username,e.user.isVerified&&Ie.jsx("span",{className:"w-3 h-3 bg-gold-500 text-white rounded-full text-[10px] flex items-center justify-center",children:""})]}),Ie.jsxs("div",{children:[Hi(e.viewerCount)," watching"]})]})]})]},e.id)))})]})]})})]})}function _a(){const{eventId:t}=c(),s=n(),{getLiveEvents:r,purchaseEvent:i}=va(),[a,o]=e.useState(!1),l=r().find((e=>e.id===t));if(!l)return s("/live"),null;return Ie.jsx("div",{className:"min-h-screen bg-gray-50",children:Ie.jsx("div",{className:"max-w-4xl mx-auto px-8 py-12",children:Ie.jsxs("div",{className:"flex gap-8",children:[Ie.jsx("div",{className:"flex-1",children:Ie.jsxs("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:[Ie.jsxs("div",{className:"relative aspect-video",children:[Ie.jsx("img",{src:l.thumbnailUrl,alt:l.title,className:"w-full h-full object-cover"}),Ie.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"}),Ie.jsxs("div",{className:"absolute bottom-4 left-4 right-4",children:[Ie.jsx("h1",{className:"text-2xl font-medium text-white mb-2",children:l.title}),Ie.jsxs("div",{className:"flex items-center gap-4 text-white/90",children:[Ie.jsxs("div",{className:"flex items-center gap-1",children:[Ie.jsx(V,{className:"h-4 w-4"}),Ie.jsx("span",{children:qi(l.scheduledFor)})]}),Ie.jsxs("div",{className:"flex items-center gap-1",children:[Ie.jsx(Q,{className:"h-4 w-4"}),Ie.jsxs("span",{children:[Hi(l.viewerCount)," watching"]})]})]})]})]}),Ie.jsxs("div",{className:"p-6",children:[Ie.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[Ie.jsx("img",{src:`https://ui-avatars.com/api/?name=${l.user.username}`,alt:l.user.username,className:"w-12 h-12 rounded-full"}),Ie.jsxs("div",{children:[Ie.jsxs("div",{className:"font-medium flex items-center gap-1",children:[l.user.username,l.user.isVerified&&Ie.jsx("span",{className:"inline-block w-4 h-4 bg-gold-500 text-white rounded-full text-xs flex items-center justify-center",children:""})]}),Ie.jsx("div",{className:"text-sm text-gray-600",children:"Event Host"})]})]}),Ie.jsx("p",{className:"text-gray-600 mb-6",children:l.description}),Ie.jsxs("div",{className:"space-y-4",children:[Ie.jsx("h3",{className:"font-medium",children:"What's Included:"}),Ie.jsxs("ul",{className:"space-y-3",children:[Ie.jsxs("li",{className:"flex items-center gap-3 text-gray-600",children:[Ie.jsx(C,{className:"h-5 w-5 text-gold-500"}),Ie.jsx("span",{children:"Full HD live stream access"})]}),Ie.jsxs("li",{className:"flex items-center gap-3 text-gray-600",children:[Ie.jsx(te,{className:"h-5 w-5 text-gold-500"}),Ie.jsx("span",{children:"Live chat participation"})]}),Ie.jsxs("li",{className:"flex items-center gap-3 text-gray-600",children:[Ie.jsx(V,{className:"h-5 w-5 text-gold-500"}),Ie.jsx("span",{children:"Lifetime replay access"})]})]})]})]})]})}),Ie.jsx("div",{className:"w-96",children:Ie.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6 sticky top-24",children:[Ie.jsxs("div",{className:"text-center mb-6",children:[Ie.jsxs("div",{className:"text-3xl font-medium mb-2",children:["$",l.price]}),Ie.jsx("p",{className:"text-gray-600",children:"One-time purchase"})]}),Ie.jsx("button",{onClick:async()=>{o(!0),setTimeout((()=>{i(t),o(!1),s(`/live/${t}`)}),1500)},disabled:a,className:"w-full flex items-center justify-center gap-2 bg-gold-500 text-white px-6 py-3 rounded-full font-medium hover:bg-gold-600 disabled:opacity-50 disabled:cursor-not-allowed mb-6",children:a?Ie.jsxs(Ie.Fragment,{children:[Ie.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),Ie.jsx("span",{children:"Processing..."})]}):Ie.jsxs(Ie.Fragment,{children:[Ie.jsx(se,{className:"h-5 w-5"}),Ie.jsx("span",{children:"Purchase Now"})]})}),Ie.jsxs("div",{className:"space-y-4 text-sm text-gray-600",children:[Ie.jsxs("div",{className:"flex items-center gap-2",children:[Ie.jsx(Y,{className:"h-4 w-4 text-green-500"}),Ie.jsx("span",{children:"Secure payment"})]}),Ie.jsxs("div",{className:"flex items-center gap-2",children:[Ie.jsx(V,{className:"h-4 w-4 text-green-500"}),Ie.jsx("span",{children:"Instant access after purchase"})]})]})]})})]})})})}const Sa=[{id:"all",label:"All",icon:T},{id:"music",label:"Music",icon:I},{id:"movies",label:"Movies",icon:$},{id:"sports",label:"Sports",icon:O},{id:"comedy",label:"Comedy",icon:A},{id:"news",label:"News",icon:R},{id:"podcasts",label:"Podcasts",icon:L},{id:"lifestyle",label:"Lifestyle",icon:U},{id:"inspiration",label:"Inspiration",icon:D},{id:"arts",label:"Arts",icon:F},{id:"kids",label:"Kids",icon:M}];function Ta(){const[t,s]=e.useState("all"),{videos:r}=Di(),i=e=>{const t=new Date,s=new Date(e.metrics.lastUpdated);return(t.getTime()-s.getTime())/864e5>28?0:1*e.metrics.impressions+2*e.metrics.views+3*e.metrics.likes+4*e.metrics.comments+5*e.metrics.shares},a=e.useMemo((()=>("all"===t?r:r.filter((e=>e.category.toLowerCase()===t))).map((e=>({...e,score:i(e)}))).sort(((e,t)=>t.score-e.score)).slice(0,100)),[r,t]);return Ie.jsxs("div",{className:"bg-white min-h-screen",children:[Ie.jsx("div",{className:"bg-gradient-to-r from-gold-500 to-gold-600 text-white",children:Ie.jsxs("div",{className:"max-w-7xl mx-auto px-8 py-12",children:[Ie.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[Ie.jsx(T,{className:"h-8 w-8"}),Ie.jsx("h1",{className:"text-4xl font-medium",children:"Top 100"})]}),Ie.jsx("p",{className:"text-xl text-gold-100",children:"Trending videos ranked by engagement over the past 28 days"})]})}),Ie.jsx("div",{className:"sticky top-16 bg-white border-b border-gold-100 z-40",children:Ie.jsx("div",{className:"max-w-7xl mx-auto px-8",children:Ie.jsx("div",{className:"flex gap-2 overflow-x-auto py-4 scrollbar-hide",children:Sa.map((e=>{const r=e.id===t;return Ie.jsxs("button",{onClick:()=>s(e.id),className:Ji("flex items-center gap-2 px-4 py-2 rounded-full whitespace-nowrap transition-all",r?"bg-gold-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:[Ie.jsx(e.icon,{className:"h-4 w-4"}),Ie.jsx("span",{className:"font-medium",children:e.label})]},e.id)}))})})}),Ie.jsx("div",{className:"max-w-7xl mx-auto px-8 py-8",children:Ie.jsx("div",{className:"grid grid-cols-4 gap-6",children:a.map(((e,t)=>Ie.jsxs("div",{className:"relative",children:[Ie.jsx("div",{className:"absolute -left-4 top-0 w-8 h-8 bg-gold-500 text-white rounded-full flex items-center justify-center font-medium z-10",children:t+1}),Ie.jsx(aa,{video:e,onView:()=>{},size:"small"})]},e.id)))})})]})}const Ea=[{id:"1",title:"Amazing Dance Performance",description:"Check out these incredible moves! ",videoUrl:"https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4",thumbnailUrl:"https://images.unsplash.com/photo-1516450360452-9312f5e86fc7",user:{id:"user1",username:"dancepro",avatar:"https://ui-avatars.com/api/?name=dancepro",followers:15e4,isVerified:!0},likes:25e3,comments:1200,shares:3500,gifts:150,hasLiked:!1,isFollowing:!1,createdAt:(new Date).toISOString()},{id:"2",title:"Street Performance",description:"Urban dance vibes in the city ",videoUrl:"https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerEscapes.mp4",thumbnailUrl:"https://images.unsplash.com/photo-1547153760-18fc86324498",user:{id:"user2",username:"urbanflow",avatar:"https://ui-avatars.com/api/?name=urbanflow",followers:89e3,isVerified:!0},likes:15e3,comments:800,shares:2100,gifts:90,hasLiked:!1,isFollowing:!1,createdAt:(new Date).toISOString()}],Ca=dt(((e,t)=>({sparks:Ea,getTopCreators:()=>Array.from(new Set(Ea.map((e=>e.user)))).sort(((e,t)=>t.followers-e.followers)).slice(0,40),addSpark:t=>e((e=>({sparks:[{...t,id:Math.random().toString(36).substr(2,9),createdAt:(new Date).toISOString()},...e.sparks]}))),toggleLike:t=>e((e=>({sparks:e.sparks.map((e=>e.id===t?{...e,hasLiked:!e.hasLiked,likes:e.hasLiked?e.likes-1:e.likes+1}:e))}))),toggleFollow:t=>e((e=>({sparks:e.sparks.map((e=>e.user.id===t?{...e,isFollowing:!e.isFollowing}:e))}))),addComment:(t,s)=>e((e=>({sparks:e.sparks.map((e=>e.id===t?{...e,comments:e.comments+1}:e))}))),addShare:t=>e((e=>({sparks:e.sparks.map((e=>e.id===t?{...e,shares:e.shares+1}:e))}))),addGift:(t,s)=>e((e=>({sparks:e.sparks.map((e=>e.id===t?{...e,gifts:e.gifts+1}:e))})))}))),Pa=dt()(ta(((e,t)=>({likes:new Set,follows:new Set,comments:{},shares:new Set,addLike:t=>e((e=>({likes:new Set([...e.likes,t])}))),removeLike:t=>e((e=>{const s=new Set(e.likes);return s.delete(t),{likes:s}})),toggleLike:e=>{t().hasLiked(e)?t().removeLike(e):t().addLike(e)},hasLiked:e=>t().likes.has(e),addFollow:t=>e((e=>({follows:new Set([...e.follows,t])}))),removeFollow:t=>e((e=>{const s=new Set(e.follows);return s.delete(t),{follows:s}})),toggleFollow:e=>{t().isFollowing(e)?t().removeFollow(e):t().addFollow(e)},isFollowing:e=>t().follows.has(e),addComment:(t,s)=>e((e=>{const r={id:Math.random().toString(36).substr(2,9),text:s,timestamp:(new Date).toISOString()};return{comments:{...e.comments,[t]:[...e.comments[t]||[],r]}}})),getComments:e=>t().comments[e]||[],addShare:t=>e((e=>({shares:new Set([...e.shares,t])}))),hasShared:e=>t().shares.has(e)})),{name:"vision-engagement",partialize:e=>({likes:Array.from(e.likes),follows:Array.from(e.follows),comments:e.comments,shares:Array.from(e.shares)}),merge:(e,t)=>({...t,likes:new Set(e.likes),follows:new Set(e.follows),comments:e.comments,shares:new Set(e.shares)})}));function Ia({contentId:e,title:t,onClose:s}){const{addShare:r}=Pa(),i=`${window.location.origin}/watch/${e}`,a=async a=>{switch(r(e),a){case"twitter":window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(t)}&url=${encodeURIComponent(i)}`);break;case"facebook":window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(i)}`);break;case"copy":try{await navigator.clipboard.writeText(i)}catch(n){console.error("Failed to copy:",n)}}s()};return Ie.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:Ie.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md p-6",children:[Ie.jsx("h3",{className:"text-xl font-medium mb-4",children:"Share"}),Ie.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[Ie.jsxs("button",{onClick:()=>a("twitter"),className:"flex items-center gap-3 p-4 rounded-lg hover:bg-gray-50",children:[Ie.jsx(re,{className:"h-6 w-6 text-[#1DA1F2]"}),Ie.jsx("span",{children:"Twitter"})]}),Ie.jsxs("button",{onClick:()=>a("facebook"),className:"flex items-center gap-3 p-4 rounded-lg hover:bg-gray-50",children:[Ie.jsx(ie,{className:"h-6 w-6 text-[#4267B2]"}),Ie.jsx("span",{children:"Facebook"})]})]}),Ie.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-gray-50",children:[Ie.jsx("div",{className:"flex-1 truncate text-gray-600",children:i}),Ie.jsx("button",{onClick:()=>a("copy"),className:"p-2 hover:bg-gray-200 rounded-lg",children:Ie.jsx(ae,{className:"h-5 w-5"})})]}),Ie.jsx("button",{onClick:s,className:"w-full mt-6 px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"Cancel"})]})})}const $a=[{id:"diamond",name:"Diamond",symbol:"",price:100,points:1e5,description:"Diamond Clarified Check badge"},{id:"gold",name:"Gold",symbol:"",price:50,points:5e4,description:"Gold Clarified Check badge"},{id:"silver",name:"Silver",symbol:"",price:25,points:25e3,description:"Silver Clarified Check badge"},{id:"iron",name:"Iron",symbol:"",price:20,points:2e4,description:"2 swords"},{id:"spark",name:"Spark",symbol:"",price:10,points:1e4,description:"Lightning bolt Sparks symbol"},{id:"rainbow",name:"Rainbow",symbol:"",price:7,points:7e3,description:"7 colors"},{id:"trophy",name:"Trophy",symbol:"",price:5,points:5e3,description:"Gold trophy with CV logo"},{id:"wisdom",name:"Wisdom",symbol:"",price:3,points:3e3,description:"Bible symbol"},{id:"rose",name:"Rose",symbol:"",price:2,points:2e3,description:"Rose"},{id:"fire",name:"Fire",symbol:"",price:1,points:1e3,description:"Fire"},{id:"trend",name:"Trend",symbol:"",price:1,points:1e3,description:"Trending arrow"},{id:"cross",name:"Cross",symbol:"",price:1,points:1e3,description:"Cross"},{id:"love",name:"Love",symbol:"",price:.5,points:500,description:"Heart"},{id:"jot",name:"Jot",symbol:"",price:.5,points:500,description:"Clarity Jot pen"},{id:"chat",name:"Chat",symbol:"",price:.5,points:500,description:"Clarity Chat logo"}],Oa=[{id:"500",points:500,price:.99},{id:"1000",points:1e3,price:1.99},{id:"3000",points:3e3,price:4.99},{id:"6500",points:6500,price:9.99},{id:"10000",points:1e4,price:14.99},{id:"15000",points:15e3,price:19.99},{id:"100000",points:1e5,price:99.99}],Aa=dt()(ta(((e,t)=>({userPoints:{},gifts:[],addPoints:(t,s)=>e((e=>({userPoints:{...e.userPoints,[t]:(e.userPoints[t]||0)+s}}))),removePoints:(s,r)=>{const i=t().userPoints[s]||0;return!(i<r)&&(e((e=>({userPoints:{...e.userPoints,[s]:i-r}}))),!0)},getUserPoints:e=>t().userPoints[e]||0,sendGift:(s,r,i,a,n,o)=>{const l=$a.find((e=>e.id===s));if(!l)return!1;const c=l.points*n;if(!t().removePoints(r,c))return!1;const d={id:Math.random().toString(36).substr(2,9),giftId:s,senderId:r,recipientId:i,contentId:a,count:n,comment:o,timestamp:(new Date).toISOString()};return e((e=>({gifts:[d,...e.gifts]}))),!0},getContentGifts:e=>t().gifts.filter((t=>t.contentId===e)),getTopGift:e=>t().gifts.filter((t=>t.contentId===e)).sort(((e,t)=>{const s=$a.find((t=>t.id===e.giftId));return $a.find((e=>e.id===t.giftId)).price-s.price}))[0]||null})),{name:"vision-gifts"}));function Ra({contentId:t,recipientId:s,onClose:r}){const i=n(),{user:a}=Oi(),{getUserPoints:o,sendGift:l}=Aa(),[c,d]=e.useState(null),[h,u]=e.useState(1),[m,p]=e.useState(""),f=a?o(a.id):0,x=c?$a.find((e=>e.id===c)):null,v=x?x.points*h:0;return Ie.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:Ie.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md overflow-hidden",children:[Ie.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[Ie.jsxs("div",{className:"flex items-center gap-2",children:[Ie.jsx(Z,{className:"h-5 w-5 text-gold-500"}),Ie.jsx("h3",{className:"font-medium",children:"Send a Gift"})]}),Ie.jsx("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",children:Ie.jsx(g,{className:"h-5 w-5"})})]}),Ie.jsxs("div",{className:"p-6",children:[Ie.jsx("div",{className:"grid grid-cols-5 gap-4",children:$a.map((e=>Ie.jsxs("button",{onClick:()=>d(e.id),className:Ji("p-2 rounded-lg text-center hover:bg-gray-50",c===e.id&&"bg-gold-50 border-2 border-gold-500"),children:[Ie.jsx("div",{className:"text-2xl mb-1",children:e.symbol}),Ie.jsx("div",{className:"text-xs text-gray-600",children:e.points.toLocaleString()})]},e.id)))}),c&&Ie.jsxs(Ie.Fragment,{children:[Ie.jsxs("div",{className:"mt-6",children:[Ie.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantity"}),Ie.jsx("input",{type:"number",min:"1",max:"99",value:h,onChange:e=>u(Math.min(99,Math.max(1,parseInt(e.target.value)||1))),className:"w-full px-4 py-2 border rounded-lg"})]}),Ie.jsxs("div",{className:"mt-4",children:[Ie.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Add a comment (optional)"}),Ie.jsx("textarea",{value:m,onChange:e=>p(e.target.value),className:"w-full px-4 py-2 border rounded-lg resize-none",rows:3,placeholder:"Say something nice..."})]})]})]}),Ie.jsxs("div",{className:"p-4 border-t bg-gray-50",children:[Ie.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Ie.jsx("div",{className:"text-sm text-gray-600",children:"Your Points"}),Ie.jsx("div",{className:"font-medium",children:f.toLocaleString()})]}),c&&Ie.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Ie.jsx("div",{className:"text-sm text-gray-600",children:"Total Cost"}),Ie.jsx("div",{className:"font-medium",children:v.toLocaleString()})]}),Ie.jsx("button",{onClick:()=>{if(!a||!c)return;if(f<v)return i(`/points/purchase?needed=${v-f}&returnTo=${encodeURIComponent(window.location.pathname)}`),void r();l(c,a.id,s,t,h,m)&&r()},disabled:!c,className:"w-full py-2 bg-gold-500 text-white rounded-lg font-medium hover:bg-gold-600 disabled:opacity-50",children:f<v?"Purchase Points":"Send Gift"})]})]})})}function La({contentId:e,showAll:t=!1}){const{getContentGifts:s}=Aa(),r=s(e);if(0===r.length)return null;const i=t?r:r.slice(0,3);return Ie.jsxs("div",{className:"space-y-2",children:[i.map((e=>{const t=$a.find((t=>t.id===e.giftId));return Ie.jsxs("div",{className:"flex items-center gap-2",children:[Ie.jsx("span",{className:"text-2xl",children:t.symbol}),Ie.jsxs("span",{className:"text-sm text-gold-600 font-medium",children:[e.count>1?`${e.count}x `:"",t.name]}),e.comment&&Ie.jsxs("span",{className:"text-sm text-gray-600",children:[" ",e.comment]}),Ie.jsxs("span",{className:"text-xs text-gray-500",children:[" ",qi(e.timestamp)]})]},e.id)})),!t&&r.length>3&&Ie.jsxs("div",{className:"text-sm text-gold-600",children:["+",r.length-3," more gifts"]})]})}function Ua({spark:t,isActive:s}){const r=e.useRef(null),{toggleLike:i,hasLiked:a,toggleFollow:n,isFollowing:l}=Pa(),[c,d]=e.useState(!1),[h,u]=e.useState(!1);e.useEffect((()=>{const e=r.current;if(e){if(s){const t=e.play();void 0!==t&&t.catch((()=>{}))}else e.pause();return()=>{if(e){const t=e.pause();void 0!==t&&t.catch((()=>{}))}}}}),[s]);return Ie.jsxs("div",{className:"relative h-full bg-black rounded-xl overflow-hidden",children:[Ie.jsx("video",{ref:r,src:t.videoUrl,className:"h-full w-full object-cover",loop:!0,muted:!0,playsInline:!0}),Ie.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60"}),Ie.jsxs("div",{className:"absolute bottom-0 left-0 right-12 p-4",children:[Ie.jsx("h2",{className:"text-white text-lg font-medium mb-2",children:t.title}),Ie.jsx("p",{className:"text-white/80 text-sm mb-4",children:t.description}),Ie.jsxs("div",{className:"flex items-center gap-4",children:[Ie.jsx(o,{to:`/profile/${t.user.username}`,className:"rounded-full overflow-hidden flex-shrink-0 w-10 h-10 border-2 border-white",children:Ie.jsx("img",{src:t.user.avatar||`https://ui-avatars.com/api/?name=${t.user.username}`,alt:t.user.username,className:"w-full h-full object-cover"})}),Ie.jsxs("div",{className:"flex-1",children:[Ie.jsxs(o,{to:`/profile/${t.user.username}`,className:"text-white font-medium flex items-center gap-1",children:["@",t.user.username,t.user.isVerified&&Ie.jsx("span",{className:"inline-block w-4 h-4 bg-gold-500 text-white rounded-full text-xs flex items-center justify-center",children:""})]}),Ie.jsxs("div",{className:"text-white/80 text-sm",children:[t.user.followers.toLocaleString()," followers"]})]}),!l(t.user.id)&&Ie.jsx("button",{onClick:e=>{e.preventDefault(),n(t.user.id)},className:"bg-white text-black px-4 py-1.5 rounded-full text-sm font-medium hover:bg-white/90 transition-colors",children:"Follow"})]})]}),Ie.jsxs("div",{className:"absolute right-4 bottom-4 flex flex-col items-center gap-6",children:[Ie.jsxs("button",{onClick:()=>i(t.id),className:"group flex flex-col items-center gap-1",children:[Ie.jsx("div",{className:Ji("p-2 rounded-full transition-colors",a(t.id)?"bg-gold-500":"bg-black/50 group-hover:bg-black/80"),children:Ie.jsx(U,{className:Ji("w-6 h-6",a(t.id)?"text-white fill-current":"text-white")})}),Ie.jsx("span",{className:"text-white text-sm",children:t.likes.toLocaleString()})]}),Ie.jsxs("button",{className:"group flex flex-col items-center gap-1",children:[Ie.jsx("div",{className:"p-2 rounded-full bg-black/50 group-hover:bg-black/80 transition-colors",children:Ie.jsx(te,{className:"w-6 h-6 text-white"})}),Ie.jsx("span",{className:"text-white text-sm",children:t.comments.toLocaleString()})]}),Ie.jsxs("button",{onClick:()=>d(!0),className:"group flex flex-col items-center gap-1",children:[Ie.jsx("div",{className:"p-2 rounded-full bg-black/50 group-hover:bg-black/80 transition-colors",children:Ie.jsx(ne,{className:"w-6 h-6 text-white"})}),Ie.jsx("span",{className:"text-white text-sm",children:t.shares.toLocaleString()})]}),Ie.jsxs("button",{onClick:()=>u(!0),className:"group flex flex-col items-center gap-1",children:[Ie.jsx("div",{className:"p-2 rounded-full bg-black/50 group-hover:bg-black/80 transition-colors",children:Ie.jsx(Z,{className:"w-6 h-6 text-white"})}),Ie.jsx("span",{className:"text-white text-sm",children:t.gifts.toLocaleString()})]})]}),Ie.jsx("div",{className:"absolute left-4 bottom-32",children:Ie.jsx(La,{contentId:t.id})}),c&&Ie.jsx(Ia,{contentId:t.id,title:t.title,onClose:()=>d(!1)}),h&&Ie.jsx(Ra,{contentId:t.id,recipientId:t.user.id,onClose:()=>u(!1)})]})}function Da({sparks:t}){const[s,r]=e.useState(0),i=e.useRef(null);return e.useEffect((()=>{const e=i.current;if(!e)return;const t=()=>{const t=Math.round(e.scrollTop/e.clientHeight);r(t)};return e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)}),[]),Ie.jsx("div",{ref:i,className:"h-full overflow-y-scroll snap-y snap-mandatory",style:{scrollbarWidth:"none"},children:t.map(((e,t)=>Ie.jsx("div",{className:"h-full snap-start snap-always",children:Ie.jsx("div",{className:"h-full max-w-[calc((100vh-8rem)*0.5625)] mx-auto relative",children:Ie.jsx(Ua,{spark:e,isActive:t===s})})},e.id)))})}function Fa(){const[t,s]=e.useState("trending"),{sparks:r,getTopCreators:i}=Ca(),a=i(),n=r.some((e=>e.isFollowing));return Ie.jsxs("div",{className:"h-[calc(100vh-4rem)] bg-white",children:[Ie.jsx("div",{className:"sticky top-16 z-50 bg-white border-b border-gray-100",children:Ie.jsx("div",{className:"max-w-2xl mx-auto flex justify-center py-4",children:Ie.jsxs("div",{className:"flex gap-4",children:[Ie.jsx("button",{onClick:()=>s("trending"),className:Ji("px-6 py-2 rounded-full text-sm font-medium transition-colors","trending"===t?"bg-gold-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"Trending"}),Ie.jsx("button",{onClick:()=>s("following"),className:Ji("px-6 py-2 rounded-full text-sm font-medium transition-colors","following"===t?"bg-gold-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"Following"})]})})}),Ie.jsx("div",{className:"h-[calc(100vh-8rem)] pt-4",children:"following"!==t||n?Ie.jsx(Da,{sparks:r.filter((e=>"trending"===t||e.isFollowing))}):Ie.jsxs("div",{className:"max-w-lg mx-auto text-center pt-12",children:[Ie.jsx("h2",{className:"text-2xl font-medium mb-6",children:"Looking for more Sparks?"}),Ie.jsx("p",{className:"text-gray-600 mb-8",children:"Follow these top creators"}),Ie.jsx("div",{className:"grid grid-cols-2 gap-4",children:a.map((e=>Ie.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 p-3 rounded-xl",children:[Ie.jsx("img",{src:e.avatar||`https://ui-avatars.com/api/?name=${e.username}`,alt:e.username,className:"w-12 h-12 rounded-full"}),Ie.jsxs("div",{className:"flex-1 min-w-0",children:[Ie.jsx("h3",{className:"font-medium truncate text-gray-900",children:e.username}),Ie.jsxs("p",{className:"text-sm text-gray-600",children:[e.followers.toLocaleString()," followers"]})]}),Ie.jsx("button",{className:"bg-gold-500 text-white px-4 py-1.5 rounded-full text-sm font-medium hover:bg-gold-600 transition-colors",children:"Follow"})]},e.id)))})]})})]})}const Ma=[{id:"vision-tv",name:"VISION TV",logo:"https://images.unsplash.com/photo-1611162617474-5b21e879e113?w=128&h=128&fit=crop",description:"Official VISION TV Channel",currentViewers:15420,isLive:!0,streamUrl:"https://storage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",schedule:[{id:"show-1",title:"Primetime Hour",description:"Your daily dose of entertainment and news",thumbnail:"https://images.unsplash.com/photo-1517604931442-7e0c8ed2963c",startTime:"2024-03-15T19:00:00Z",duration:60,channel:"vision-tv"}]},{id:"newsmax",name:"Newsmax",logo:"https://images.unsplash.com/photo-1495020689067-958852a7765e?w=128&h=128&fit=crop",description:"24/7 News Coverage",currentViewers:8750,isLive:!0,streamUrl:"https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4",schedule:[{id:"show-2",title:"Tucker Carlson Tonight",description:"News and commentary with Tucker Carlson",thumbnail:"https://images.unsplash.com/photo-1590341328520-63256eb32bc3",startTime:"2024-03-15T20:00:00Z",duration:60,channel:"newsmax"}]},{id:"firehouse",name:"Firehouse TV",logo:"https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=128&h=128&fit=crop",description:"By Marcus Rogers",currentViewers:5230,isLive:!0,streamUrl:"https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4",schedule:[]}],Va=dt(((e,t)=>({channels:Ma,activeChannel:null,showGuide:!1,selectedShow:null,reminders:new Set,getChannels:()=>t().channels,setActiveChannel:t=>e({activeChannel:t}),toggleGuide:()=>e((e=>({showGuide:!e.showGuide}))),selectShow:t=>e({selectedShow:t}),toggleReminder:t=>e((e=>{const s=new Set(e.reminders);return s.has(t)?s.delete(t):s.add(t),{reminders:s}})),hasReminder:e=>t().reminders.has(e)})));function Ba(){const{channels:t,activeChannel:s,showGuide:r,toggleGuide:i,setActiveChannel:a,selectShow:n,toggleReminder:o,hasReminder:l}=Va();e.useEffect((()=>{!s&&t.length>0&&a(t[0].id)}),[t,s,a]);const c=t.find((e=>e.id===s));return Ie.jsxs("div",{className:"min-h-screen bg-black text-white",children:[c&&Ie.jsx("div",{className:"aspect-video bg-gray-900",children:Ie.jsx("video",{src:c.streamUrl,className:"w-full h-full object-contain",controls:!0,autoPlay:!0})}),Ie.jsxs("div",{className:"bg-gray-900 p-4",children:[Ie.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Ie.jsx("h2",{className:"text-xl font-medium",children:"VISION TV Channels"}),Ie.jsxs("button",{onClick:i,className:"flex items-center gap-2 text-gold-400 hover:text-gold-300",children:[Ie.jsx(oe,{className:"h-5 w-5"}),Ie.jsx("span",{children:"What's Next"})]})]}),Ie.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4",children:t.map((e=>Ie.jsxs("div",{onClick:()=>a(e.id),className:"flex-shrink-0 group cursor-pointer "+(e.id===s?"scale-110":""),children:[Ie.jsx("div",{className:"w-20 h-20 rounded-lg overflow-hidden mb-2",children:Ie.jsx("img",{src:e.logo,alt:e.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform"})}),Ie.jsxs("div",{className:"text-center text-sm",children:[Ie.jsx("div",{className:"font-medium truncate",children:e.name}),Ie.jsxs("div",{className:"text-gray-400 text-xs",children:[e.currentViewers.toLocaleString()," watching"]})]})]},e.id)))})]}),r&&Ie.jsx("div",{className:"fixed inset-0 bg-black/80 z-50",children:Ie.jsx("div",{className:"max-w-3xl mx-auto mt-20 bg-gray-900 rounded-lg overflow-hidden",children:Ie.jsxs("div",{className:"p-6",children:[Ie.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Ie.jsx("h3",{className:"text-2xl font-medium",children:"TV Guide"}),Ie.jsx("button",{onClick:i,className:"text-gray-400 hover:text-white",children:Ie.jsx(le,{className:"h-6 w-6"})})]}),t.map((e=>Ie.jsxs("div",{className:"mb-8 last:mb-0",children:[Ie.jsx("h4",{className:"text-lg font-medium mb-4",children:e.name}),Ie.jsx("div",{className:"space-y-4",children:e.schedule.map((e=>Ie.jsx("div",{onClick:()=>n(e),className:"w-full text-left p-4 rounded-lg bg-gray-800 hover:bg-gray-700 cursor-pointer",children:Ie.jsxs("div",{className:"flex items-center justify-between",children:[Ie.jsxs("div",{children:[Ie.jsx("div",{className:"font-medium",children:e.title}),Ie.jsxs("div",{className:"text-sm text-gray-400",children:["Starts ",qi(e.startTime)]})]}),Ie.jsx("button",{onClick:t=>{t.stopPropagation(),o(e.id)},className:"p-2 rounded-full "+(l(e.id)?"bg-gold-500 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600"),children:Ie.jsx(b,{className:"h-5 w-5"})})]})},e.id)))})]},e.id)))]})})})]})}function za(){n();const{user:t}=Oi(),[s,r]=e.useState("account"),[i,a]=e.useState({username:(null==t?void 0:t.username)||"",email:(null==t?void 0:t.email)||"",language:"English (US)",currentPassword:"",newPassword:"",confirmPassword:""}),o=e=>{const{name:t,value:s}=e.target;a((e=>({...e,[t]:s})))},l=[{id:"account",label:"Account",icon:w},{id:"notifications",label:"Notifications",icon:b},{id:"playback",label:"Playback",icon:H},{id:"privacy",label:"Privacy",icon:Y},{id:"security",label:"Security",icon:ee},{id:"billing",label:"Billing",icon:se},{id:"dashboards",label:"Dashboards",icon:ue}];return Ie.jsx("div",{className:"min-h-screen bg-gray-50",children:Ie.jsxs("div",{className:"max-w-6xl mx-auto px-8 py-12",children:[Ie.jsx("h1",{className:"text-3xl font-medium mb-8",children:"Settings"}),Ie.jsxs("div",{className:"flex gap-8",children:[Ie.jsx("div",{className:"w-64 flex-shrink-0",children:Ie.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4",children:l.map((e=>Ie.jsxs("button",{onClick:()=>r(e.id),className:Ji("w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left",s===e.id?"bg-gold-50 text-gold-600":"text-gray-600 hover:bg-gray-50"),children:[Ie.jsx(e.icon,{className:"h-5 w-5"}),Ie.jsx("span",{children:e.label})]},e.id)))})}),Ie.jsx("div",{className:"flex-1",children:Ie.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8",children:"account"===s&&Ie.jsxs("div",{className:"space-y-8",children:[Ie.jsx("h2",{className:"text-2xl font-medium mb-6",children:"Account Settings"}),Ie.jsxs("div",{className:"space-y-4",children:[Ie.jsx("h3",{className:"text-lg font-medium",children:"Profile"}),Ie.jsxs("div",{className:"flex items-center gap-4",children:[Ie.jsx("div",{className:"w-20 h-20 rounded-full bg-gray-100 overflow-hidden",children:Ie.jsx("img",{src:(null==t?void 0:t.avatar)||`https://ui-avatars.com/api/?name=${null==t?void 0:t.username}`,alt:"Profile",className:"w-full h-full object-cover"})}),Ie.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Change Photo"})]})]}),Ie.jsxs("form",{onSubmit:e=>{e.preventDefault(),console.log("Saving changes:",i)},className:"space-y-4",children:[Ie.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Ie.jsxs("div",{children:[Ie.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),Ie.jsx("input",{type:"text",name:"username",value:i.username,onChange:o,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gold-500/20 focus:border-gold-500"})]}),Ie.jsxs("div",{children:[Ie.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),Ie.jsx("input",{type:"email",name:"email",value:i.email,onChange:o,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gold-500/20 focus:border-gold-500"})]})]}),Ie.jsxs("div",{className:"space-y-4",children:[Ie.jsx("h3",{className:"text-lg font-medium",children:"Language & Region"}),Ie.jsxs("div",{className:"flex items-center gap-4",children:[Ie.jsx(ce,{className:"h-5 w-5 text-gray-400"}),Ie.jsxs("select",{name:"language",value:i.language,onChange:o,className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gold-500/20 focus:border-gold-500",children:[Ie.jsx("option",{children:"English (US)"}),Ie.jsx("option",{children:"Spanish"}),Ie.jsx("option",{children:"French"})]})]})]}),Ie.jsx("div",{className:"pt-4",children:Ie.jsx("button",{type:"submit",className:"px-6 py-2 bg-gold-500 text-white rounded-lg hover:bg-gold-600",children:"Save Changes"})})]}),Ie.jsxs("div",{className:"pt-6 border-t",children:[Ie.jsx("h3",{className:"text-lg font-medium text-red-600 mb-4",children:"Danger Zone"}),Ie.jsxs("div",{className:"space-y-4",children:[Ie.jsxs("button",{className:"flex items-center gap-2 text-red-600 hover:text-red-700",children:[Ie.jsx(de,{className:"h-5 w-5"}),Ie.jsx("span",{children:"Delete Account"})]}),Ie.jsxs("button",{className:"flex items-center gap-2 text-gray-600 hover:text-gray-700",children:[Ie.jsx(he,{className:"h-5 w-5"}),Ie.jsx("span",{children:"Sign Out"})]})]})]})]})})})]})]})})}const Ja=.8,qa=.4,Ha=.2;function Wa({contentId:t,onClose:s}){Oi();const{addComment:r,getComments:i}=Pa(),[a,n]=e.useState(""),[o,l]=e.useState(!1),[c,d]=e.useState("");i(t);return Ie.jsx("div",{className:"flex flex-col h-full",children:Ie.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),a.trim()&&!o){l(!0),d("");try{const e=await async function(e,t,s){const r=Ii("https://ighpjdpsntdcsdvqnipc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlnaHBqZHBzbnRkY3NkdnFuaXBjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzYxMjk4NDAsImV4cCI6MjA1MTcwNTg0MH0.9nwDeL6ERmU50WiMRJz4bLcpfhB6EXnDul2njD7GV2k");try{const{data:i,error:a}=await r.functions.invoke("moderate-content",{body:{content:e,type:t,timestamp:s}});if(a)throw a;const{confidence:n,categories:o}=i;let l,c=!1,d="low";return n>=Ja?(l="rejected",c=!0,d="high"):n>=qa?(l="pending",c=!0,d="medium"):n>=Ha?(l="pending",c=!0,d="low"):l="approved",{status:l,confidence:n,timestamp:s,categories:o,needsReview:c,reviewPriority:d}}catch(i){return console.error("Moderation failed:",i),{status:"pending",confidence:1,timestamp:s,categories:["error"],needsReview:!0,reviewPriority:"high"}}}(a,"comment");if("rejected"===e.status)return void d("This comment cannot be posted as it violates our community guidelines.");"pending"===e.status?(d("Your comment will be visible after review (usually within 1 hour)."),r(t,a,!0)):r(t,a),n("")}catch(s){d("Unable to post comment. Please try again.")}finally{l(!1)}}},className:"p-4 border-t",children:[Ie.jsxs("div",{className:"flex gap-2",children:[Ie.jsx("input",{type:"text",value:a,onChange:e=>n(e.target.value),placeholder:"Add a comment...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-gold-500/20 focus:border-gold-500",disabled:o}),Ie.jsx("button",{type:"submit",disabled:!a.trim()||o,className:"px-4 py-2 bg-gold-500 text-white rounded-full font-medium hover:bg-gold-600 disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Checking...":"Post"})]}),c&&Ie.jsx("p",{className:"mt-2 text-sm text-red-600",children:c})]})})}function Ga({currentVideo:e}){const{videos:t,autoplay:s,toggleAutoplay:r}=Di(),i=t.filter((t=>t.id!==e.id&&(t.category===e.category||t.user.id===e.user.id))).slice(0,5);return Ie.jsxs("div",{className:"space-y-4",children:[Ie.jsxs("div",{className:"flex items-center justify-between",children:[Ie.jsx("h3",{className:"font-medium text-lg",children:"Up Next"}),Ie.jsxs("button",{onClick:r,className:"flex items-center gap-2 text-sm",children:[Ie.jsx("div",{className:Ji("w-8 h-4 rounded-full transition-colors relative",s?"bg-gold-500":"bg-gray-300"),children:Ie.jsx("div",{className:Ji("absolute top-0.5 left-0.5 w-3 h-3 bg-white rounded-full transition-transform",s&&"translate-x-4")})}),Ie.jsx("span",{className:"text-gray-600",children:"Autoplay"}),Ie.jsx(H,{className:"h-4 w-4 text-gray-600"})]})]}),Ie.jsx("div",{className:"space-y-4",children:i.map((e=>Ie.jsx(aa,{video:e,onView:()=>{},size:"small"},e.id)))})]})}function Ka(){var t;const{videoId:s}=c(),r=n(),i=l(),{videos:a,setMiniPlayerVideo:d}=Di(),{toggleLike:h,hasLiked:u,toggleFollow:m,isFollowing:p}=Pa(),[g,f]=e.useState(!1),[x,v]=e.useState(!1),[b,w]=e.useState(!1),y=e.useRef(null),j=a.find((e=>e.id===s));return e.useEffect((()=>{d(null)}),[d]),e.useEffect((()=>()=>{!i.pathname.startsWith("/watch/")&&j&&d(j)}),[i,j,d]),j?Ie.jsxs("div",{className:"min-h-screen bg-white",children:[Ie.jsx("div",{className:"aspect-video bg-black",children:Ie.jsx("video",{src:j.videoUrl,className:"w-full h-full",controls:!0,autoPlay:!0,playsInline:!0})}),Ie.jsx("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 py-4 lg:py-6",children:Ie.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[Ie.jsxs("div",{className:"flex-1",children:[Ie.jsxs("div",{className:"mb-4",children:[Ie.jsx("h1",{className:"text-xl lg:text-2xl font-medium mb-2",children:j.title}),Ie.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600",children:[Ie.jsxs("span",{children:[Hi(j.views)," views"]}),Ie.jsx("span",{children:""}),Ie.jsx("span",{children:qi(j.createdAt)})]})]}),Ie.jsxs("div",{className:"flex flex-wrap items-center gap-4 py-4 border-t border-b",children:[Ie.jsxs("button",{onClick:()=>h(j.id),className:Ji("flex items-center gap-2 px-4 py-2 rounded-full transition-colors",u(j.id)?"bg-gold-50 text-gold-600":"hover:bg-gray-100"),children:[Ie.jsx(U,{className:Ji("h-5 w-5",u(j.id)&&"fill-current")}),Ie.jsx("span",{className:"hidden sm:inline",children:Hi(j.likes)})]}),Ie.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 px-4 py-2 rounded-full hover:bg-gray-100",children:[Ie.jsx(ne,{className:"h-5 w-5"}),Ie.jsx("span",{className:"hidden sm:inline",children:Hi(j.shares)})]}),Ie.jsxs("button",{onClick:()=>v(!0),className:"flex items-center gap-2 px-4 py-2 rounded-full hover:bg-gray-100",children:[Ie.jsx(Z,{className:"h-5 w-5"}),Ie.jsx("span",{className:"hidden sm:inline",children:"Gift"})]}),Ie.jsxs("button",{ref:y,onClick:()=>w(!0),className:"flex items-center gap-2 px-4 py-2 rounded-full hover:bg-gray-100",children:[Ie.jsx(J,{className:"h-5 w-5"}),Ie.jsx("span",{className:"hidden sm:inline",children:"Save"})]}),Ie.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 rounded-full hover:bg-gray-100",children:[Ie.jsx(G,{className:"h-5 w-5"}),Ie.jsx("span",{className:"hidden sm:inline",children:"Download"})]})]}),Ie.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between py-4",children:[Ie.jsxs("div",{className:"flex items-center gap-4 mb-4 sm:mb-0",children:[Ie.jsx(o,{to:`/profile/${j.user.username}`,children:Ie.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden",children:Ie.jsx("img",{src:j.user.avatar||`https://ui-avatars.com/api/?name=${j.user.username}`,alt:j.user.username,className:"w-full h-full object-cover"})})}),Ie.jsxs("div",{children:[Ie.jsxs(o,{to:`/profile/${j.user.username}`,className:"font-medium hover:text-gold-600",children:[j.user.username,j.user.isVerified&&Ie.jsx("span",{className:"ml-1 inline-block w-4 h-4 bg-gold-500 text-white rounded-full text-xs flex items-center justify-center",children:""})]}),Ie.jsxs("div",{className:"text-sm text-gray-600",children:[null==(t=j.user.followers)?void 0:t.toLocaleString()," followers"]})]})]}),Ie.jsx("button",{onClick:()=>m(j.user.id),className:Ji("w-full sm:w-auto px-6 py-2 rounded-full font-medium transition-colors",p(j.user.id)?"bg-gray-100 text-gray-900 hover:bg-gray-200":"bg-gold-500 text-white hover:bg-gold-600"),children:p(j.user.id)?"Following":"Follow"})]}),Ie.jsx("div",{className:"mt-4 text-gray-600 whitespace-pre-wrap",children:j.description}),Ie.jsx("div",{className:"mt-8",children:Ie.jsx(Wa,{contentId:j.id})})]}),Ie.jsx("div",{className:"w-full lg:w-96",children:Ie.jsx(Ga,{currentVideo:j})})]})}),g&&Ie.jsx(Ia,{contentId:j.id,title:j.title,onClose:()=>f(!1)}),x&&Ie.jsx(Ra,{contentId:j.id,recipientId:j.user.id,onClose:()=>v(!1)}),b&&Ie.jsx(ra,{videoId:j.id,onClose:()=>w(!1),buttonRef:y}),Ie.jsx("div",{className:"fixed bottom-4 left-4",children:Ie.jsx(La,{contentId:j.id})})]}):(r("/"),null)}const Ya=[{threshold:0,color:"#0000FF"},{threshold:100,color:"#00FF00"},{threshold:1e3,color:"#87CEEB"},{threshold:2500,color:"#FF69B4"},{threshold:5e3,color:"#FFA500"},{threshold:1e4,color:"#FF0000"},{threshold:2e4,color:"#FFFF00"},{threshold:3e4,color:"#40E0D0"},{threshold:4e4,color:"#006400"},{threshold:5e4,color:"#DAA520"},{threshold:75e3,color:"#FF8C00"},{threshold:1e5,color:"#B6AC7D"}];function Za({value:t,label:s}){const r=e.useRef(null),i=e=>{for(let t=Ya.length-1;t>=0;t--)if(e>=Ya[t].threshold)return Ya[t];return Ya[0]},a=e=>{const t=i(e),s=(e=>{for(const t of Ya)if(e<t.threshold)return t.threshold;return 10*e})(e),r=t.threshold;return(e-r)/(s-r)*100};return e.useEffect((()=>{const e=r.current;if(!e)return;const s=e.getContext("2d");if(!s)return;const n=i(t),o=a(t);let l=0;const c=()=>{s.clearRect(0,0,e.width,e.height),s.beginPath(),s.arc(e.width/2,e.height/2,70,0,2*Math.PI),s.strokeStyle="rgba(182, 172, 125, 0.5)",s.lineWidth=8,s.stroke(),s.beginPath(),s.arc(e.width/2,e.height/2,70,l,l+2*Math.PI*o/100),s.strokeStyle=n.color,s.lineWidth=8,s.lineCap="round",s.stroke(),s.shadowColor=n.color,s.shadowBlur=15,s.stroke(),s.shadowBlur=0,l+=Math.PI/300,l>=2*Math.PI&&(l=0),requestAnimationFrame(c)};c()}),[t]),Ie.jsx("div",{className:"flex flex-col items-center",children:Ie.jsxs("div",{className:"relative",children:[Ie.jsx("canvas",{ref:r,width:180,height:180,className:"w-[180px] h-[180px]"}),Ie.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[Ie.jsx("div",{className:"text-4xl font-bold text-gold-500",children:(n=t,n>=1e9?`${(n/1e9).toFixed(1)}B`:n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}K`:n.toString())}),Ie.jsx("div",{className:"text-base text-gray-600 mt-2",children:s})]})]})});var n}function Xa(){var t;const{username:s}=c(),r=n(),{videos:i}=Di(),{toggleFollow:a,isFollowing:o}=Pa(),[l,h]=e.useState("videos"),u=i.filter((e=>e.user.username===s)),m=null==(t=u[0])?void 0:t.user,p=u.reduce(((e,t)=>e+t.views),0);return m?Ie.jsxs("div",{className:"min-h-screen bg-white",children:[Ie.jsxs("div",{className:"relative h-80 bg-gradient-to-r from-gold-500 to-gold-600",children:[Ie.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/30 to-black/60"}),Ie.jsx("button",{onClick:()=>r(-1),className:"absolute top-6 left-8 text-white hover:text-white/80 transition-colors z-10",children:Ie.jsx(le,{className:"h-6 w-6"})})]}),Ie.jsx("div",{className:"max-w-7xl mx-auto px-8",children:Ie.jsxs("div",{className:"relative -mt-32",children:[Ie.jsxs("div",{className:"flex items-start gap-8 mb-8",children:[Ie.jsx("div",{className:"w-40 h-40 rounded-full border-4 border-white shadow-lg overflow-hidden bg-white flex-shrink-0",children:Ie.jsx("img",{src:m.avatar||`https://ui-avatars.com/api/?name=${m.username}`,alt:m.username,className:"w-full h-full object-cover"})}),Ie.jsx("div",{className:"flex-1 pt-8",children:Ie.jsxs("div",{className:"flex items-start justify-between",children:[Ie.jsxs("div",{children:[Ie.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[Ie.jsx("h1",{className:"text-4xl font-medium text-white",children:m.username}),m.isVerified&&Ie.jsx("span",{className:"w-6 h-6 bg-gold-500 text-white rounded-full text-sm flex items-center justify-center shadow-md",children:""})]}),Ie.jsx("div",{className:"text-white/90 text-lg mb-4",children:m.bio||`Videos by ${m.username}`}),Ie.jsxs("div",{className:"text-white/80",children:["Joined ",qi(m.createdAt)]})]}),Ie.jsx("button",{onClick:()=>a(m.id),className:Ji("px-8 py-3 rounded-full font-medium transition-all shadow-lg",o(m.id)?"bg-white text-gray-900 hover:bg-gray-100":"bg-gold-500 text-white hover:bg-gold-600"),children:o(m.id)?Ie.jsxs("div",{className:"flex items-center gap-2",children:[Ie.jsx("span",{className:"w-5 h-5 bg-green-500 text-white rounded-full flex items-center justify-center text-sm",children:""}),"Following"]}):"Follow"})]})})]}),Ie.jsxs("div",{className:"grid grid-cols-3 gap-12 mb-8 bg-white rounded-2xl p-8 shadow-sm",children:[Ie.jsx(Za,{value:p,label:"Total Views"}),Ie.jsx(Za,{value:u.length,label:"Videos"}),Ie.jsx(Za,{value:m.followers||0,label:"Followers"})]}),Ie.jsxs("div",{className:"flex gap-8 mb-8 border-b border-gray-200",children:[Ie.jsx("button",{onClick:()=>h("videos"),className:Ji("px-4 py-4 font-medium border-b-2 transition-colors","videos"===l?"border-gold-500 text-gold-600":"border-transparent text-gray-600 hover:text-gray-900"),children:"Videos"}),Ie.jsx("button",{onClick:()=>h("playlists"),className:Ji("px-4 py-4 font-medium border-b-2 transition-colors","playlists"===l?"border-gold-500 text-gold-600":"border-transparent text-gray-600 hover:text-gray-900"),children:"Playlists"})]}),"videos"===l&&Ie.jsx("div",{className:"grid grid-cols-4 gap-6",children:u.map((e=>Ie.jsx(aa,{video:e,onView:()=>{},size:"small"},e.id)))}),"playlists"===l&&Ie.jsx("div",{className:"text-center py-12 text-gray-500",children:"No playlists yet"})]})})]}):Ie.jsx(d,{to:"/",replace:!0})}function Qa(){const t=n(),s=l(),{signIn:r,signUp:i}=Oi(),[a,o]=e.useState("signin"),[c,d]=e.useState(!1),[h,u]=e.useState(""),[m,p]=e.useState(""),[g,f]=e.useState(""),[x,v]=e.useState(!1);return Ie.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:Ie.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-sm p-8",children:[Ie.jsxs("div",{className:"text-center",children:[Ie.jsxs("div",{className:"flex items-center justify-center gap-2 mb-4",children:[Ie.jsx(S,{className:"h-8 w-8 text-gold-500"}),Ie.jsx("span",{className:"text-2xl font-light tracking-wider",children:"VISION"})]}),Ie.jsx("h2",{className:"text-3xl font-medium text-gray-900",children:"signin"===a?"Welcome back":"Create your account"}),Ie.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["signin"===a?"Don't have an account? ":"Already have an account? ",Ie.jsx("button",{onClick:()=>{o("signin"===a?"signup":"signin"),f("")},className:"text-gold-600 hover:text-gold-700 font-medium",children:"signin"===a?"Sign up":"Sign in"})]})]}),Ie.jsxs("form",{onSubmit:async e=>{var n,o,l;e.preventDefault(),f(""),v(!0);try{"signin"===a?await r(h,m):await i(h,m);const e=(null==(o=null==(n=s.state)?void 0:n.from)?void 0:o.pathname)||"/";t(e,{replace:!0})}catch(c){"Invalid login credentials"===c.message?f("Invalid email or password"):(null==(l=c.message)?void 0:l.includes("Email not confirmed"))?f("Please check your email to confirm your account"):f(c.message||"An error occurred")}finally{v(!1)}},className:"mt-8 space-y-6",children:[g&&Ie.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded-lg text-sm",children:g}),Ie.jsxs("div",{className:"space-y-4",children:[Ie.jsxs("div",{children:[Ie.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),Ie.jsxs("div",{className:"mt-1 relative",children:[Ie.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:h,onChange:e=>u(e.target.value),className:"appearance-none block w-full px-4 py-3 border border-gray-300 rounded-lg placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-gold-500/20 focus:border-gold-500",placeholder:"Enter your email"}),Ie.jsx(me,{className:"absolute right-4 top-3.5 h-5 w-5 text-gray-400"})]})]}),Ie.jsxs("div",{children:[Ie.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),Ie.jsxs("div",{className:"mt-1 relative",children:[Ie.jsx("input",{id:"password",name:"password",type:c?"text":"password",autoComplete:"signin"===a?"current-password":"new-password",required:!0,value:m,onChange:e=>p(e.target.value),className:"appearance-none block w-full px-4 py-3 border border-gray-300 rounded-lg placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-gold-500/20 focus:border-gold-500",placeholder:"Enter your password"}),Ie.jsx("button",{type:"button",onClick:()=>d(!c),className:"absolute right-4 top-3.5 text-gray-400 hover:text-gray-600",children:c?Ie.jsx(pe,{className:"h-5 w-5"}):Ie.jsx(ge,{className:"h-5 w-5"})})]})]})]}),Ie.jsx("button",{type:"submit",disabled:x,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gold-500 hover:bg-gold-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gold-500 disabled:opacity-50 disabled:cursor-not-allowed",children:x?Ie.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):"signin"===a?"Sign in":"Create account"})]})]})})}function en(e,t,s){const r=t.toLowerCase(),i=[],a=[];return e.forEach((e=>{const t=s(e).toLowerCase();if(t.includes(r))return void i.push(e);const n=Fi(r,t);n<=3&&a.push({item:e,distance:n})})),a.sort(((e,t)=>e.distance-t.distance)),{exact:i,approximate:a}}function tn(){const[t]=h(),s=t.get("q")||"",[r,i]=e.useState("all"),{videos:a}=Di(),{getLiveEvents:n}=va(),{sparks:l}=Ca(),{channels:c}=Va(),d=en(a,s,(e=>`${e.title} ${e.description} ${e.user.username}`)),u=en(n(),s,(e=>`${e.title} ${e.description} ${e.user.username}`)),m=en(l,s,(e=>`${e.title} ${e.description} ${e.user.username}`)),p=en(c,s,(e=>`${e.name} ${e.description}`)),g=d.exact.length+u.exact.length+m.exact.length+p.exact.length,f=d.approximate.length+u.approximate.length+m.approximate.length+p.approximate.length;return e.useEffect((()=>{document.title=`${s} - Search Results - VISION`}),[s]),Ie.jsxs("div",{className:"min-h-screen bg-white py-8 px-8",children:[Ie.jsxs("div",{className:"mb-8",children:[Ie.jsx("h1",{className:"text-3xl font-medium mb-2",children:"Search Results"}),Ie.jsxs("p",{className:"text-gray-600",children:["Found ",g," exact ",1===g?"match":"matches",f>0&&` and ${f} similar ${1===f?"result":"results"}`,'for "',s,'"']})]}),Ie.jsx("div",{className:"flex gap-4 mb-8",children:[{id:"all",label:"All Results"},{id:"videos",label:"Videos"},{id:"live",label:"Live & Events"},{id:"sparks",label:"Sparks"},{id:"tv",label:"TV Channels"}].map((e=>Ie.jsx("button",{onClick:()=>i(e.id),className:"px-6 py-2 rounded-full text-sm font-medium transition-colors "+(r===e.id?"bg-gold-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:e.label},e.id)))}),Ie.jsxs("div",{className:"space-y-12",children:[("all"===r||"videos"===r)&&(d.exact.length>0||d.approximate.length>0)&&Ie.jsxs("section",{children:[Ie.jsx("h2",{className:"text-2xl font-medium mb-6",children:"Videos"}),d.exact.length>0&&Ie.jsx("div",{className:"grid grid-cols-4 gap-6 mb-8",children:("all"===r?d.exact.slice(0,4):d.exact).map((e=>Ie.jsx(aa,{video:e,onView:()=>{},size:"small"},e.id)))}),d.approximate.length>0&&Ie.jsxs("div",{children:[Ie.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-4",children:"Similar Results"}),Ie.jsx("div",{className:"grid grid-cols-4 gap-6",children:("all"===r?d.approximate.slice(0,4):d.approximate).map((({item:e})=>Ie.jsx(aa,{video:e,onView:()=>{},size:"small"},e.id)))})]})]}),("all"===r||"live"===r)&&(u.exact.length>0||u.approximate.length>0)&&Ie.jsxs("section",{children:[Ie.jsx("h2",{className:"text-2xl font-medium mb-6",children:"Live & Events"}),u.exact.length>0&&Ie.jsx("div",{className:"grid grid-cols-3 gap-6 mb-8",children:("all"===r?u.exact.slice(0,3):u.exact).map((e=>Ie.jsx(ya,{event:e},e.id)))}),u.approximate.length>0&&Ie.jsxs("div",{children:[Ie.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-4",children:"Similar Results"}),Ie.jsx("div",{className:"grid grid-cols-3 gap-6",children:("all"===r?u.approximate.slice(0,3):u.approximate).map((({item:e})=>Ie.jsx(ya,{event:e},e.id)))})]})]}),("all"===r||"sparks"===r)&&(m.exact.length>0||m.approximate.length>0)&&Ie.jsxs("section",{children:[Ie.jsx("h2",{className:"text-2xl font-medium mb-6",children:"Sparks"}),m.exact.length>0&&Ie.jsx("div",{className:"grid grid-cols-4 gap-6 mb-8",children:("all"===r?m.exact.slice(0,4):m.exact).map((e=>Ie.jsx("div",{className:"aspect-[9/16] w-full max-w-[calc(100vh*0.5625)] rounded-xl overflow-hidden",children:Ie.jsx(Ua,{spark:e,isActive:!1})},e.id)))}),m.approximate.length>0&&Ie.jsxs("div",{children:[Ie.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-4",children:"Similar Results"}),Ie.jsx("div",{className:"grid grid-cols-4 gap-6",children:("all"===r?m.approximate.slice(0,4):m.approximate).map((({item:e})=>Ie.jsx("div",{className:"aspect-[9/16] w-full max-w-[calc(100vh*0.5625)] rounded-xl overflow-hidden",children:Ie.jsx(Ua,{spark:e,isActive:!1})},e.id)))})]})]}),("all"===r||"tv"===r)&&(p.exact.length>0||p.approximate.length>0)&&Ie.jsxs("section",{children:[Ie.jsx("h2",{className:"text-2xl font-medium mb-6",children:"TV Channels"}),p.exact.length>0&&Ie.jsx("div",{className:"grid grid-cols-4 gap-6 mb-8",children:("all"===r?p.exact.slice(0,4):p.exact).map((e=>Ie.jsxs(o,{to:`/tv/${e.id}`,className:"group",children:[Ie.jsx("div",{className:"aspect-video rounded-xl overflow-hidden mb-3",children:Ie.jsx("img",{src:e.logo,alt:e.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform"})}),Ie.jsx("h3",{className:"font-medium group-hover:text-gold-600",children:e.name}),Ie.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[Hi(e.currentViewers)," watching"]})]},e.id)))}),p.approximate.length>0&&Ie.jsxs("div",{children:[Ie.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-4",children:"Similar Results"}),Ie.jsx("div",{className:"grid grid-cols-4 gap-6",children:("all"===r?p.approximate.slice(0,4):p.approximate).map((({item:e})=>Ie.jsxs(o,{to:`/tv/${e.id}`,className:"group",children:[Ie.jsx("div",{className:"aspect-video rounded-xl overflow-hidden mb-3",children:Ie.jsx("img",{src:e.logo,alt:e.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform"})}),Ie.jsx("h3",{className:"font-medium group-hover:text-gold-600",children:e.name}),Ie.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[Hi(e.currentViewers)," watching"]})]},e.id)))})]})]}),0===g&&0===f&&Ie.jsxs("div",{className:"text-center py-12",children:[Ie.jsxs("p",{className:"text-gray-600",children:['No results found for "',s,'"']}),Ie.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Try different keywords or check your spelling"})]})]})]})}const sn=[{id:"1",type:"like",user:{username:"sarah_smith",avatar:"https://ui-avatars.com/api/?name=Sarah+Smith",isVerified:!0},content:{id:"video1",title:"How to Build a React App",thumbnail:"https://images.unsplash.com/photo-1633356122544-f134324a6cee?w=320&h=180&fit=crop"},timestamp:new Date(Date.now()-3e5).toISOString()}];function rn(){const t=n(),[s,r]=e.useState("all"),i=sn.filter((e=>"all"===s||("likes"===s?"like"===e.type:"comments"===s?"comment"===e.type:"mentions"===s?"mention"===e.type:"shares"===s?"share"===e.type:"playlists"!==s||"playlist"===e.type))),a=e=>Ie.jsxs("div",{className:"flex gap-4",children:[Ie.jsx("div",{className:"flex-shrink-0",children:Ie.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden",children:Ie.jsx("img",{src:e.user.avatar,alt:e.user.username,className:"w-full h-full object-cover"})})}),Ie.jsx("div",{className:"flex-1 min-w-0",children:Ie.jsxs("div",{className:"flex items-start justify-between gap-4",children:[Ie.jsxs("div",{children:[Ie.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[Ie.jsx("span",{className:"font-medium hover:text-gold-600",children:e.user.username}),e.user.isVerified&&Ie.jsx("span",{className:"inline-block w-4 h-4 bg-gold-500 text-white rounded-full text-[10px] flex items-center justify-center",children:""})]}),Ie.jsxs("p",{className:"text-gray-600",children:["like"===e.type&&"liked your video","comment"===e.type&&"commented on your video","mention"===e.type&&"mentioned you in a comment","share"===e.type&&"shared your video","playlist"===e.type&&"added your video to their playlist"]}),Ie.jsx("div",{className:"text-sm text-gray-500 mt-2",children:qi(e.timestamp)})]}),Ie.jsx("div",{className:"flex-shrink-0 w-32 aspect-video rounded-lg overflow-hidden bg-gray-100",children:Ie.jsx("img",{src:e.content.thumbnail,alt:e.content.title,className:"w-full h-full object-cover"})})]})})]});return Ie.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:Ie.jsxs("div",{className:"max-w-3xl mx-auto px-8",children:[Ie.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[Ie.jsx("button",{onClick:()=>t(-1),className:"p-2 hover:bg-white rounded-lg text-gray-600 hover:text-gray-900",children:Ie.jsx(le,{className:"h-5 w-5"})}),Ie.jsxs("div",{className:"flex items-center gap-3",children:[Ie.jsx(b,{className:"h-8 w-8 text-gold-500"}),Ie.jsx("h1",{className:"text-3xl font-medium",children:"Notifications"})]})]}),Ie.jsx("div",{className:"flex gap-2 mb-8 overflow-x-auto pb-2",children:[{id:"all",label:"All",icon:b},{id:"likes",label:"Likes",icon:b},{id:"comments",label:"Comments",icon:b},{id:"mentions",label:"Mentions",icon:b},{id:"shares",label:"Shares",icon:b},{id:"playlists",label:"Playlists",icon:b}].map((e=>Ie.jsxs("button",{onClick:()=>r(e.id),className:"flex items-center gap-2 px-4 py-2 rounded-full whitespace-nowrap "+(s===e.id?"bg-gold-500 text-white":"bg-white text-gray-600 hover:bg-gray-50"),children:[Ie.jsx(e.icon,{className:"h-4 w-4"}),Ie.jsx("span",{children:e.label})]},e.id)))}),Ie.jsx("div",{className:"space-y-4",children:i.map((e=>Ie.jsx(o,{to:`/watch/${e.content.id}`,className:"block bg-white rounded-xl p-4 hover:bg-gray-50",children:a(e)},e.id)))})]})})}function an(){}function nn(){const{section:e}=c(),{getFeaturedVideos:t}=Di(),s=t(e),r=s.reduce(((e,t)=>e+t.views),0);return Ie.jsxs("div",{className:"bg-white min-h-screen py-8 px-8",children:[Ie.jsxs("div",{className:"mb-8",children:[Ie.jsx("h1",{className:"text-3xl font-medium mb-2",children:e?`Featured ${e}`:"Featured Videos"}),Ie.jsxs("p",{className:"text-gray-600",children:[Hi(r)," total views  ",s.length," videos"]})]}),Ie.jsx("div",{className:"grid grid-cols-4 gap-6",children:s.map((e=>Ie.jsx(aa,{video:e,onView:()=>{},size:"small"},e.id)))})]})}function on(){const t=n(),s=l(),{user:r}=Oi(),{addPoints:i,getUserPoints:a}=Aa(),[o,c]=e.useState(!1),d=Number(new URLSearchParams(s.search).get("needed"))||0,h=new URLSearchParams(s.search).get("returnTo")||"/",u=r?a(r.id):0;return Ie.jsx("div",{className:"min-h-screen bg-gray-50",children:Ie.jsxs("div",{className:"max-w-3xl mx-auto px-8 py-12",children:[Ie.jsxs("button",{onClick:()=>t(-1),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-8",children:[Ie.jsx(le,{className:"h-5 w-5"}),Ie.jsx("span",{children:"Back"})]}),Ie.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-8",children:[Ie.jsx("h1",{className:"text-3xl font-medium mb-2",children:"Purchase Points"}),Ie.jsx("p",{className:"text-gray-600 mb-8",children:"Get points to send gifts and support your favorite creators"}),d>0&&Ie.jsxs("div",{className:"mb-8 p-4 bg-gold-50 rounded-lg border border-gold-200",children:[Ie.jsx("div",{className:"text-gold-800 font-medium mb-1",children:"Points Needed"}),Ie.jsxs("div",{className:"text-gold-600",children:["You need ",d.toLocaleString()," more points for this gift"]}),Ie.jsxs("div",{className:"text-sm text-gold-600 mt-2",children:["Current balance: ",u.toLocaleString()," points"]})]}),Ie.jsx("div",{className:"grid grid-cols-3 gap-4 mb-8",children:Oa.map((e=>Ie.jsxs("button",{onClick:()=>(async e=>{if(!r)return;c(!0),await new Promise((e=>setTimeout(e,1500)));const s=Oa.find((t=>t.id===e));s&&i(r.id,s.points),c(!1),t(h)})(e.id),disabled:o,className:Ji("p-6 border rounded-xl transition-colors text-center",e.points>=d?"border-gold-500 bg-gold-50":"border-gray-200 hover:border-gold-300",o&&"opacity-50 cursor-not-allowed"),children:[Ie.jsx("div",{className:"text-3xl font-medium text-gold-500 mb-1",children:e.points.toLocaleString()}),Ie.jsx("div",{className:"text-gray-600 mb-3",children:"points"}),Ie.jsxs("div",{className:"text-2xl font-medium",children:["$",e.price.toFixed(2)]}),e.points>=d&&d>0&&Ie.jsx("div",{className:"text-xs text-gold-600 mt-2",children:"Recommended"})]},e.id)))}),Ie.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[Ie.jsx(Y,{className:"h-5 w-5"}),Ie.jsx("span",{children:"Secure payment processing"})]})]})]})})}function ln({videoId:t,startTime:s=0,autoplay:r=!1,showAds:i=!0}){const a=e.useRef(null),[n,o]=e.useState(!1),[l,c]=e.useState(!1),[d,h]=e.useState(1),[u,m]=e.useState(0),[p,g]=e.useState(0),[f,x]=e.useState(!1),[v,b]=e.useState("auto"),[w,y]=e.useState(1),[j,N]=e.useState(!1),[_,S]=e.useState(!1),[T,E]=e.useState(!1),{videos:C}=Di(),{addToWatchLater:P}=sa(),I=C.find((e=>e.id===t));if(!I)return null;const $=I.chapters||[],O=$.find((e=>u>=e.startTime&&u<e.endTime));e.useEffect((()=>{a.current&&(a.current.currentTime=s,r&&a.current.play())}),[s,r]);const A=()=>{a.current&&(n?a.current.pause():a.current.play(),o(!n))},R=e=>{const t=Math.floor(e/3600),s=Math.floor(e%3600/60),r=Math.floor(e%60);return t>0?`${t}:${s.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`:`${s}:${r.toString().padStart(2,"0")}`};return Ie.jsxs("div",{className:"relative aspect-video bg-black",onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),children:[Ie.jsx("video",{ref:a,src:I.videoUrl,className:"w-full h-full",onTimeUpdate:()=>{a.current&&m(a.current.currentTime)},onLoadedMetadata:()=>{a.current&&g(a.current.duration)},onClick:A}),Ie.jsxs("div",{className:Ji("absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent transition-opacity",f?"opacity-100":"opacity-0"),children:[Ie.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 flex justify-between items-center",children:[O&&Ie.jsx("div",{className:"text-white text-sm",children:O.title}),Ie.jsxs("a",{href:`/watch/${t}?t=${Math.floor(u)}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-white hover:text-gold-500 transition-colors",children:[Ie.jsx(Ai,{className:"h-6 w-6"}),Ie.jsx(fe,{className:"h-4 w-4"})]})]}),Ie.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4",children:[Ie.jsxs("div",{className:"relative mb-4",children:[Ie.jsx("input",{type:"range",min:0,max:p,value:u,onChange:e=>{const t=parseFloat(e.target.value);m(t),a.current&&(a.current.currentTime=t)},className:"w-full"}),$.map((e=>Ie.jsx("div",{className:"absolute top-0 w-1 h-2 bg-gold-500",style:{left:e.startTime/p*100+"%"}},e.startTime)))]}),Ie.jsxs("div",{className:"flex items-center gap-4",children:[Ie.jsx("button",{onClick:A,className:"text-white hover:text-gold-500",children:n?Ie.jsx(xe,{className:"h-6 w-6"}):Ie.jsx(H,{className:"h-6 w-6"})}),Ie.jsxs("div",{className:"flex items-center gap-2",children:[Ie.jsx("button",{onClick:()=>{if(a.current){const e=!l;c(e),a.current.volume=e?0:d}},className:"text-white hover:text-gold-500",children:l?Ie.jsx(ve,{className:"h-6 w-6"}):Ie.jsx(be,{className:"h-6 w-6"})}),Ie.jsx("input",{type:"range",min:0,max:1,step:.1,value:l?0:d,onChange:e=>{const t=parseFloat(e.target.value);h(t),a.current&&(a.current.volume=t),c(0===t)},className:"w-20"})]}),Ie.jsxs("div",{className:"text-white text-sm",children:[R(u)," / ",R(p)]}),Ie.jsx("div",{className:"flex-1"}),Ie.jsx("button",{onClick:async()=>{I&&await P(I.id)},className:"text-white hover:text-gold-500",children:Ie.jsx(V,{className:"h-6 w-6"})}),Ie.jsx("button",{onClick:()=>E(!T),className:"text-white hover:text-gold-500",children:Ie.jsx(ne,{className:"h-6 w-6"})}),Ie.jsx("button",{onClick:()=>S(!_),className:"text-white hover:text-gold-500",children:Ie.jsx(k,{className:"h-6 w-6"})}),Ie.jsx("button",{onClick:()=>{var e,t;document.fullscreenElement?(document.exitFullscreen(),N(!1)):(null==(t=null==(e=a.current)?void 0:e.parentElement)||t.requestFullscreen(),N(!0))},className:"text-white hover:text-gold-500",children:Ie.jsx(we,{className:"h-6 w-6"})})]})]}),_&&Ie.jsx("div",{className:"absolute bottom-16 right-4 bg-black/90 rounded-lg p-4 text-white",children:Ie.jsxs("div",{className:"space-y-4",children:[Ie.jsxs("div",{children:[Ie.jsx("div",{className:"text-sm font-medium mb-2",children:"Quality"}),["auto","1080p","720p","480p","360p"].map((e=>Ie.jsx("button",{onClick:()=>(b(e),void S(!1)),className:Ji("block w-full text-left px-4 py-1 rounded hover:bg-white/10",v===e&&"text-gold-500"),children:e},e)))]}),Ie.jsxs("div",{children:[Ie.jsx("div",{className:"text-sm font-medium mb-2",children:"Playback Speed"}),[.25,.5,.75,1,1.25,1.5,1.75,2].map((e=>Ie.jsxs("button",{onClick:()=>{return y(t=e),a.current&&(a.current.playbackRate=t),void S(!1);var t},className:Ji("block w-full text-left px-4 py-1 rounded hover:bg-white/10",w===e&&"text-gold-500"),children:[e,"x"]},e)))]})]})}),T&&Ie.jsx("div",{className:"absolute bottom-16 right-4 bg-black/90 rounded-lg p-4 text-white",children:Ie.jsxs("div",{className:"space-y-4",children:[Ie.jsx("div",{className:"text-sm font-medium mb-2",children:"Share"}),Ie.jsxs("div",{children:[Ie.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Embed Code"}),Ie.jsx("textarea",{value:`<iframe \n      width="560" \n      height="315" \n      src="${window.location.origin}/embed/${t}?t=${Math.floor(u)}" \n      frameborder="0" \n      allowfullscreen\n    ></iframe>`,readOnly:!0,className:"w-full bg-white/10 rounded p-2 text-sm",rows:3})]}),Ie.jsx("div",{className:"flex gap-2"})]})})]})]})}function cn(){const{videoId:e}=c(),[t]=h(),s=parseInt(t.get("t")||"0",10),r="false"!==t.get("autoplay"),i="false"!==t.get("ads");return e?Ie.jsx("div",{className:"w-full h-full",children:Ie.jsx(ln,{videoId:e,startTime:s,autoplay:r,showAds:i})}):null}function dn({children:e}){return Ie.jsxs("div",{className:"min-h-screen bg-white",children:[Ie.jsx(zi,{}),Ie.jsxs("div",{className:"pt-16 flex",children:[Ie.jsx(Gi,{}),Ie.jsx("main",{className:"flex-1 lg:ml-52",children:e})]}),Ie.jsx(Ki,{})]})}function hn(){return Ie.jsx(Oe,{children:Ie.jsx(u,{children:Ie.jsxs(m,{children:[Ie.jsx(p,{path:"/embed/:videoId",element:Ie.jsx(cn,{})}),Ie.jsx(p,{path:"/auth",element:Ie.jsx(Qa,{})}),Ie.jsx(p,{path:"/",element:Ie.jsx(dn,{children:Ie.jsx(ca,{})})}),Ie.jsx(p,{path:"/sparks",element:Ie.jsx(dn,{children:Ie.jsx(Fa,{})})}),Ie.jsx(p,{path:"/tv",element:Ie.jsx(dn,{children:Ie.jsx(Ba,{})})}),Ie.jsx(p,{path:"/top-100",element:Ie.jsx(dn,{children:Ie.jsx(Ta,{})})}),Ie.jsx(p,{path:"/category/:category",element:Ie.jsx(dn,{children:Ie.jsx(ua,{})})}),Ie.jsx(p,{path:"/unlimited",element:Ie.jsx(dn,{children:Ie.jsx(ma,{})})}),Ie.jsx(p,{path:"/live",element:Ie.jsx(dn,{children:Ie.jsx(Na,{})})}),Ie.jsx(p,{path:"/live/:eventId",element:Ie.jsx(dn,{children:Ie.jsx(ka,{})})}),Ie.jsx(p,{path:"/live/:eventId/purchase",element:Ie.jsx(dn,{children:Ie.jsx(_a,{})})}),Ie.jsx(p,{path:"/settings",element:Ie.jsx(dn,{children:Ie.jsx(za,{})})}),Ie.jsx(p,{path:"/watch/:videoId",element:Ie.jsx(dn,{children:Ie.jsx(Ka,{})})}),Ie.jsx(p,{path:"/profile/:username",element:Ie.jsx(dn,{children:Ie.jsx(Xa,{})})}),Ie.jsx(p,{path:"/search",element:Ie.jsx(dn,{children:Ie.jsx(tn,{})})}),Ie.jsx(p,{path:"/notifications",element:Ie.jsx(dn,{children:Ie.jsx(rn,{})})}),Ie.jsx(p,{path:"/upload",element:Ie.jsx(dn,{children:Ie.jsx(an,{})})}),Ie.jsx(p,{path:"/featured/:section",element:Ie.jsx(dn,{children:Ie.jsx(nn,{})})}),Ie.jsx(p,{path:"/points/purchase",element:Ie.jsx(dn,{children:Ie.jsx(on,{})})})]})})})}class un{constructor(){}static getInstance(){return un.instance||(un.instance=new un),un.instance}trackEvent(e,t){console.log("Track event:",e,t)}trackError(e,t){console.error("Error:",e,t)}trackPageView(e){console.log("Page view:",e)}trackPerformance(e,t){console.log("Performance:",e,t)}}const mn=un.getInstance();const pn={trackPageLoad(){if(window.performance){const e=window.performance.timing,t=e.loadEventEnd-e.navigationStart;mn.trackPerformance("page_load",t)}},trackApiCall(e,t){mn.trackPerformance(`api_${e}`,t)},trackError(e,t){mn.trackError(e,t)},trackResourceTiming(){if(window.performance&&window.performance.getEntriesByType){window.performance.getEntriesByType("resource").forEach((e=>{e instanceof PerformanceResourceTiming&&mn.trackPerformance(`resource_${e.initiatorType}`,e.duration)}))}}};class gn{constructor(){this.alerts=[],this.alertChannels={info:["email"],warning:["email","slack"],error:["email","slack","sms"],critical:["email","slack","sms"]},this.initializeAlertSystem()}static getInstance(){return gn.instance||(gn.instance=new gn),gn.instance}}const fn=gn.getInstance();class xn{constructor(){this.checkInterval=3e5,this.isRunning=!1,this.startHealthChecks()}static getInstance(){return xn.instance||(xn.instance=new xn),xn.instance}startHealthChecks(){this.isRunning||(this.isRunning=!0,setInterval((()=>{this.runHealthChecks()}),this.checkInterval))}async runHealthChecks(){try{const e=await Promise.all([this.checkDatabase(),this.checkAPI(),this.checkStorage(),this.checkBackups(),this.checkCompliance(),this.checkPerformance()]),t=e.every((e=>e.healthy));t||fn.createAlert({type:"health_check",severity:"error",message:"System health check failed",data:e}),mn.trackEvent("health_check_completed",{healthy:t,results:e})}catch(e){mn.trackError(e,{context:"health_check"})}}}const vn=xn.getInstance();pn.trackPageLoad(),vn.startHealthChecks();const bn=document.getElementById("root");if(!bn)throw new Error("Root element not found");Pe(bn).render(Ie.jsx(e.StrictMode,{children:Ie.jsx(hn,{})})),"stackblitz.com"===window.location.hostname||window.location.hostname.includes("stackblitz.io")?console.log("Service Workers are not supported in StackBlitz WebContainer environment"):"serviceWorker"in navigator&&window.addEventListener("load",(()=>{navigator.serviceWorker.register("/service-worker.js").then((e=>{mn.trackEvent("service_worker_registered",{scope:e.scope})})).catch((e=>{mn.trackError(e,{context:"service_worker_registration"})}))}));
//# sourceMappingURL=index-DnByL40d.js.map
